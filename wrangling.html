

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Cleaning and wrangling data &#8212; Data Science: A First Introduction with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-7XBFF4RSN2"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-7XBFF4RSN2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'wrangling';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Effective data visualization" href="viz.html" />
    <link rel="prev" title="2. Reading in data locally and from the web" href="reading.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Data Science: A First Introduction with Python</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="preface-text.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="foreword-text.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">About the authors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Python and Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="reading.html">2. Reading in data locally and from the web</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Cleaning and wrangling data</a></li>
<li class="toctree-l1"><a class="reference internal" href="viz.html">4. Effective data visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification1.html">5. Classification I: training &amp; predicting</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification2.html">6. Classification II: evaluation &amp; tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression1.html">7. Regression I: K-nearest neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression2.html">8. Regression II: linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">9. Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">10. Statistical inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter.html">11. Combining code and text with Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="version-control.html">12. Collaboration with version control</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">13. Setting up your computer</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/wrangling.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cleaning and wrangling data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">3.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-learning-objectives">3.2. Chapter learning objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frames-and-series">3.3. Data frames and series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-data-frame">3.3.1. What is a data frame?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-series">3.3.2. What is a series?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-this-have-to-do-with-data-frames">3.3.3. What does this have to do with data frames?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structures-in-python">3.3.4. Data structures in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidy-data">3.4. Tidy data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-up-going-from-wide-to-long-using-melt">3.4.1. Tidying up: going from wide to long using <code class="docutils literal notranslate"><span class="pre">melt</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-up-going-from-long-to-wide-using-pivot">3.4.2. Tidying up: going from long to wide using <code class="docutils literal notranslate"><span class="pre">pivot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-up-using-str-split-to-deal-with-multiple-separators">3.4.3. Tidying up: using <code class="docutils literal notranslate"><span class="pre">str.split</span></code> to deal with multiple separators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-to-extract-rows-or-columns">3.5. Using <code class="docutils literal notranslate"><span class="pre">[]</span></code> to extract rows or columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-columns-by-name">3.5.1. Extracting columns by name</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-that-have-a-certain-value-with">3.5.2. Extracting rows that have a certain value with <code class="docutils literal notranslate"><span class="pre">==</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-that-do-not-have-a-certain-value-with">3.5.3. Extracting rows that do not have a certain value with <code class="docutils literal notranslate"><span class="pre">!=</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-satisfying-multiple-conditions-using">3.5.4. Extracting rows satisfying multiple conditions using <code class="docutils literal notranslate"><span class="pre">&amp;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-satisfying-at-least-one-condition-using">3.5.5. Extracting rows satisfying at least one condition using <code class="docutils literal notranslate"><span class="pre">|</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-with-values-in-a-list-using-isin">3.5.6. Extracting rows with values in a list using <code class="docutils literal notranslate"><span class="pre">isin</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-above-or-below-a-threshold-using-and">3.5.7. Extracting rows above or below a threshold using <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-using-query">3.5.8. Extracting rows using <code class="docutils literal notranslate"><span class="pre">query</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-loc-to-filter-rows-and-select-columns">3.6. Using <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> to filter rows and select columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-iloc-to-extract-rows-and-columns-by-position">3.7. Using <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code> to extract rows and columns by position</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregating-data">3.8. Aggregating data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-summary-statistics-on-individual-columns">3.8.1. Calculating summary statistics on individual columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-summary-statistics-on-data-frames">3.8.2. Calculating summary statistics on data frames</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-operations-on-groups-of-rows-using-groupby">3.9. Performing operations on groups of rows using <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-functions-across-multiple-columns">3.10. Apply functions across multiple columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-and-adding-columns">3.11. Modifying and adding columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-merge-to-combine-data-frames">3.12. Using <code class="docutils literal notranslate"><span class="pre">merge</span></code> to combine data frames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3.13. Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">3.14. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">3.15. Additional resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">3.16. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cleaning-and-wrangling-data">
<span id="wrangling"></span><h1><span class="section-number">3. </span>Cleaning and wrangling data<a class="headerlink" href="#cleaning-and-wrangling-data" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2><span class="section-number">3.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>This chapter is centered around defining tidy data—a data format that is
suitable for analysis—and the tools needed to transform raw data into this
format. This will be presented in the context of a real-world data science
application, providing more practice working through a whole case study.</p>
</section>
<section id="chapter-learning-objectives">
<h2><span class="section-number">3.2. </span>Chapter learning objectives<a class="headerlink" href="#chapter-learning-objectives" title="Permalink to this heading">#</a></h2>
<p>By the end of the chapter, readers will be able to do the following:</p>
<ul class="simple">
<li><p>Define the term “tidy data”.</p></li>
<li><p>Discuss the advantages of storing data in a tidy data format.</p></li>
<li><p>Define what series and data frames are in Python, and describe how they relate to
each other.</p></li>
<li><p>Describe the common types of data in Python and their uses.</p></li>
<li><p>Use the following functions for their intended data wrangling tasks:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">melt</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pivot</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset_index</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str.split</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agg</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assign</span></code> and regular column assignment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groupby</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">merge</span></code></p></li>
</ul>
</li>
<li><p>Use the following operators for their intended data wrangling tasks:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, and <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isin</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">|</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[]</span></code>, <code class="docutils literal notranslate"><span class="pre">loc[]</span></code>, and <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="data-frames-and-series">
<h2><span class="section-number">3.3. </span>Data frames and series<a class="headerlink" href="#data-frames-and-series" title="Permalink to this heading">#</a></h2>
<p>In <a class="reference internal" href="intro.html#intro"><span class="std std-numref">Chapters 1</span></a> and <a class="reference internal" href="reading.html#reading"><span class="std std-numref">2</span></a>, <em>data frames</em> were the focus:
we learned how to import data into Python as a data frame, and perform basic operations on data frames in Python.
In the remainder of this book, this pattern continues. The vast majority of tools we use will require
that data are represented as a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <strong>data frame</strong> in Python. Therefore, in this section,
we will dig more deeply into what data frames are and how they are represented in Python.
This knowledge will be helpful in effectively utilizing these objects in our data analyses.</p>
<section id="what-is-a-data-frame">
<h3><span class="section-number">3.3.1. </span>What is a data frame?<a class="headerlink" href="#what-is-a-data-frame" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><p id="index-2">A data frame is a table-like structure for storing data in Python. Data frames are
important to learn about because most data that you will encounter in practice
can be naturally stored as a table.  In order to define data frames precisely,
we need to introduce a few technical terms:</p>
<ul class="simple" id="index-3">
<li><p><strong>variable:</strong> a characteristic, number, or quantity that can be measured.</p></li>
<li><p><strong>observation:</strong> all of the measurements for a given entity.</p></li>
<li><p><strong>value:</strong> a single measurement of a single variable for a given entity.</p></li>
</ul>
<p>Given these definitions, a <strong>data frame</strong> is a tabular data structure in Python
that is designed to store observations, variables, and their values.
Most commonly, each column in a data frame corresponds to a variable,
and each row corresponds to an observation. For example,
<a class="reference internal" href="#fig-02-obs"><span class="std std-numref">Fig. 3.1</span></a> displays a data set of city populations. Here, the variables
are “region, year, population”; each of these are properties that can be
collected or measured.  The first observation is “Toronto, 2016, 2235145”;
these are the values that the three variables take for the first entity in the
data set. There are 13 entities in the data set in total, corresponding to the
13 rows in <a class="reference internal" href="#fig-02-obs"><span class="std std-numref">Fig. 3.1</span></a>.</p>
<figure class="figure align-default" id="fig-02-obs">
<img alt="_images/data_frame_slides_cdn.004.png" src="_images/data_frame_slides_cdn.004.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.1 </span><span class="caption-text">A data frame storing data regarding the population of various regions in Canada. In this example data frame, the row that corresponds to the observation for the city of Vancouver is colored yellow, and the column that corresponds to the population variable is colored blue.</span><a class="headerlink" href="#fig-02-obs" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="what-is-a-series">
<h3><span class="section-number">3.3.2. </span>What is a series?<a class="headerlink" href="#what-is-a-series" title="Permalink to this heading">#</a></h3>
<p id="index-4">In Python, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <strong>series</strong> are are objects that can contain one or more elements (like a list).
They are a single column, are ordered, can be indexed, and can contain any data type.
The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> package uses <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects to represent the columns in a data frame.
<code class="docutils literal notranslate"><span class="pre">Series</span></code> can contain a mix of data types, but it is good practice to only include a single type in a series
because all observations of one variable should be the same type.
Python has several different basic data types, as shown in
<a class="reference internal" href="#tab-datatype-table"><span class="std std-numref">Table 3.1</span></a>. You can create a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> series using the
<code class="docutils literal notranslate"><span class="pre">pd.Series()</span></code> function.  For example, to create the series <code class="docutils literal notranslate"><span class="pre">region</span></code> as shown
in <a class="reference internal" href="#fig-02-series"><span class="std std-numref">Fig. 3.2</span></a>, you can write the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">region</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Ottawa&quot;</span><span class="p">])</span>
<span class="n">region</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      Toronto
1     Montreal
2    Vancouver
3      Calgary
4       Ottawa
dtype: object
</pre></div>
</div>
</div>
</div>
<figure class="figure align-default" id="fig-02-series">
<img alt="_images/pandas_dataframe_series.png" src="_images/pandas_dataframe_series.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Example of a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> series whose type is string.</span><a class="headerlink" href="#fig-02-series" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<span class="target" id="index-5"></span><span class="target" id="index-6"></span><span class="target" id="index-7"></span><span class="target" id="index-8"></span><span class="target" id="index-9"></span><span id="index-10"></span><table class="colwidths-auto table" id="tab-datatype-table">
<caption><span class="caption-number">Table 3.1 </span><span class="caption-text">Basic data types in Python</span><a class="headerlink" href="#tab-datatype-table" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="text-left head"><p>Data type</p></th>
<th class="text-left head"><p>Abbreviation</p></th>
<th class="text-left head"><p>Description</p></th>
<th class="text-left head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>integer</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td class="text-left"><p>positive/negative/zero whole numbers</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">42</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>floating point number</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td class="text-left"><p>real number in decimal form</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">3.14159</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>boolean</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td class="text-left"><p>true or false</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>string</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td class="text-left"><p>text</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;Hello</span> <span class="pre">World&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>none</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">NoneType</span></code></p></td>
<td class="text-left"><p>represents no value</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
</tr>
</tbody>
</table>
<p>It is important in Python to make sure you represent your data with the correct type.
Many of the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> functions we use in this book treat
the various data types differently. You should use <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">float</span></code> types
to represent numbers and perform arithmetic. The <code class="docutils literal notranslate"><span class="pre">int</span></code> type is for integers that have no decimal point,
while the <code class="docutils literal notranslate"><span class="pre">float</span></code> type is for numbers that have a decimal point.
The <code class="docutils literal notranslate"><span class="pre">bool</span></code> type are boolean variables that can only take on one of two values: <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.
The <code class="docutils literal notranslate"><span class="pre">string</span></code> type is used to represent data that should
be thought of as “text”, such as words, names, paths, URLs, and more.
A <code class="docutils literal notranslate"><span class="pre">NoneType</span></code> is a special type in Python that is used to indicate no value; this can occur,
for example, when you have missing data.
There are other basic data types in Python, but we will generally
not use these in this textbook.</p>
</section>
<section id="what-does-this-have-to-do-with-data-frames">
<h3><span class="section-number">3.3.3. </span>What does this have to do with data frames?<a class="headerlink" href="#what-does-this-have-to-do-with-data-frames" title="Permalink to this heading">#</a></h3>
<p id="index-11">A data frame is really just a collection of series that are stuck together,
where each series corresponds to one column and all must have the same length.
But not all columns in a data frame need to be of the same type.
<a class="reference internal" href="#fig-02-dataframe"><span class="std std-numref">Fig. 3.3</span></a> shows a data frame where
the columns are series of different types. But each element <em>within</em>
one column should usually be the same type, since the values for a single variable
are usually all of the same type. For example, if the variable is the name of a city,
that name should be a string, whereas if the variable is a year, that should be an
integer. So even though series let you put different types in them, it is most common
(and good practice!) to have just one type per column.</p>
<figure class="figure align-default" id="fig-02-dataframe">
<img alt="_images/pandas_dataframe_series-3.png" src="_images/pandas_dataframe_series-3.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.3 </span><span class="caption-text">Data frame and series types.</span><a class="headerlink" href="#fig-02-dataframe" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note" id="index-12">
<p class="admonition-title">Note</p>
<p>You can use the function <code class="docutils literal notranslate"><span class="pre">type</span></code> on a data object.
For example we can check the class of the Canadian languages data set,
<code class="docutils literal notranslate"><span class="pre">can_lang</span></code>, we worked with in the previous chapters and we see it is a <code class="docutils literal notranslate"><span class="pre">pandas.core.frame.DataFrame</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/can_lang.csv&quot;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-structures-in-python">
<h3><span class="section-number">3.3.4. </span>Data structures in Python<a class="headerlink" href="#data-structures-in-python" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> types are <em>data structures</em> in Python, which
are core to most data analyses.
The functions from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> that we use often give us back a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
or a <code class="docutils literal notranslate"><span class="pre">Series</span></code> depending on the operation. Because
<code class="docutils literal notranslate"><span class="pre">Series</span></code> are essentially simple <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>, we will refer
to both <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> and <code class="docutils literal notranslate"><span class="pre">Series</span></code> as “data frames” in the text.
There are other types that represent data structures in Python.
We summarize the most common ones in <a class="reference internal" href="#tab-datastruc-table"><span class="std std-numref">Table 3.2</span></a>.</p>
<span class="target" id="index-13"></span><span id="index-14"></span><table class="colwidths-auto table" id="tab-datastruc-table">
<caption><span class="caption-number">Table 3.2 </span><span class="caption-text">Basic data structures in Python</span><a class="headerlink" href="#tab-datastruc-table" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Data Structure</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>list</p></td>
<td><p>An ordered collection of values that can store multiple data types at once.</p></td>
</tr>
<tr class="row-odd"><td><p>dict</p></td>
<td><p>A labeled data structure where <code class="docutils literal notranslate"><span class="pre">keys</span></code> are paired with <code class="docutils literal notranslate"><span class="pre">values</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Series</p></td>
<td><p>An ordered collection of values <em>with labels</em> that can store multiple data types at once.</p></td>
</tr>
<tr class="row-odd"><td><p>DataFrame</p></td>
<td><p>A labeled data structure with <code class="docutils literal notranslate"><span class="pre">Series</span></code> columns of potentially different types.</p></td>
</tr>
</tbody>
</table>
<p>A <code class="docutils literal notranslate"><span class="pre">list</span></code> is an ordered collection of values. To create a list, we put the contents of the list in between
square brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code>, where each item of the list is separated by a comma. A <code class="docutils literal notranslate"><span class="pre">list</span></code> can contain values
of different types. The example below contains six <code class="docutils literal notranslate"><span class="pre">str</span></code> entries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cities</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Ottawa&quot;</span><span class="p">,</span> <span class="s2">&quot;Winnipeg&quot;</span><span class="p">]</span>
<span class="n">cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Toronto&#39;, &#39;Vancouver&#39;, &#39;Montreal&#39;, &#39;Calgary&#39;, &#39;Ottawa&#39;, &#39;Winnipeg&#39;]
</pre></div>
</div>
</div>
</div>
<p>A list can directly be converted to a pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cities_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cities</span><span class="p">)</span>
<span class="n">cities_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      Toronto
1    Vancouver
2     Montreal
3      Calgary
4       Ottawa
5     Winnipeg
dtype: object
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">dict</span></code>, or dictionary, contains pairs of “keys” and “values.”
You use a key to look up its corresponding value. Dictionaries are created
using curly brackets <code class="docutils literal notranslate"><span class="pre">{}</span></code>. Each entry starts with the
key on the left, followed by a colon symbol <code class="docutils literal notranslate"><span class="pre">:</span></code>, and then the value.
A dictionary can have multiple key-value pairs, each separted by a comma.
Keys can take a wide variety of types (<code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">str</span></code> are commonly used), and values can take any type;
the key-value pairs in a dictionary can all be of different types, too.
In the example below,
we create a dictionary that has two keys: <code class="docutils literal notranslate"><span class="pre">&quot;cities&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;population&quot;</span></code>.
The values associated with each are lists.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_in_2016</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;cities&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Ottawa&quot;</span><span class="p">,</span> <span class="s2">&quot;Winnipeg&quot;</span><span class="p">],</span>
  <span class="s2">&quot;population&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2235145</span><span class="p">,</span> <span class="mi">1027613</span><span class="p">,</span> <span class="mi">1823281</span><span class="p">,</span> <span class="mi">544870</span><span class="p">,</span> <span class="mi">571146</span><span class="p">,</span> <span class="mi">321484</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">population_in_2016</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;cities&#39;: [&#39;Toronto&#39;,
  &#39;Vancouver&#39;,
  &#39;Montreal&#39;,
  &#39;Calgary&#39;,
  &#39;Ottawa&#39;,
  &#39;Winnipeg&#39;],
 &#39;population&#39;: [2235145, 1027613, 1823281, 544870, 571146, 321484]}
</pre></div>
</div>
</div>
</div>
<p>A dictionary can be converted to a data frame. Keys
become the column names, and the values become the entries in
those columns. Dictionaries on their own are quite simple objects; it is preferable to work with a data frame
because then we have access to the built-in functionality in
<code class="docutils literal notranslate"><span class="pre">pandas</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">loc[]</span></code>, <code class="docutils literal notranslate"><span class="pre">[]</span></code>, and many functions that we will discuss in the upcoming sections)!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_in_2016_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">population_in_2016</span><span class="p">)</span>
<span class="n">population_in_2016_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cities</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Toronto</td>
      <td>2235145</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vancouver</td>
      <td>1027613</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Montreal</td>
      <td>1823281</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Calgary</td>
      <td>544870</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ottawa</td>
      <td>571146</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Winnipeg</td>
      <td>321484</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Of course, there is no need to name the dictionary separately before passing it to
<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>; we can instead construct the dictionary right inside the call.
This is often the most convenient way to create a new data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_in_2016_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
  <span class="s2">&quot;cities&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Ottawa&quot;</span><span class="p">,</span> <span class="s2">&quot;Winnipeg&quot;</span><span class="p">],</span>
  <span class="s2">&quot;population&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2235145</span><span class="p">,</span> <span class="mi">1027613</span><span class="p">,</span> <span class="mi">1823281</span><span class="p">,</span> <span class="mi">544870</span><span class="p">,</span> <span class="mi">571146</span><span class="p">,</span> <span class="mi">321484</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">population_in_2016_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cities</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Toronto</td>
      <td>2235145</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vancouver</td>
      <td>1027613</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Montreal</td>
      <td>1823281</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Calgary</td>
      <td>544870</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ottawa</td>
      <td>571146</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Winnipeg</td>
      <td>321484</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="tidy-data">
<h2><span class="section-number">3.4. </span>Tidy data<a class="headerlink" href="#tidy-data" title="Permalink to this heading">#</a></h2>
<p id="index-15">There are many ways a tabular data set can be organized.  The data frames we
have looked at so far have all been using the <strong>tidy data</strong> format of
organization.  This chapter will focus on introducing the tidy data format and
how to make your raw (and likely messy) data tidy. A tidy data frame satisfies
the following three criteria <span id="id1">[<a class="reference internal" href="#id22" title="Hadley Wickham. Tidy data. Journal of Statistical Software, 59(10):1–23, 2014.">Wickham, 2014</a>]</span>:</p>
<ul class="simple">
<li><p>each row is a single observation,</p></li>
<li><p>each column is a single variable, and</p></li>
<li><p>each value is a single cell (i.e., its entry in the data
frame is not shared with another value).</p></li>
</ul>
<p><a class="reference internal" href="#fig-02-tidy-image"><span class="std std-numref">Fig. 3.4</span></a> demonstrates a tidy data set that satisfies these
three criteria.</p>
<figure class="figure align-default" id="fig-02-tidy-image">
<img alt="_images/tidy_data.001.png" src="_images/tidy_data.001.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Tidy data satisfies three criteria.</span><a class="headerlink" href="#fig-02-tidy-image" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p id="index-16">There are many good reasons for making sure your data are tidy as a first step in your analysis.
The most important is that it is a single, consistent format that nearly every function
in the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> recognizes. No matter what the variables and observations
in your data represent, as long as the data frame
is tidy, you can manipulate it, plot it, and analyze it using the same tools.
If your data is <em>not</em> tidy, you will have to write special bespoke code
in your analysis that will not only be error-prone, but hard for others to understand.
Beyond making your analysis more accessible to others and less error-prone, tidy data
is also typically easy for humans to interpret. Given these benefits,
it is well worth spending the time to get your data into a tidy format
upfront. Fortunately, there are many well-designed <code class="docutils literal notranslate"><span class="pre">pandas</span></code> data
cleaning/wrangling tools to help you easily tidy your data. Let’s explore them
below!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Is there only one shape for tidy data for a given data set? Not
necessarily! It depends on the statistical question you are asking and what
the variables are for that question. For tidy data, each variable should be
its own column. So, just as it’s essential to match your statistical question
with the appropriate data analysis tool, it’s important to match your
statistical question with the appropriate variables and ensure they are
represented as individual columns to make the data tidy.</p>
</div>
<section id="tidying-up-going-from-wide-to-long-using-melt">
<h3><span class="section-number">3.4.1. </span>Tidying up: going from wide to long using <code class="docutils literal notranslate"><span class="pre">melt</span></code><a class="headerlink" href="#tidying-up-going-from-wide-to-long-using-melt" title="Permalink to this heading">#</a></h3>
<p id="index-17">One task that is commonly performed to get data into a tidy format
is to combine values that are stored in separate columns,
but are really part of the same variable, into one.
Data is often stored this way
because this format is sometimes more intuitive for human readability
and understanding, and humans create data sets.
In <a class="reference internal" href="#fig-02-wide-to-long"><span class="std std-numref">Fig. 3.5</span></a>,
the table on the left is in an untidy, “wide” format because the year values
(2006, 2011, 2016) are stored as column names.
And as a consequence,
the values for population for the various cities
over these years are also split across several columns.</p>
<p>For humans, this table is easy to read, which is why you will often find data
stored in this wide format.  However, this format is difficult to work with
when performing data visualization or statistical analysis using Python.  For
example, if we wanted to find the latest year it would be challenging because
the year values are stored as column names instead of as values in a single
column.  So before we could apply a function to find the latest year (for
example, by using <code class="docutils literal notranslate"><span class="pre">max</span></code>), we would have to first extract the column names
to get them as a list and then apply a function to extract the latest year.
The problem only gets worse if you would like to find the value for the
population for a given region for the latest year.  Both of these tasks are
greatly simplified once the data is tidied.</p>
<p>Another problem with data in this format is that we don’t know what the
numbers under each year actually represent. Do those numbers represent
population size? Land area? It’s not clear.
To solve both of these problems,
we can reshape this data set to a tidy data format
by creating a column called “year” and a column called
“population.” This transformation—which makes the data
“longer”—is shown as the right table in
<a class="reference internal" href="#fig-02-wide-to-long"><span class="std std-numref">Fig. 3.5</span></a>. Note that the number of entries in our data frame
can change in this transformation. The “untidy” data has 5 rows and 3 columns for
a total of 15 entries, whereas the “tidy” data on the right has 15 rows and 2 columns
for a total of 30 entries.</p>
<figure class="figure align-default" id="fig-02-wide-to-long">
<img alt="_images/pivot_functions.001.png" src="_images/pivot_functions.001.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.5 </span><span class="caption-text">Melting data from a wide to long data format.</span><a class="headerlink" href="#fig-02-wide-to-long" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p id="index-18">We can achieve this effect in Python using the <code class="docutils literal notranslate"><span class="pre">melt</span></code> function from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> package.
The <code class="docutils literal notranslate"><span class="pre">melt</span></code> function combines columns,
and is usually used during tidying data
when we need to make the data frame longer and narrower.
To learn how to use <code class="docutils literal notranslate"><span class="pre">melt</span></code>, we will work through an example with the
<code class="docutils literal notranslate"><span class="pre">region_lang_top5_cities_wide.csv</span></code> data set. This data set contains the
counts of how many Canadians cited each language as their mother tongue for five
major Canadian cities (Toronto, Montréal, Vancouver, Calgary, and Edmonton) from
the 2016 Canadian census.
To get started,
we will use <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> to load the (untidy) data.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_wide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang_top5_cities_wide.csv&quot;</span><span class="p">)</span>
<span class="n">lang_wide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>Toronto</th>
      <th>Montréal</th>
      <th>Vancouver</th>
      <th>Calgary</th>
      <th>Edmonton</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>80</td>
      <td>30</td>
      <td>70</td>
      <td>20</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>985</td>
      <td>90</td>
      <td>1435</td>
      <td>960</td>
      <td>575</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>360</td>
      <td>240</td>
      <td>45</td>
      <td>45</td>
      <td>65</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>8485</td>
      <td>1015</td>
      <td>400</td>
      <td>705</td>
      <td>885</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>13260</td>
      <td>2450</td>
      <td>1090</td>
      <td>1365</td>
      <td>770</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>165</td>
      <td>2440</td>
      <td>30</td>
      <td>120</td>
      <td>130</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>5</td>
      <td>0</td>
      <td>20</td>
      <td>10</td>
      <td>155</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>5290</td>
      <td>1025</td>
      <td>4330</td>
      <td>380</td>
      <td>235</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>3355</td>
      <td>8960</td>
      <td>220</td>
      <td>80</td>
      <td>55</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>3380</td>
      <td>210</td>
      <td>190</td>
      <td>1430</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 7 columns</p>
</div></div></div>
</div>
<p>What is wrong with the untidy format above?
The table on the left in <a class="reference internal" href="#fig-img-pivot-longer-with-table"><span class="std std-numref">Fig. 3.6</span></a>
represents the data in the “wide” (messy) format.
From a data analysis perspective, this format is not ideal because the values of
the variable <em>region</em> (Toronto, Montréal, Vancouver, Calgary, and Edmonton)
are stored as column names. Thus they
are not easily accessible to the data analysis functions we will apply
to our data set. Additionally, the <em>mother tongue</em> variable values are
spread across multiple columns, which will prevent us from doing any desired
visualization or statistical tasks until we combine them into one column. For
instance, suppose we want to know the languages with the highest number of
Canadians reporting it as their mother tongue among all five regions. This
question would be tough to answer with the data in its current format.
We <em>could</em> find the answer with the data in this format,
though it would be much easier to answer if we tidy our
data first. If mother tongue were instead stored as one column,
as shown in the tidy data on the right in
<a class="reference internal" href="#fig-img-pivot-longer-with-table"><span class="std std-numref">Fig. 3.6</span></a>,
we could simply use one line of code (<code class="docutils literal notranslate"><span class="pre">df[&quot;mother_tongue&quot;].max()</span></code>)
to get the maximum value.</p>
<figure class="figure align-default" id="fig-img-pivot-longer-with-table">
<img alt="_images/pandas_melt_wide-long.png" src="_images/pandas_melt_wide-long.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.6 </span><span class="caption-text">Going from wide to long with the <code class="docutils literal notranslate"><span class="pre">melt</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-longer-with-table" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-img-pivot-longer"><span class="std std-numref">Fig. 3.7</span></a> details the arguments that we need to specify
in the <code class="docutils literal notranslate"><span class="pre">melt</span></code> function to accomplish this data transformation.</p>
<figure class="figure align-default" id="fig-img-pivot-longer">
<img alt="_images/pandas_melt_args_labels.png" src="_images/pandas_melt_args_labels.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.7 </span><span class="caption-text">Syntax for the <code class="docutils literal notranslate"><span class="pre">melt</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-longer" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<span class="target" id="index-19"></span><p id="index-20">We use <code class="docutils literal notranslate"><span class="pre">melt</span></code> to combine the Toronto, Montréal,
Vancouver, Calgary, and Edmonton columns into a single column called <code class="docutils literal notranslate"><span class="pre">region</span></code>,
and create a column called <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code> that contains the count of how many
Canadians report each language as their mother tongue for each metropolitan
area</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_mother_tidy</span> <span class="o">=</span> <span class="n">lang_wide</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;mother_tongue&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">lang_mother_tidy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>mother_tongue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>985</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>360</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>8485</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>13260</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>130</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>155</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>235</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>55</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the code above, the call to the
<code class="docutils literal notranslate"><span class="pre">melt</span></code> function is split across several lines. Recall from
<a class="reference internal" href="intro.html#intro"><span class="std std-numref">Chapter 1</span></a> that this is allowed in
certain cases. For example, when calling a function as above, the input
arguments are between parentheses <code class="docutils literal notranslate"><span class="pre">()</span></code> and Python knows to keep reading on
the next line. Each line ends with a comma <code class="docutils literal notranslate"><span class="pre">,</span></code> making it easier to read.
Splitting long lines like this across multiple lines is encouraged
as it helps significantly with code readability. Generally speaking, you should
limit each line of code to about 80 characters.</p>
</div>
<p>The data above is now tidy because all three criteria for tidy data have now
been met:</p>
<ol class="arabic simple">
<li><p>All the variables (<code class="docutils literal notranslate"><span class="pre">category</span></code>, <code class="docutils literal notranslate"><span class="pre">language</span></code>, <code class="docutils literal notranslate"><span class="pre">region</span></code> and <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code>) are
now their own columns in the data frame.</p></li>
<li><p>Each observation, i.e., each <code class="docutils literal notranslate"><span class="pre">category</span></code>, <code class="docutils literal notranslate"><span class="pre">language</span></code>, <code class="docutils literal notranslate"><span class="pre">region</span></code>, and count of
Canadians where that language is the mother tongue, are in a single row.</p></li>
<li><p>Each value is a single cell, i.e., its row, column position in the data
frame is not shared with another value.</p></li>
</ol>
</section>
<section id="tidying-up-going-from-long-to-wide-using-pivot">
<span id="pivot-wider"></span><h3><span class="section-number">3.4.2. </span>Tidying up: going from long to wide using <code class="docutils literal notranslate"><span class="pre">pivot</span></code><a class="headerlink" href="#tidying-up-going-from-long-to-wide-using-pivot" title="Permalink to this heading">#</a></h3>
<p id="index-21">Suppose we have observations spread across multiple rows rather than in a single
row. For example, in <a class="reference internal" href="#fig-long-to-wide"><span class="std std-numref">Fig. 3.8</span></a>, the table on the left is in an
untidy, long format because the <code class="docutils literal notranslate"><span class="pre">count</span></code> column contains three variables
(population, commuter, and incorporated count) and information about each observation
(here, population, commuter, and incorporated counts for a region) is split across three rows.
Remember: one of the criteria for tidy data
is that each observation must be in a single row.</p>
<p>Using data in this format—where two or more variables are mixed together
in a single column—makes it harder to apply many usual <code class="docutils literal notranslate"><span class="pre">pandas</span></code> functions.
For example, finding the maximum number of commuters
would require an additional step of filtering for the commuter values
before the maximum can be computed.
In comparison, if the data were tidy,
all we would have to do is compute the maximum value for the commuter column.
To reshape this untidy data set to a tidy (and in this case, wider) format,
we need to create columns called “population”, “commuters”, and “incorporated.”
This is illustrated in the right table of <a class="reference internal" href="#fig-long-to-wide"><span class="std std-numref">Fig. 3.8</span></a>.</p>
<figure class="figure align-default" id="fig-long-to-wide">
<img alt="_images/pivot_functions.002.png" src="_images/pivot_functions.002.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.8 </span><span class="caption-text">Going from long to wide data.</span><a class="headerlink" href="#fig-long-to-wide" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To tidy this type of data in Python, we can use the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function.
The <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function generally increases the number of columns (widens)
and decreases the number of rows in a data set.
To learn how to use <code class="docutils literal notranslate"><span class="pre">pivot</span></code>,
we will work through an example
with the <code class="docutils literal notranslate"><span class="pre">region_lang_top5_cities_long.csv</span></code> data set.
This data set contains the number of Canadians reporting
the primary language at home and work for five
major cities (Toronto, Montréal, Vancouver, Calgary, and Edmonton).</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang_top5_cities_long.csv&quot;</span><span class="p">)</span>
<span class="n">lang_long</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>type</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Montréal</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_home</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Montréal</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Toronto</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_home</td>
      <td>50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Toronto</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_home</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2135</th>
      <td>Calgary</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2136</th>
      <td>Edmonton</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_home</td>
      <td>280</td>
    </tr>
    <tr>
      <th>2137</th>
      <td>Edmonton</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2138</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_home</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2139</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2140 rows × 5 columns</p>
</div></div></div>
</div>
<p>What makes the data set shown above untidy?
In this example, each observation is a language in a region.
However, each observation is split across multiple rows:
one where the count for <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> is recorded,
and the other where the count for <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> is recorded.
Suppose the goal with this data was to
visualize the relationship between the number of
Canadians reporting their primary language at home and work.
Doing that would be difficult with this data in its current form,
since these two variables are stored in the same column.
<a class="reference internal" href="#fig-img-pivot-wider-table"><span class="std std-numref">Fig. 3.9</span></a> shows how this data
will be tidied using the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function.</p>
<figure class="figure align-default" id="fig-img-pivot-wider-table">
<img alt="_images/pandas_pivot_long-wide.png" src="_images/pandas_pivot_long-wide.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.9 </span><span class="caption-text">Going from long to wide with the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-wider-table" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-img-pivot-wider"><span class="std std-numref">Fig. 3.10</span></a> details the arguments that we need to specify in the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function.</p>
<figure class="figure align-default" id="fig-img-pivot-wider">
<img alt="_images/pandas_pivot_args_labels.png" src="_images/pandas_pivot_args_labels.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.10 </span><span class="caption-text">Syntax for the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-wider" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We will apply the function as detailed in <a class="reference internal" href="#fig-img-pivot-wider"><span class="std std-numref">Fig. 3.10</span></a>, and then
rename the columns.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_home_tidy</span> <span class="o">=</span> <span class="n">lang_long</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">lang_home_tidy</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="s2">&quot;category&quot;</span><span class="p">,</span>
    <span class="s2">&quot;language&quot;</span><span class="p">,</span>
    <span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span>
    <span class="s2">&quot;most_at_work&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">lang_home_tidy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Algonquian languages, n.i.e.</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Algonquin</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Athabaskan languages, n.i.e.</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Atikamekw</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>2495</td>
      <td>45</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>40</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>1622735</td>
      <td>1330555</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>French</td>
      <td>8630</td>
      <td>3245</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 5 columns</p>
</div></div></div>
</div>
<p id="index-22">In the first step, note that we added a call to <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>. When <code class="docutils literal notranslate"><span class="pre">pivot</span></code> is called with
multiple column names passed to the <code class="docutils literal notranslate"><span class="pre">index</span></code>, those entries become the “name” of each row that
would be used when you filter rows with <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">loc</span></code> rather than just simple numbers. This
can be confusing… What <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> does is sets us back with the usual expected behaviour
where each row is “named” with an integer. This is a subtle point, but the main take-away is that
when you call <code class="docutils literal notranslate"><span class="pre">pivot</span></code>, it is a good idea to call <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> afterwards.</p>
<p>The second operation we applied is to rename the columns. When we perform the <code class="docutils literal notranslate"><span class="pre">pivot</span></code>
operation, it keeps the original column name <code class="docutils literal notranslate"><span class="pre">&quot;count&quot;</span></code> and adds the <code class="docutils literal notranslate"><span class="pre">&quot;type&quot;</span></code> as a second column name.
Having two names for a column can be confusing! So we rename giving each column only one name.</p>
<p id="index-23">We can print out some useful information about our data frame using the <code class="docutils literal notranslate"><span class="pre">info</span></code> function.
In the first row it tells us the <code class="docutils literal notranslate"><span class="pre">type</span></code> of <code class="docutils literal notranslate"><span class="pre">lang_home_tidy</span></code> (it is a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>). The second
row tells us how many rows there are: 1070, and to index those rows, you can use numbers between
0 and 1069 (remember that Python starts counting at 0!). Next, there is a print out about the data
colums. Here there are 5 columns total. The little table it prints out tells you the name of each
column, the number of non-null values (e.g. the number of entries that are not missing values), and
the type of the entries. Finally the last two rows summarize the types of each column and how much
memory the data frame is using on your computer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_home_tidy</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1070 entries, 0 to 1069
Data columns (total 5 columns):
 #   Column        Non-Null Count  Dtype 
---  ------        --------------  ----- 
 0   region        1070 non-null   object
 1   category      1070 non-null   object
 2   language      1070 non-null   object
 3   most_at_home  1070 non-null   int64 
 4   most_at_work  1070 non-null   int64 
dtypes: int64(2), object(3)
memory usage: 41.9+ KB
</pre></div>
</div>
</div>
</div>
<p>The data is now tidy! We can go through the three criteria again to check
that this data is a tidy data set.</p>
<ol class="arabic simple">
<li><p>All the statistical variables are their own columns in the data frame (i.e.,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> have been separated into their own
columns in the data frame).</p></li>
<li><p>Each observation, (i.e., each language in a region) is in a single row.</p></li>
<li><p>Each value is a single cell (i.e., its row, column position in the data
frame is not shared with another value).</p></li>
</ol>
<p>You might notice that we have the same number of columns in the tidy data set as
we did in the messy one. Therefore <code class="docutils literal notranslate"><span class="pre">pivot</span></code> didn’t really “widen” the data.
This is just because the original <code class="docutils literal notranslate"><span class="pre">type</span></code> column only had
two categories in it. If it had more than two, <code class="docutils literal notranslate"><span class="pre">pivot</span></code> would have created
more columns, and we would see the data set “widen.”</p>
</section>
<section id="tidying-up-using-str-split-to-deal-with-multiple-separators">
<span id="str-split"></span><h3><span class="section-number">3.4.3. </span>Tidying up: using <code class="docutils literal notranslate"><span class="pre">str.split</span></code> to deal with multiple separators<a class="headerlink" href="#tidying-up-using-str-split-to-deal-with-multiple-separators" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-24"></span><p id="index-25">Data are also not considered tidy when multiple values are stored in the same
cell. The data set we show below is even messier than the ones we dealt with
above: the <code class="docutils literal notranslate"><span class="pre">Toronto</span></code>, <code class="docutils literal notranslate"><span class="pre">Montréal</span></code>, <code class="docutils literal notranslate"><span class="pre">Vancouver</span></code>, <code class="docutils literal notranslate"><span class="pre">Calgary</span></code>, and <code class="docutils literal notranslate"><span class="pre">Edmonton</span></code> columns
contain the number of Canadians reporting their primary language at home and
work in one column separated by the separator (<code class="docutils literal notranslate"><span class="pre">/</span></code>). The column names are the
values of a variable, <em>and</em> each value does not have its own cell! To turn this
messy data into tidy data, we’ll have to fix these issues.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_messy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang_top5_cities_messy.csv&quot;</span><span class="p">)</span>
<span class="n">lang_messy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>Toronto</th>
      <th>Montréal</th>
      <th>Vancouver</th>
      <th>Calgary</th>
      <th>Edmonton</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>50/0</td>
      <td>15/0</td>
      <td>15/0</td>
      <td>5/0</td>
      <td>10/0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>265/0</td>
      <td>10/0</td>
      <td>520/10</td>
      <td>505/15</td>
      <td>300/0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>185/10</td>
      <td>65/0</td>
      <td>10/0</td>
      <td>15/0</td>
      <td>20/0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>4045/20</td>
      <td>440/0</td>
      <td>125/10</td>
      <td>330/0</td>
      <td>445/0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>6380/215</td>
      <td>1445/20</td>
      <td>530/10</td>
      <td>620/25</td>
      <td>370/10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>75/0</td>
      <td>770/0</td>
      <td>5/0</td>
      <td>65/0</td>
      <td>90/10</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>0/10</td>
      <td>0/0</td>
      <td>5/0</td>
      <td>0/0</td>
      <td>20/0</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>3130/30</td>
      <td>760/15</td>
      <td>2495/45</td>
      <td>210/0</td>
      <td>120/0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>350/20</td>
      <td>6665/860</td>
      <td>10/0</td>
      <td>10/0</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>1080/10</td>
      <td>45/0</td>
      <td>40/0</td>
      <td>350/0</td>
      <td>280/0</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 7 columns</p>
</div></div></div>
</div>
<p>First we’ll use <code class="docutils literal notranslate"><span class="pre">melt</span></code> to create two columns, <code class="docutils literal notranslate"><span class="pre">region</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>,
similar to what we did previously.
The new <code class="docutils literal notranslate"><span class="pre">region</span></code> columns will contain the region names,
and the new column <code class="docutils literal notranslate"><span class="pre">value</span></code> will be a temporary holding place for the
data that we need to further separate, i.e., the
number of Canadians reporting their primary language at home and work.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_messy_longer</span> <span class="o">=</span> <span class="n">lang_messy</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">lang_messy_longer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50/0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265/0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185/10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045/20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380/215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90/10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20/0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120/0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280/0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>Next we’ll split the <code class="docutils literal notranslate"><span class="pre">value</span></code> column into two columns.
In basic Python, if we wanted to split the string <code class="docutils literal notranslate"><span class="pre">&quot;50/0&quot;</span></code> into two numbers <code class="docutils literal notranslate"><span class="pre">[&quot;50&quot;,</span> <span class="pre">&quot;0&quot;]</span></code>
we would use the  <code class="docutils literal notranslate"><span class="pre">split</span></code> method on the string, and specify that the split should be made
on the slash character <code class="docutils literal notranslate"><span class="pre">&quot;/&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;50/0&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;50&#39;, &#39;0&#39;]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> package provides similar functions that we can access
by using the <code class="docutils literal notranslate"><span class="pre">str</span></code> method. So to split all of the entries for an entire
column in a data frame, we will use the <code class="docutils literal notranslate"><span class="pre">str.split</span></code> method.
The output of this method is a data frame with two columns:
one containing only the counts of Canadians
that speak each language most at home,
and the other containing only the counts of Canadians
that speak each language most at work for each region.
We drop the no-longer-needed <code class="docutils literal notranslate"><span class="pre">value</span></code> column from the <code class="docutils literal notranslate"><span class="pre">lang_messy_longer</span></code>
data frame, and then assign the two columns from <code class="docutils literal notranslate"><span class="pre">str.split</span></code> to two new columns.
<a class="reference internal" href="#fig-img-separate"><span class="std std-numref">Fig. 3.11</span></a>
outlines what we need to specify to use <code class="docutils literal notranslate"><span class="pre">str.split</span></code>.</p>
<figure class="figure align-default" id="fig-img-separate">
<img alt="_images/str-split_args_labels.png" src="_images/str-split_args_labels.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.11 </span><span class="caption-text">Syntax for the <code class="docutils literal notranslate"><span class="pre">str.split</span></code> function.</span><a class="headerlink" href="#fig-img-separate" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span> <span class="o">=</span> <span class="n">lang_messy_longer</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
<span class="n">tidy_lang</span><span class="p">[[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_work&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">lang_messy_longer</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tidy_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 5 columns</p>
</div></div></div>
</div>
<p>Is this data set now tidy? If we recall the three criteria for tidy data:</p>
<ul class="simple">
<li><p>each row is a single observation,</p></li>
<li><p>each column is a single variable, and</p></li>
<li><p>each value is a single cell.</p></li>
</ul>
<p>We can see that this data now satisfies all three criteria, making it easier to
analyze. But we aren’t done yet! Although we can’t see it in the data frame above, all of the variables are actually
<code class="docutils literal notranslate"><span class="pre">object</span></code> data types. We can check this using the <code class="docutils literal notranslate"><span class="pre">info</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1070 entries, 0 to 1069
Data columns (total 5 columns):
 #   Column        Non-Null Count  Dtype 
---  ------        --------------  ----- 
 0   category      1070 non-null   object
 1   language      1070 non-null   object
 2   region        1070 non-null   object
 3   most_at_home  1070 non-null   object
 4   most_at_work  1070 non-null   object
dtypes: object(5)
memory usage: 41.9+ KB
</pre></div>
</div>
</div>
</div>
<p>Object columns in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> data frames are columns of strings or columns with
mixed types. In the previous example in <a class="reference internal" href="#pivot-wider"><span class="std std-numref">Section 3.4.2</span></a>, the
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> variables were <code class="docutils literal notranslate"><span class="pre">int64</span></code> (integer), which is a type of numeric data.
This change is due to the separator (<code class="docutils literal notranslate"><span class="pre">/</span></code>) when we read in this messy data set.
Python read these columns in as string types, and by default, <code class="docutils literal notranslate"><span class="pre">str.split</span></code> will
return columns with the <code class="docutils literal notranslate"><span class="pre">object</span></code> data type.</p>
<p>It makes sense for <code class="docutils literal notranslate"><span class="pre">region</span></code>, <code class="docutils literal notranslate"><span class="pre">category</span></code>, and <code class="docutils literal notranslate"><span class="pre">language</span></code> to be stored as an
<code class="docutils literal notranslate"><span class="pre">object</span></code> type since they hold categorical values. However, suppose we want to apply any functions that treat the
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> columns as a number (e.g., finding rows
above a numeric threshold of a column).
That won’t be possible if the variable is stored as an <code class="docutils literal notranslate"><span class="pre">object</span></code>.
Fortunately, the <code class="docutils literal notranslate"><span class="pre">astype</span></code> method from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides a natural way to fix problems
like this: it will convert the column to a selected data type. In this case, we choose the <code class="docutils literal notranslate"><span class="pre">int</span></code>
data type to indicate that these variables contain integer counts. Note that below
we <em>assign</em> the new numerical series to the <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> columns
in <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code>; we have seen this syntax before in <a class="reference internal" href="intro.html#ch1-adding-modifying"><span class="std std-numref">Section 1.9</span></a>,
and we will discuss it in more depth later in this chapter in <a class="reference internal" href="#pandas-assign"><span class="std std-numref">Section 3.11</span></a>.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_work&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_work&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">tidy_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1070 entries, 0 to 1069
Data columns (total 5 columns):
 #   Column        Non-Null Count  Dtype 
---  ------        --------------  ----- 
 0   category      1070 non-null   object
 1   language      1070 non-null   object
 2   region        1070 non-null   object
 3   most_at_home  1070 non-null   int64 
 4   most_at_work  1070 non-null   int64 
dtypes: int64(2), object(3)
memory usage: 41.9+ KB
</pre></div>
</div>
</div>
</div>
<p>Now we see <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> columns are of <code class="docutils literal notranslate"><span class="pre">int64</span></code> data types,
indicating they are integer data types (i.e., numbers)!</p>
</section>
</section>
<section id="using-to-extract-rows-or-columns">
<h2><span class="section-number">3.5. </span>Using <code class="docutils literal notranslate"><span class="pre">[]</span></code> to extract rows or columns<a class="headerlink" href="#using-to-extract-rows-or-columns" title="Permalink to this heading">#</a></h2>
<p>Now that the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data is indeed <em>tidy</em>, we can start manipulating it
using the powerful suite of functions from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.
We will first revisit the <code class="docutils literal notranslate"><span class="pre">[]</span></code> from <a class="reference internal" href="intro.html#intro"><span class="std std-numref">Chapter 1</span></a>,
which lets us obtain a subset of either the rows <strong>or</strong> the columns of a data frame.
This section will highlight more advanced usage of the <code class="docutils literal notranslate"><span class="pre">[]</span></code> function,
including an in-depth treatment of the variety of logical statements
one can use in the <code class="docutils literal notranslate"><span class="pre">[]</span></code> to select subsets of rows.</p>
<span class="target" id="index-26"></span><section id="extracting-columns-by-name">
<span id="index-27"></span><h3><span class="section-number">3.5.1. </span>Extracting columns by name<a class="headerlink" href="#extracting-columns-by-name" title="Permalink to this heading">#</a></h3>
<p>Recall that if we provide a list of column names, <code class="docutils literal notranslate"><span class="pre">[]</span></code> returns the subset of columns with those names as a data frame.
Suppose we wanted to select the columns <code class="docutils literal notranslate"><span class="pre">language</span></code>, <code class="docutils literal notranslate"><span class="pre">region</span></code>,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> from the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data set. Using what we
learned in <a class="reference internal" href="intro.html#intro"><span class="std std-numref">Chapter 1</span></a>, we can pass all of these column
names into the square brackets.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[[</span><span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_work&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>Likewise,
if we pass a list containing a single column name,
a data frame with this column will be returned.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[[</span><span class="s2">&quot;language&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Wolof</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Woods Cree</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Wu (Shanghainese)</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Yiddish</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Yoruba</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 1 columns</p>
</div></div></div>
</div>
<p>When we need to extract only a single column,
we can also pass the column name as a string rather than a list.
The returned data type will now be a series.
Throughout this textbook,
we will mostly extract single columns this way,
but we will point out a few occasions
where it is advantageous to extract single columns as data frames.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         Aboriginal languages, n.o.s.
1                            Afrikaans
2       Afro-Asiatic languages, n.i.e.
3                           Akan (Twi)
4                             Albanian
                     ...              
1065                             Wolof
1066                        Woods Cree
1067                 Wu (Shanghainese)
1068                           Yiddish
1069                            Yoruba
Name: language, Length: 1070, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="extracting-rows-that-have-a-certain-value-with">
<h3><span class="section-number">3.5.2. </span>Extracting rows that have a certain value with <code class="docutils literal notranslate"><span class="pre">==</span></code><a class="headerlink" href="#extracting-rows-that-have-a-certain-value-with" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-28"></span><p id="index-29">Suppose we are only interested in the subset of rows in <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> corresponding to the
official languages of Canada (English and French).
We can extract these rows by using the <em>equivalency operator</em> (<code class="docutils literal notranslate"><span class="pre">==</span></code>)
to compare the values of the <code class="docutils literal notranslate"><span class="pre">category</span></code> column
with the value <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code>.
With these arguments, <code class="docutils literal notranslate"><span class="pre">[]</span></code> returns a data frame with all the columns
of the input data frame
but only the rows we asked for in the logical statement, i.e.,
those where the <code class="docutils literal notranslate"><span class="pre">category</span></code> column holds the value <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code>.
We name this data frame <code class="docutils literal notranslate"><span class="pre">official_langs</span></code>.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="p">[</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Official languages&quot;</span><span class="p">]</span>
<span class="n">official_langs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Toronto</td>
      <td>29800</td>
      <td>11940</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Montréal</td>
      <td>620510</td>
      <td>412120</td>
    </tr>
    <tr>
      <th>273</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Montréal</td>
      <td>2669195</td>
      <td>1607550</td>
    </tr>
    <tr>
      <th>482</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Vancouver</td>
      <td>1622735</td>
      <td>1330555</td>
    </tr>
    <tr>
      <th>487</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Vancouver</td>
      <td>8630</td>
      <td>3245</td>
    </tr>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
    </tr>
    <tr>
      <th>701</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Calgary</td>
      <td>8630</td>
      <td>2140</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
    </tr>
    <tr>
      <th>915</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Edmonton</td>
      <td>10950</td>
      <td>2520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="extracting-rows-that-do-not-have-a-certain-value-with">
<h3><span class="section-number">3.5.3. </span>Extracting rows that do not have a certain value with <code class="docutils literal notranslate"><span class="pre">!=</span></code><a class="headerlink" href="#extracting-rows-that-do-not-have-a-certain-value-with" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-30"></span><p id="index-31">What if we want all the other language categories in the data set <em>except</em> for
those in the <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code> category? We can accomplish this with the <code class="docutils literal notranslate"><span class="pre">!=</span></code>
operator, which means “not equal to”. So if we want to find all the rows
where the <code class="docutils literal notranslate"><span class="pre">category</span></code> does <em>not</em> equal <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code> we write the code
below.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Official languages&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1060 rows × 5 columns</p>
</div></div></div>
</div>
</section>
<section id="extracting-rows-satisfying-multiple-conditions-using">
<span id="filter-and"></span><h3><span class="section-number">3.5.4. </span>Extracting rows satisfying multiple conditions using <code class="docutils literal notranslate"><span class="pre">&amp;</span></code><a class="headerlink" href="#extracting-rows-satisfying-multiple-conditions-using" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-32"></span><p id="index-33">Suppose now we want to look at only the rows
for the French language in Montréal.
To do this, we need to filter the data set
to find rows that satisfy multiple conditions simultaneously.
We can do this with the ampersand symbol (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>), which
is interpreted by Python as “and”.
We write the code as shown below to filter the <code class="docutils literal notranslate"><span class="pre">official_langs</span></code> data frame
to subset the rows where <code class="docutils literal notranslate"><span class="pre">region</span> <span class="pre">==</span> <span class="pre">&quot;Montréal&quot;</span></code>
<em>and</em> <code class="docutils literal notranslate"><span class="pre">language</span> <span class="pre">==</span> <span class="pre">&quot;French&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[</span>
  <span class="p">(</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">)</span> <span class="o">&amp;</span>
  <span class="p">(</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;French&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>273</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Montréal</td>
      <td>2669195</td>
      <td>1607550</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="extracting-rows-satisfying-at-least-one-condition-using">
<h3><span class="section-number">3.5.5. </span>Extracting rows satisfying at least one condition using <code class="docutils literal notranslate"><span class="pre">|</span></code><a class="headerlink" href="#extracting-rows-satisfying-at-least-one-condition-using" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-34"></span><p id="index-35">Suppose we were interested in only those rows corresponding to cities in Alberta
in the <code class="docutils literal notranslate"><span class="pre">official_langs</span></code> data set (Edmonton and Calgary).
We can’t use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> as we did above because <code class="docutils literal notranslate"><span class="pre">region</span></code>
cannot be both Edmonton <em>and</em> Calgary simultaneously.
Instead, we can use the vertical pipe (<code class="docutils literal notranslate"><span class="pre">|</span></code>) logical operator,
which gives us the cases where one condition <em>or</em>
another condition <em>or</em> both are satisfied.
In the code below, we ask Python to return the rows
where the <code class="docutils literal notranslate"><span class="pre">region</span></code> columns are equal to “Calgary” <em>or</em> “Edmonton”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs</span><span class="p">[</span>
    <span class="p">(</span><span class="n">official_langs</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">)</span> <span class="o">|</span>
    <span class="p">(</span><span class="n">official_langs</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
    </tr>
    <tr>
      <th>701</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Calgary</td>
      <td>8630</td>
      <td>2140</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
    </tr>
    <tr>
      <th>915</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Edmonton</td>
      <td>10950</td>
      <td>2520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="extracting-rows-with-values-in-a-list-using-isin">
<h3><span class="section-number">3.5.6. </span>Extracting rows with values in a list using <code class="docutils literal notranslate"><span class="pre">isin</span></code><a class="headerlink" href="#extracting-rows-with-values-in-a-list-using-isin" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-36"></span><p id="index-37">Next, suppose we want to see the populations of our five cities.
Let’s read in the <code class="docutils literal notranslate"><span class="pre">region_data.csv</span></code> file
that comes from the 2016 Canadian census,
as it contains statistics for number of households, land area, population
and number of dwellings for different regions.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_data.csv&quot;</span><span class="p">)</span>
<span class="n">region_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>households</th>
      <th>area</th>
      <th>population</th>
      <th>dwellings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Belleville</td>
      <td>43002</td>
      <td>1354.65121</td>
      <td>103472</td>
      <td>45050</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lethbridge</td>
      <td>45696</td>
      <td>3046.69699</td>
      <td>117394</td>
      <td>48317</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Thunder Bay</td>
      <td>52545</td>
      <td>2618.26318</td>
      <td>121621</td>
      <td>57146</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Peterborough</td>
      <td>50533</td>
      <td>1636.98336</td>
      <td>121721</td>
      <td>55662</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saint John</td>
      <td>52872</td>
      <td>3793.42158</td>
      <td>126202</td>
      <td>58398</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Ottawa - Gatineau</td>
      <td>535499</td>
      <td>7168.96442</td>
      <td>1323783</td>
      <td>571146</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Calgary</td>
      <td>519693</td>
      <td>5241.70103</td>
      <td>1392609</td>
      <td>544870</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Vancouver</td>
      <td>960894</td>
      <td>3040.41532</td>
      <td>2463431</td>
      <td>1027613</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Montréal</td>
      <td>1727310</td>
      <td>4638.24059</td>
      <td>4098927</td>
      <td>1823281</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Toronto</td>
      <td>2135909</td>
      <td>6269.93132</td>
      <td>5928040</td>
      <td>2235145</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 5 columns</p>
</div></div></div>
</div>
<p>To get the population of the five cities
we can filter the data set using the <code class="docutils literal notranslate"><span class="pre">isin</span></code> method.
The <code class="docutils literal notranslate"><span class="pre">isin</span></code> method is used to see if an element belongs to a list.
Here we are filtering for rows where the value in the <code class="docutils literal notranslate"><span class="pre">region</span></code> column
matches any of the five cities we are intersted in: Toronto, Montréal,
Vancouver, Calgary, and Edmonton.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">city_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">]</span>
<span class="n">five_cities</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">city_names</span><span class="p">)]</span>
<span class="n">five_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>households</th>
      <th>area</th>
      <th>population</th>
      <th>dwellings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29</th>
      <td>Edmonton</td>
      <td>502143</td>
      <td>9857.77908</td>
      <td>1321426</td>
      <td>537634</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Calgary</td>
      <td>519693</td>
      <td>5241.70103</td>
      <td>1392609</td>
      <td>544870</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Vancouver</td>
      <td>960894</td>
      <td>3040.41532</td>
      <td>2463431</td>
      <td>1027613</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Montréal</td>
      <td>1727310</td>
      <td>4638.24059</td>
      <td>4098927</td>
      <td>1823281</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Toronto</td>
      <td>2135909</td>
      <td>6269.93132</td>
      <td>5928040</td>
      <td>2235145</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What’s the difference between <code class="docutils literal notranslate"><span class="pre">==</span></code> and <code class="docutils literal notranslate"><span class="pre">isin</span></code>? Suppose we have two
Series, <code class="docutils literal notranslate"><span class="pre">seriesA</span></code> and <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>. If you type <code class="docutils literal notranslate"><span class="pre">seriesA</span> <span class="pre">==</span> <span class="pre">seriesB</span></code> into Python it
will compare the series element by element. Python checks if the first element of
<code class="docutils literal notranslate"><span class="pre">seriesA</span></code> equals the first element of <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>, the second element of
<code class="docutils literal notranslate"><span class="pre">seriesA</span></code> equals the second element of <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>, and so on. On the other hand,
<code class="docutils literal notranslate"><span class="pre">seriesA.isin(seriesB)</span></code> compares the first element of <code class="docutils literal notranslate"><span class="pre">seriesA</span></code> to all the
elements in <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>. Then the second element of <code class="docutils literal notranslate"><span class="pre">seriesA</span></code> is compared
to all the elements in <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>, and so on. Notice the difference between <code class="docutils literal notranslate"><span class="pre">==</span></code> and
<code class="docutils literal notranslate"><span class="pre">isin</span></code> in the example below.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Toronto&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Toronto&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    True
1    True
dtype: bool
</pre></div>
</div>
</div>
</div>
</section>
<section id="extracting-rows-above-or-below-a-threshold-using-and">
<h3><span class="section-number">3.5.7. </span>Extracting rows above or below a threshold using <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;</span></code><a class="headerlink" href="#extracting-rows-above-or-below-a-threshold-using-and" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-38"></span><span class="target" id="index-39"></span><span class="target" id="index-40"></span><span class="target" id="index-41"></span><p id="index-42">We saw in <a class="reference internal" href="#filter-and"><span class="std std-numref">Section 3.5.4</span></a> that
<span class="pasted-text">2,669,195</span> people reported
speaking French in Montréal as their primary language at home.
If we are interested in finding the official languages in regions
with higher numbers of people who speak it as their primary language at home
compared to French in Montréal, then we can use <code class="docutils literal notranslate"><span class="pre">[]</span></code> to obtain rows
where the value of <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> is greater than
<span class="pasted-text">2,669,195</span>. We use the <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> symbol to look for values <em>above</em> a threshold,
and the <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> symbol to look for values <em>below</em> a threshold. The <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>
symbols similarly look for <em>equal to or above</em> a threshold and <em>equal to or below</em> a threshold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs</span><span class="p">[</span><span class="n">official_langs</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2669195</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This operation returns a data frame with only one row, indicating that when
considering the official languages,
only English in Toronto is reported by more people
as their primary language at home
than French in Montréal according to the 2016 Canadian census.</p>
</section>
<section id="extracting-rows-using-query">
<h3><span class="section-number">3.5.8. </span>Extracting rows using <code class="docutils literal notranslate"><span class="pre">query</span></code><a class="headerlink" href="#extracting-rows-using-query" title="Permalink to this heading">#</a></h3>
<p id="index-43">You can also extract rows above, below, equal or not-equal to a threshold using the
<code class="docutils literal notranslate"><span class="pre">query</span></code> method. For example the following gives us the same result as when we used
<code class="docutils literal notranslate"><span class="pre">official_langs[official_langs[&quot;most_at_home&quot;]</span> <span class="pre">&gt;</span> <span class="pre">2669195]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;most_at_home &gt; 2669195&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The query (criteria we are using to select values) is input as a string. The <code class="docutils literal notranslate"><span class="pre">query</span></code> method
is less often used than the earlier approaches we introduced, but it can come in handy
to make long chains of filtering operations a bit easier to read.</p>
</section>
</section>
<section id="using-loc-to-filter-rows-and-select-columns">
<span id="loc-iloc"></span><h2><span class="section-number">3.6. </span>Using <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> to filter rows and select columns<a class="headerlink" href="#using-loc-to-filter-rows-and-select-columns" title="Permalink to this heading">#</a></h2>
<p id="index-44">The <code class="docutils literal notranslate"><span class="pre">[]</span></code> operation is only used when you want to either filter rows <strong>or</strong> select columns;
it cannot be used to do both operations at the same time. This is where <code class="docutils literal notranslate"><span class="pre">loc[]</span></code>
comes in. For the first example, recall <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> from <a class="reference internal" href="intro.html#intro"><span class="std std-numref">Chapter 1</span></a>,
which lets us create a subset of the rows and columns in the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data frame.
In the first argument to <code class="docutils literal notranslate"><span class="pre">loc[]</span></code>, we specify a logical statement that
filters the rows to only those pertaining to the Toronto region,
and the second argument specifies a list of columns to keep by name.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Toronto&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_work&quot;</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Wolof</td>
      <td>Toronto</td>
      <td>75</td>
      <td>0</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Woods Cree</td>
      <td>Toronto</td>
      <td>0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Wu (Shanghainese)</td>
      <td>Toronto</td>
      <td>3130</td>
      <td>30</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Yiddish</td>
      <td>Toronto</td>
      <td>350</td>
      <td>20</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Yoruba</td>
      <td>Toronto</td>
      <td>1080</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 4 columns</p>
</div></div></div>
</div>
<p>In addition to simultaneous subsetting of rows and columns, <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> has two
more special capabilities beyond those of <code class="docutils literal notranslate"><span class="pre">[]</span></code>. First, <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> has the ability to specify <em>ranges</em> of rows and columns.
For example, note that the list of columns <code class="docutils literal notranslate"><span class="pre">language</span></code>, <code class="docutils literal notranslate"><span class="pre">region</span></code>, <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>
corresponds to the <em>range</em> of columns from <code class="docutils literal notranslate"><span class="pre">language</span></code> to <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>.
Rather than explicitly listing all of the column names as we did above,
we can ask for the range of columns <code class="docutils literal notranslate"><span class="pre">&quot;language&quot;:&quot;most_at_work&quot;</span></code>; the <code class="docutils literal notranslate"><span class="pre">:</span></code>-syntax
denotes a range, and is supported by the <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> function, but not by <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Toronto&quot;</span><span class="p">,</span>
    <span class="s2">&quot;language&quot;</span><span class="p">:</span><span class="s2">&quot;most_at_work&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Wolof</td>
      <td>Toronto</td>
      <td>75</td>
      <td>0</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Woods Cree</td>
      <td>Toronto</td>
      <td>0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Wu (Shanghainese)</td>
      <td>Toronto</td>
      <td>3130</td>
      <td>30</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Yiddish</td>
      <td>Toronto</td>
      <td>350</td>
      <td>20</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Yoruba</td>
      <td>Toronto</td>
      <td>1080</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 4 columns</p>
</div></div></div>
</div>
<p>We can pass <code class="docutils literal notranslate"><span class="pre">:</span></code> by itself—without anything before or after—to denote that we want to retrieve
everything. For example, to obtain a subset of all rows and only those columns ranging from <code class="docutils literal notranslate"><span class="pre">language</span></code> to <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>,
we could use the following expression.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;language&quot;</span><span class="p">:</span><span class="s2">&quot;most_at_work&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>We can also omit the beginning or end of the <code class="docutils literal notranslate"><span class="pre">:</span></code> range expression to denote
that we want “everything up to” or “everything after” an element. For example,
if we want all of the columns including and after <code class="docutils literal notranslate"><span class="pre">language</span></code>, we can write the expression:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;language&quot;</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>By not putting anything after the <code class="docutils literal notranslate"><span class="pre">:</span></code>, Python reads this as “from <code class="docutils literal notranslate"><span class="pre">language</span></code> until the last column”.
Similarly, we can specify that we want everything up to and including <code class="docutils literal notranslate"><span class="pre">language</span></code> by writing
the expression:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">:</span><span class="s2">&quot;language&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 2 columns</p>
</div></div></div>
</div>
<p>By not putting anything before the <code class="docutils literal notranslate"><span class="pre">:</span></code>, Python reads this as “from the first column until <code class="docutils literal notranslate"><span class="pre">language</span></code>.”
Although the notation for selecting a range using <code class="docutils literal notranslate"><span class="pre">:</span></code> is convenient because less code is required,
it must be used carefully. If you were to re-order columns or add a column to the data frame, the
output would change. Using a list is more explicit and less prone to potential confusion, but sometimes
involves a lot more typing.</p>
<p>The second special capability of <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> over <code class="docutils literal notranslate"><span class="pre">[]</span></code> is that it enables <em>selecting columns</em> using
logical statements. The <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator can only use logical statements to filter rows; <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> can do both!
For example, let’s say we wanted only to select the
columns <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>. We could then use the <code class="docutils literal notranslate"><span class="pre">.str.startswith</span></code> method
to choose only the columns that start with the word “most”.
The <code class="docutils literal notranslate"><span class="pre">str.startswith</span></code> expression returns a list of <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> values
corresponding to the column names that start with the desired characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">tidy_lang</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;most&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 2 columns</p>
</div></div></div>
</div>
<p id="index-45">We could also have chosen the columns containing an underscore <code class="docutils literal notranslate"><span class="pre">_</span></code> by using the
<code class="docutils literal notranslate"><span class="pre">.str.contains(&quot;_&quot;)</span></code>, since we notice
the columns we want contain underscores and the others don’t.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">tidy_lang</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 2 columns</p>
</div></div></div>
</div>
</section>
<section id="using-iloc-to-extract-rows-and-columns-by-position">
<h2><span class="section-number">3.7. </span>Using <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code> to extract rows and columns by position<a class="headerlink" href="#using-iloc-to-extract-rows-and-columns-by-position" title="Permalink to this heading">#</a></h2>
<p id="index-46">Another approach for selecting rows and columns is to use <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code>,
which provides the ability to index with the position rather than the label of the columns.
For example, the column labels of the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data frame are
<code class="docutils literal notranslate"><span class="pre">[&quot;category&quot;,</span> <span class="pre">&quot;language&quot;,</span> <span class="pre">&quot;region&quot;,</span> <span class="pre">&quot;most_at_home&quot;,</span> <span class="pre">&quot;most_at_work&quot;]</span></code>.
Using <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code>, you can ask for the <code class="docutils literal notranslate"><span class="pre">language</span></code> column by requesting the
column at index <code class="docutils literal notranslate"><span class="pre">1</span></code> (remember that Python starts counting at <code class="docutils literal notranslate"><span class="pre">0</span></code>, so the second column <code class="docutils literal notranslate"><span class="pre">&quot;language&quot;</span></code>
has index <code class="docutils literal notranslate"><span class="pre">1</span></code>!).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         Aboriginal languages, n.o.s.
1                            Afrikaans
2       Afro-Asiatic languages, n.i.e.
3                           Akan (Twi)
4                             Albanian
                     ...              
1065                             Wolof
1066                        Woods Cree
1067                 Wu (Shanghainese)
1068                           Yiddish
1069                            Yoruba
Name: language, Length: 1070, dtype: object
</pre></div>
</div>
</div>
</div>
<p>You can also ask for multiple columns.
We pass <code class="docutils literal notranslate"><span class="pre">1:</span></code> after the comma
indicating we want columns after and including index 1 (<em>i.e.</em> <code class="docutils literal notranslate"><span class="pre">language</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code> to select ranges of rows, or simultaneously select ranges of rows and columns, using a similar syntax.
For example, to select the first five rows and columns after and including index 1, we could use the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code> method is not commonly used, and must be used with care.
For example, it is easy to
accidentally put in the wrong integer index! If you did not correctly remember
that the <code class="docutils literal notranslate"><span class="pre">language</span></code> column was index <code class="docutils literal notranslate"><span class="pre">1</span></code>, and used <code class="docutils literal notranslate"><span class="pre">2</span></code> instead, your code
might end up having a bug that is quite hard to track down.</p>
</section>
<section id="aggregating-data">
<span id="index-47"></span><h2><span class="section-number">3.8. </span>Aggregating data<a class="headerlink" href="#aggregating-data" title="Permalink to this heading">#</a></h2>
<section id="calculating-summary-statistics-on-individual-columns">
<h3><span class="section-number">3.8.1. </span>Calculating summary statistics on individual columns<a class="headerlink" href="#calculating-summary-statistics-on-individual-columns" title="Permalink to this heading">#</a></h3>
<p id="index-48">As a part of many data analyses, we need to calculate a summary value for the
data (a <em>summary statistic</em>).
Examples of summary statistics we might want to calculate
are the number of observations, the average/mean value for a column,
the minimum value, etc.
Oftentimes,
this summary statistic is calculated from the values in a data frame column,
or columns, as shown in <a class="reference internal" href="#fig-summarize"><span class="std std-numref">Fig. 3.12</span></a>.</p>
<figure class="figure align-default" id="fig-summarize">
<img alt="_images/summarize.001.png" src="_images/summarize.001.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.12 </span><span class="caption-text">Calculating summary statistics on one or more column(s) in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> generally
creates a series or data frame containing the summary statistic(s) for each column
being summarized. The darker, top row of each table represents column headers.</span><a class="headerlink" href="#fig-summarize" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We will start by showing how to compute the minimum and maximum number of Canadians reporting a particular
language as their primary language at home. First, a reminder of what <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> looks like:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang.csv&quot;</span><span class="p">)</span>
<span class="n">region_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 7 columns</p>
</div></div></div>
</div>
<p id="index-49">We use <code class="docutils literal notranslate"><span class="pre">.min</span></code> to calculate the minimum
and <code class="docutils literal notranslate"><span class="pre">.max</span></code> to calculate maximum number of Canadians
reporting a particular language as their primary language at home,
for any region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3836770
</pre></div>
</div>
</div>
</div>
<p>From this we see that there are some languages in the data set that no one speaks
as their primary language at home. We also see that the most commonly spoken
primary language at home is spoken by
<span class="pasted-text">3,836,770</span> people. If instead we wanted to know the
total number of people in the survey, we could use the <code class="docutils literal notranslate"><span class="pre">sum</span></code> summary statistic method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23171710
</pre></div>
</div>
</div>
</div>
<p id="index-50">Other handy summary statistics include the <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">median</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span></code> for
computing the mean, median, and standard deviation of observations, respectively.
We can also compute multiple statistics at once using <code class="docutils literal notranslate"><span class="pre">agg</span></code> to “aggregate” results.
For example, if we wanted to
compute both the <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> at once, we could use <code class="docutils literal notranslate"><span class="pre">agg</span></code> with the argument <code class="docutils literal notranslate"><span class="pre">[&quot;min&quot;,</span> <span class="pre">&quot;max&quot;]</span></code>.
Note that <code class="docutils literal notranslate"><span class="pre">agg</span></code> outputs a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min          0
max    3836770
Name: most_at_home, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> package also provides the <code class="docutils literal notranslate"><span class="pre">describe</span></code> method,
which is a handy function that computes many common summary statistics at once; it
gives us a <em>summary</em> of a variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    7.490000e+03
mean     3.093686e+03
std      6.401258e+04
min      0.000000e+00
25%      0.000000e+00
50%      0.000000e+00
75%      3.000000e+01
max      3.836770e+06
Name: most_at_home, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>In addition to the summary methods we introduced earlier, the <code class="docutils literal notranslate"><span class="pre">describe</span></code> method
outputs a <code class="docutils literal notranslate"><span class="pre">count</span></code> (the total number of observations, or rows, in our data frame),
as well as the 25th, 50th, and 75th percentiles.
<a class="reference internal" href="#tab-basic-summary-statistics"><span class="std std-numref">Table 3.3</span></a> provides an overview of some of the useful
summary statistics that you can compute with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<table class="colwidths-auto table" id="tab-basic-summary-statistics">
<caption><span class="caption-number">Table 3.3 </span><span class="caption-text">Basic summary statistics</span><a class="headerlink" href="#tab-basic-summary-statistics" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">count</span></code></p></td>
<td><p>The number of observations (rows)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mean</span></code></p></td>
<td><p>The mean of the observations</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">median</span></code></p></td>
<td><p>The median value of the observations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">std</span></code></p></td>
<td><p>The standard deviation of the observations</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max</span></code></p></td>
<td><p>The largest value in a column</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">min</span></code></p></td>
<td><p>The smallest value in a column</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sum</span></code></p></td>
<td><p>The sum of all observations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">agg</span></code></p></td>
<td><p>Aggregate multiple statistics together</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">describe</span></code></p></td>
<td><p>a summary</p></td>
</tr>
</tbody>
</table>
<span class="target" id="index-51"></span><div class="admonition note" id="index-52">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, the value <code class="docutils literal notranslate"><span class="pre">NaN</span></code> is often used to denote missing data.
By default, when <code class="docutils literal notranslate"><span class="pre">pandas</span></code> calculates summary statistics (e.g., <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, etc),
it ignores these values. If you look at the documentation for these functions, you will
see an input variable <code class="docutils literal notranslate"><span class="pre">skipna</span></code>, which by default is set to <code class="docutils literal notranslate"><span class="pre">skipna=True</span></code>. This means that
<code class="docutils literal notranslate"><span class="pre">pandas</span></code> will skip <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values when computing statistics.</p>
</div>
</section>
<section id="calculating-summary-statistics-on-data-frames">
<h3><span class="section-number">3.8.2. </span>Calculating summary statistics on data frames<a class="headerlink" href="#calculating-summary-statistics-on-data-frames" title="Permalink to this heading">#</a></h3>
<p>What if you want to calculate summary statistics on an entire data frame? Well,
it turns out that the functions in <a class="reference internal" href="#tab-basic-summary-statistics"><span class="std std-numref">Table 3.3</span></a>
can be applied to a whole data frame!
For example, we can ask for the maximum value of each each column has using <code class="docutils literal notranslate"><span class="pre">max</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region                     Winnipeg
category         Official languages
language                     Yoruba
mother_tongue               3061820
most_at_home                3836770
most_at_work                3218725
lang_known                  5600480
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We can see that for columns that contain string data
with words like <code class="docutils literal notranslate"><span class="pre">&quot;Vancouver&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Halifax&quot;</span></code>,
the maximum value is determined by sorting the string alphabetically
and returning the last value.
If we only want the maximum value for
numeric columns,
we can provide <code class="docutils literal notranslate"><span class="pre">numeric_only=True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mother_tongue    3061820
most_at_home     3836770
most_at_work     3218725
lang_known       5600480
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We could also ask for the <code class="docutils literal notranslate"><span class="pre">mean</span></code> for each columns in the dataframe.
It does not make sense to compute the mean of the string columns,
so in this case we <em>must</em> provide the keyword <code class="docutils literal notranslate"><span class="pre">numeric_only=True</span></code>
so that the mean is only computed on columns with numeric values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mother_tongue    3200.341121
most_at_home     3093.686248
most_at_work     1853.757677
lang_known       5127.499332
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>If there are only some columns for which you would like to get summary statistics,
you can first use <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> to select those columns,
and then ask for the summary statistic
as we did for a single column previously.
For example, if we want to know
the mean and standard deviation of all of the columns between <code class="docutils literal notranslate"><span class="pre">&quot;mother_tongue&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;lang_known&quot;</span></code>,
we use <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> to select those columns and then <code class="docutils literal notranslate"><span class="pre">agg</span></code> to ask for both the <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;mother_tongue&quot;</span><span class="p">:</span><span class="s2">&quot;lang_known&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>3200.341121</td>
      <td>3093.686248</td>
      <td>1853.757677</td>
      <td>5127.499332</td>
    </tr>
    <tr>
      <th>std</th>
      <td>55231.640268</td>
      <td>64012.578320</td>
      <td>48574.532066</td>
      <td>94001.162338</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="performing-operations-on-groups-of-rows-using-groupby">
<h2><span class="section-number">3.9. </span>Performing operations on groups of rows using <code class="docutils literal notranslate"><span class="pre">groupby</span></code><a class="headerlink" href="#performing-operations-on-groups-of-rows-using-groupby" title="Permalink to this heading">#</a></h2>
<p id="index-53">What happens if we want to know how languages vary by region? In this case,
we need a new tool that lets us group rows by region. This can be achieved
using the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> function in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. Pairing summary functions
with <code class="docutils literal notranslate"><span class="pre">groupby</span></code> lets you summarize values for subgroups within a data set,
as illustrated in <a class="reference internal" href="#fig-summarize-groupby"><span class="std std-numref">Fig. 3.13</span></a>.
For example, we can use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> to group the regions of the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data
frame and then calculate the minimum and maximum number of Canadians
reporting the language as the primary language at home
for each of the regions in the data set.</p>
<figure class="figure align-default" id="fig-summarize-groupby">
<img alt="_images/summarize.002.png" src="_images/summarize.002.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.13 </span><span class="caption-text">A summary statistic function paired with <code class="docutils literal notranslate"><span class="pre">groupby</span></code> is useful for calculating that statistic
on one or more column(s) for each group. It
creates a new data frame with one row for each group
and one column for each summary statistic. The darker, top row of each table
represents the column headers. The orange, blue, and green colored rows
correspond to the rows that belong to each of the three groups being
represented in this cartoon example.</span><a class="headerlink" href="#fig-summarize-groupby" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> function takes at least one argument—the columns to use in the
grouping. Here we use only one column for grouping (<code class="docutils literal notranslate"><span class="pre">region</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f9289e69910&gt;
</pre></div>
</div>
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">groupby</span></code> converts a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object to a <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code>
object, which contains information about the groups of the data frame. We can
then apply aggregating functions to the <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object. Here we first
select the <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> column, and then summarize the grouped data by their
minimum and maximum values using <code class="docutils literal notranslate"><span class="pre">agg</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>region</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Abbotsford - Mission</th>
      <td>0</td>
      <td>137445</td>
    </tr>
    <tr>
      <th>Barrie</th>
      <td>0</td>
      <td>182390</td>
    </tr>
    <tr>
      <th>Belleville</th>
      <td>0</td>
      <td>97840</td>
    </tr>
    <tr>
      <th>Brantford</th>
      <td>0</td>
      <td>124560</td>
    </tr>
    <tr>
      <th>Calgary</th>
      <td>0</td>
      <td>1065070</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Trois-Rivières</th>
      <td>0</td>
      <td>149835</td>
    </tr>
    <tr>
      <th>Vancouver</th>
      <td>0</td>
      <td>1622735</td>
    </tr>
    <tr>
      <th>Victoria</th>
      <td>0</td>
      <td>331375</td>
    </tr>
    <tr>
      <th>Windsor</th>
      <td>0</td>
      <td>270715</td>
    </tr>
    <tr>
      <th>Winnipeg</th>
      <td>0</td>
      <td>612595</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 2 columns</p>
</div></div></div>
</div>
<p>The resulting dataframe has <code class="docutils literal notranslate"><span class="pre">region</span></code> as an index name.
This is similar to what happened when we used the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function
in <a class="reference internal" href="#pivot-wider"><span class="std std-numref">Section 3.4.2</span></a>;
and just as we did then,
you can use <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> to get back to a regular dataframe
with <code class="docutils literal notranslate"><span class="pre">region</span></code> as a column name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Abbotsford - Mission</td>
      <td>0</td>
      <td>137445</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barrie</td>
      <td>0</td>
      <td>182390</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belleville</td>
      <td>0</td>
      <td>97840</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brantford</td>
      <td>0</td>
      <td>124560</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>0</td>
      <td>1065070</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Trois-Rivières</td>
      <td>0</td>
      <td>149835</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Vancouver</td>
      <td>0</td>
      <td>1622735</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Victoria</td>
      <td>0</td>
      <td>331375</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Windsor</td>
      <td>0</td>
      <td>270715</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Winnipeg</td>
      <td>0</td>
      <td>612595</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 3 columns</p>
</div></div></div>
</div>
<p>You can also pass multiple column names to <code class="docutils literal notranslate"><span class="pre">groupby</span></code>. For example, if we wanted to
know about how the different categories of languages (Aboriginal, Non-Official &amp;
Non-Aboriginal, and  Official) are spoken at home in different regions, we would pass a
list including <code class="docutils literal notranslate"><span class="pre">region</span></code> and <code class="docutils literal notranslate"><span class="pre">category</span></code> to <code class="docutils literal notranslate"><span class="pre">groupby</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">])[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Abbotsford - Mission</td>
      <td>Aboriginal languages</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>0</td>
      <td>23015</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Abbotsford - Mission</td>
      <td>Official languages</td>
      <td>250</td>
      <td>137445</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Barrie</td>
      <td>Aboriginal languages</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Barrie</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>0</td>
      <td>875</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Windsor</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>0</td>
      <td>8235</td>
    </tr>
    <tr>
      <th>101</th>
      <td>Windsor</td>
      <td>Official languages</td>
      <td>2695</td>
      <td>270715</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Winnipeg</td>
      <td>Aboriginal languages</td>
      <td>0</td>
      <td>365</td>
    </tr>
    <tr>
      <th>103</th>
      <td>Winnipeg</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>0</td>
      <td>23565</td>
    </tr>
    <tr>
      <th>104</th>
      <td>Winnipeg</td>
      <td>Official languages</td>
      <td>11185</td>
      <td>612595</td>
    </tr>
  </tbody>
</table>
<p>105 rows × 4 columns</p>
</div></div></div>
</div>
<p>You can also ask for grouped summary statistics on the whole data frame.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>region</th>
      <th colspan="2" halign="left">category</th>
      <th colspan="2" halign="left">language</th>
      <th colspan="2" halign="left">mother_tongue</th>
      <th colspan="2" halign="left">most_at_home</th>
      <th colspan="2" halign="left">most_at_work</th>
      <th colspan="2" halign="left">lang_known</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Abbotsford - Mission</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>122100</td>
      <td>0</td>
      <td>137445</td>
      <td>0</td>
      <td>93495</td>
      <td>0</td>
      <td>167835</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barrie</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>168990</td>
      <td>0</td>
      <td>182390</td>
      <td>0</td>
      <td>115125</td>
      <td>0</td>
      <td>193445</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belleville</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>93655</td>
      <td>0</td>
      <td>97840</td>
      <td>0</td>
      <td>54150</td>
      <td>0</td>
      <td>100855</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brantford</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>116645</td>
      <td>0</td>
      <td>124560</td>
      <td>0</td>
      <td>73910</td>
      <td>0</td>
      <td>130835</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>937055</td>
      <td>0</td>
      <td>1065070</td>
      <td>0</td>
      <td>844740</td>
      <td>0</td>
      <td>1343335</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Trois-Rivières</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>147805</td>
      <td>0</td>
      <td>149835</td>
      <td>0</td>
      <td>78610</td>
      <td>0</td>
      <td>149805</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Vancouver</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>1316635</td>
      <td>0</td>
      <td>1622735</td>
      <td>0</td>
      <td>1330555</td>
      <td>0</td>
      <td>2289515</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Victoria</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>302690</td>
      <td>0</td>
      <td>331375</td>
      <td>0</td>
      <td>211705</td>
      <td>0</td>
      <td>354470</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Windsor</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>235990</td>
      <td>0</td>
      <td>270715</td>
      <td>0</td>
      <td>166220</td>
      <td>0</td>
      <td>318540</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Winnipeg</td>
      <td>Aboriginal languages</td>
      <td>Official languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Yoruba</td>
      <td>0</td>
      <td>530570</td>
      <td>0</td>
      <td>612595</td>
      <td>0</td>
      <td>437460</td>
      <td>0</td>
      <td>749285</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 13 columns</p>
</div></div></div>
</div>
<p>If you want to ask for only some columns, for example
the columns between <code class="docutils literal notranslate"><span class="pre">&quot;most_at_home&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;lang_known&quot;</span></code>,
you might think about first applying <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and then <code class="docutils literal notranslate"><span class="pre">[&quot;most_at_home&quot;:&quot;lang_known&quot;]</span></code>;
but <code class="docutils literal notranslate"><span class="pre">groupby</span></code> returns a <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object, which does not
work with ranges inside <code class="docutils literal notranslate"><span class="pre">[]</span></code>.
The other option is to do things the other way around:
first use  <code class="docutils literal notranslate"><span class="pre">[&quot;most_at_home&quot;:&quot;lang_known&quot;]</span></code>, then use <code class="docutils literal notranslate"><span class="pre">groupby</span></code>.
This can work, but you have to be careful! For example,
in our case, we get an error.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">:</span><span class="s2">&quot;lang_known&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KeyError: &quot;region&quot;
</pre></div>
</div>
</div>
</div>
<p>This is because when we use <code class="docutils literal notranslate"><span class="pre">[]</span></code> we selected only the columns between
<code class="docutils literal notranslate"><span class="pre">&quot;most_at_home&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;lang_known&quot;</span></code>, which doesn’t include <code class="docutils literal notranslate"><span class="pre">&quot;region&quot;</span></code>!
Instead, we need to use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> first
and then call <code class="docutils literal notranslate"><span class="pre">[]</span></code> with a list of column names that includes <code class="docutils literal notranslate"><span class="pre">region</span></code>;
this approach always works.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)[[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_work&quot;</span><span class="p">,</span> <span class="s2">&quot;lang_known&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Abbotsford - Mission</td>
      <td>137445</td>
      <td>93495</td>
      <td>167835</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barrie</td>
      <td>182390</td>
      <td>115125</td>
      <td>193445</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belleville</td>
      <td>97840</td>
      <td>54150</td>
      <td>100855</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brantford</td>
      <td>124560</td>
      <td>73910</td>
      <td>130835</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
      <td>1343335</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Trois-Rivières</td>
      <td>149835</td>
      <td>78610</td>
      <td>149805</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Vancouver</td>
      <td>1622735</td>
      <td>1330555</td>
      <td>2289515</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Victoria</td>
      <td>331375</td>
      <td>211705</td>
      <td>354470</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Windsor</td>
      <td>270715</td>
      <td>166220</td>
      <td>318540</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Winnipeg</td>
      <td>612595</td>
      <td>437460</td>
      <td>749285</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 4 columns</p>
</div></div></div>
</div>
<p>To see how many observations there are in each group,
we can use <code class="docutils literal notranslate"><span class="pre">value_counts</span></code>.</p>
<div class="cell tag_output_scroll docutils container" id="index-54">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region
Abbotsford - Mission                214
St. Catharines - Niagara            214
Québec                              214
Regina                              214
Saguenay                            214
                                   ... 
Kitchener - Cambridge - Waterloo    214
Lethbridge                          214
London                              214
Moncton                             214
Winnipeg                            214
Name: count, Length: 35, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Which takes the <code class="docutils literal notranslate"><span class="pre">normalize</span></code> parameter to show the output as proportion
instead of a count.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region
Abbotsford - Mission                0.028571
St. Catharines - Niagara            0.028571
Québec                              0.028571
Regina                              0.028571
Saguenay                            0.028571
                                      ...   
Kitchener - Cambridge - Waterloo    0.028571
Lethbridge                          0.028571
London                              0.028571
Moncton                             0.028571
Winnipeg                            0.028571
Name: proportion, Length: 35, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="apply-functions-across-multiple-columns">
<h2><span class="section-number">3.10. </span>Apply functions across multiple columns<a class="headerlink" href="#apply-functions-across-multiple-columns" title="Permalink to this heading">#</a></h2>
<p>Computing summary statistics is not the only situation in which we need
to apply a function across columns in a data frame. There are two other
common wrangling tasks that require the application of a function across columns.
The first is when we want to apply a transformation, such as a conversion of measurement units, to multiple columns.
We illustrate such a data transformation in <a class="reference internal" href="#fig-mutate-across"><span class="std std-numref">Fig. 3.14</span></a>; note that it does not
change the shape of the data frame.</p>
<figure class="figure align-default" id="fig-mutate-across">
<img alt="_images/summarize.005.png" src="_images/summarize.005.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.14 </span><span class="caption-text">A transformation applied across many columns. The darker, top row of each table represents the column headers.</span><a class="headerlink" href="#fig-mutate-across" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>For example, imagine that we wanted to convert all the numeric columns
in the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame from <code class="docutils literal notranslate"><span class="pre">int64</span></code> type to <code class="docutils literal notranslate"><span class="pre">int32</span></code> type
using the <code class="docutils literal notranslate"><span class="pre">.astype</span></code> function.
When we revisit the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame,
we can see that this would be the columns from <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code> to <code class="docutils literal notranslate"><span class="pre">lang_known</span></code>.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 7 columns</p>
</div></div></div>
</div>
<p id="index-55">We can simply call the <code class="docutils literal notranslate"><span class="pre">.astype</span></code> function to apply it across the desired range of columns.</p>
<div class="cell docutils container" id="index-56">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang_nums</span> <span class="o">=</span> <span class="n">region_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;mother_tongue&quot;</span><span class="p">:</span><span class="s2">&quot;lang_known&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">region_lang_nums</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7490 entries, 0 to 7489
Data columns (total 4 columns):
 #   Column         Non-Null Count  Dtype
---  ------         --------------  -----
 0   mother_tongue  7490 non-null   int32
 1   most_at_home   7490 non-null   int32
 2   most_at_work   7490 non-null   int32
 3   lang_known     7490 non-null   int32
dtypes: int32(4)
memory usage: 117.2 KB
</pre></div>
</div>
</div>
</div>
<p>You can now see that the columns from <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code> to <code class="docutils literal notranslate"><span class="pre">lang_known</span></code> are type <code class="docutils literal notranslate"><span class="pre">int32</span></code>,
and that we have obtained a data frame with the same number of columns and rows
as the input data frame.</p>
<p>The second situation occurs when you want to apply a function across columns within each individual
row, i.e., <em>row-wise</em>. This operation, illustrated in <a class="reference internal" href="#fig-rowwise"><span class="std std-numref">Fig. 3.15</span></a>,
will produce a single column whose entries summarize each row in the original data frame;
this new column can be added back into the original data.</p>
<figure class="figure align-default" id="fig-rowwise">
<img alt="_images/summarize.004.png" src="_images/summarize.004.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.15 </span><span class="caption-text">A function applied row-wise across a data frame, producing a new column. The
darker, top row of each table represents the column headers.</span><a class="headerlink" href="#fig-rowwise" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>For example, suppose we want to know the maximum value between <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code>,
and <code class="docutils literal notranslate"><span class="pre">lang_known</span></code> for each language and region in the <code class="docutils literal notranslate"><span class="pre">region_lang_nums</span></code> data set.
In other words, we want to apply the <code class="docutils literal notranslate"><span class="pre">max</span></code> function <em>row-wise.</em>
In order to tell <code class="docutils literal notranslate"><span class="pre">max</span></code> that we want to work row-wise (as opposed to acting on each column
individually, which is the default behavior), we just specify the argument <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang_nums</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         5
1         5
2         0
3         0
4         5
       ... 
7485    910
7486      5
7487     50
7488    505
7489     90
Length: 7490, dtype: int32
</pre></div>
</div>
</div>
</div>
<p>We see that we obtain a series containing the maximum value between <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code>,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> and <code class="docutils literal notranslate"><span class="pre">lang_known</span></code> for each row in the data frame. It
is often the case that we want to include a column result
from a row-wise operation as a new column in the data frame, so that we can make
plots or continue our analysis. To make this happen,
we will use column assignment or the <code class="docutils literal notranslate"><span class="pre">assign</span></code> function to create a new column.
This is discussed in the next section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While <code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides many methods (like <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">astype</span></code>, etc.) that can be applied to a data frame,
sometimes you may want to apply your own function to multiple columns in a data frame. In this case
you can use the more general <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html"><code class="docutils literal notranslate"><span class="pre">apply</span></code></a> method.</p>
</div>
</section>
<section id="modifying-and-adding-columns">
<span id="pandas-assign"></span><h2><span class="section-number">3.11. </span>Modifying and adding columns<a class="headerlink" href="#modifying-and-adding-columns" title="Permalink to this heading">#</a></h2>
<p id="index-57">When we compute summary statistics or apply functions,
a new data frame or series is created. But what if we want to append that information
to an existing data frame? For example, say we wanted to compute the
maximum value in each row of the <code class="docutils literal notranslate"><span class="pre">region_lang_nums</span></code> data frame,
and to append that as an additional column of the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame.
In this case, we have two options: we can either  create a new column within the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data
frame itself, or create an entirely new data frame
with the <code class="docutils literal notranslate"><span class="pre">assign</span></code> method. The first option we have seen already in earlier chapters, and is
the more commonly used pattern in practice:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;maximum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">region_lang_nums</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">region_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
      <th>maximum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 8 columns</p>
</div></div></div>
</div>
<p>You can see above that the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame now has an additional column named <code class="docutils literal notranslate"><span class="pre">maximum</span></code>.
The <code class="docutils literal notranslate"><span class="pre">maximum</span></code> column contains
the maximum value between <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code>,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> and <code class="docutils literal notranslate"><span class="pre">lang_known</span></code> for each language
and region, just as we specified!</p>
<p>To instead create an entirely new data frame, we can use the <code class="docutils literal notranslate"><span class="pre">assign</span></code> method and specify one argument for each column we want to create.
In this case we want to create one new column named <code class="docutils literal notranslate"><span class="pre">maximum</span></code>, so the argument
to <code class="docutils literal notranslate"><span class="pre">assign</span></code> begins with <code class="docutils literal notranslate"><span class="pre">maximum=</span> </code>.
Then after the <code class="docutils literal notranslate"><span class="pre">=</span></code>, we specify what the contents of that new column
should be. In this case we use <code class="docutils literal notranslate"><span class="pre">max</span></code> just as we did previously to give us the maximum values.
Remember to specify <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> in the <code class="docutils literal notranslate"><span class="pre">max</span></code> method so that we compute the row-wise maximum value.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
  <span class="n">maximum</span><span class="o">=</span><span class="n">region_lang_nums</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
      <th>maximum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 8 columns</p>
</div></div></div>
</div>
<p>This data frame looks just like the previous one, except that it is a copy of <code class="docutils literal notranslate"><span class="pre">region_lang</span></code>, not <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> itself; making further
changes to this data frame will not impact the original <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame.</p>
<p>As another example, we might ask the question: “What proportion of
the population reported English as their primary language at home in the 2016 census?”
For example, in Toronto, <span class="pasted-text">3,836,770</span> people reported
speaking English as their primary language at home, and the
population of Toronto was reported to be
<span class="pasted-text">5,928,040</span> people. So the proportion of people reporting English
as their primary language in Toronto in the 2016 census was <span class="pasted-text">0.65</span>.
How could we figure this out starting from the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame?</p>
<p>First, we need to filter the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame
so that we only keep the rows where the language is English.
We will also restrict our attention to the five major cities
in the <code class="docutils literal notranslate"><span class="pre">five_cities</span></code> data frame: Toronto, Montréal, Vancouver, Calgary, and Edmonton.
We will filter to keep only those rows pertaining to the English language
and pertaining to the five aforementioned cities. To combine these two logical statements
we will use the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> symbol.
and with the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operation,
<code class="docutils literal notranslate"><span class="pre">&quot;English&quot;</span></code> as the <code class="docutils literal notranslate"><span class="pre">language</span></code> and filter the rows,
and name the new data frame <code class="docutils literal notranslate"><span class="pre">english_langs</span></code>.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_lang</span> <span class="o">=</span> <span class="n">region_lang</span><span class="p">[</span>
    <span class="p">(</span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;English&quot;</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">five_cities</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]))</span>
<span class="p">]</span>
<span class="n">english_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1898</th>
      <td>Montréal</td>
      <td>Official languages</td>
      <td>English</td>
      <td>444955</td>
      <td>620510</td>
      <td>412120</td>
      <td>2500590</td>
    </tr>
    <tr>
      <th>1903</th>
      <td>Toronto</td>
      <td>Official languages</td>
      <td>English</td>
      <td>3061820</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>5600480</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>Calgary</td>
      <td>Official languages</td>
      <td>English</td>
      <td>937055</td>
      <td>1065070</td>
      <td>844740</td>
      <td>1343335</td>
    </tr>
    <tr>
      <th>1919</th>
      <td>Edmonton</td>
      <td>Official languages</td>
      <td>English</td>
      <td>930405</td>
      <td>1050410</td>
      <td>792700</td>
      <td>1275265</td>
    </tr>
    <tr>
      <th>1923</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>1316635</td>
      <td>1622735</td>
      <td>1330555</td>
      <td>2289515</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Okay, now we have a data frame that pertains only to the English language
and the five cities mentioned earlier.
In order to compute the proportion of the population speaking English in each of these cities,
we need to add the population data from the <code class="docutils literal notranslate"><span class="pre">five_cities</span></code> data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">five_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>households</th>
      <th>area</th>
      <th>population</th>
      <th>dwellings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29</th>
      <td>Edmonton</td>
      <td>502143</td>
      <td>9857.77908</td>
      <td>1321426</td>
      <td>537634</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Calgary</td>
      <td>519693</td>
      <td>5241.70103</td>
      <td>1392609</td>
      <td>544870</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Vancouver</td>
      <td>960894</td>
      <td>3040.41532</td>
      <td>2463431</td>
      <td>1027613</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Montréal</td>
      <td>1727310</td>
      <td>4638.24059</td>
      <td>4098927</td>
      <td>1823281</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Toronto</td>
      <td>2135909</td>
      <td>6269.93132</td>
      <td>5928040</td>
      <td>2235145</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The data frame above shows that the populations of the five cities in 2016 were
5928040 (Toronto), 4098927 (Montréal),  2463431 (Vancouver), 1392609 (Calgary), and 1321426 (Edmonton).
Next, we will add this information to a new data frame column called <code class="docutils literal notranslate"><span class="pre">city_pops</span></code>.
Once again, we will illustrate how to do this using both the <code class="docutils literal notranslate"><span class="pre">assign</span></code> method and regular column assignment.
We specify the new column name (<code class="docutils literal notranslate"><span class="pre">city_pops</span></code>) as the argument, followed by the equals symbol <code class="docutils literal notranslate"><span class="pre">=</span></code>,
and finally the data in the column.
Note that the order of the rows in the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> data frame is Montréal, Toronto, Calgary, Edmonton, Vancouver.
So we will create a column called <code class="docutils literal notranslate"><span class="pre">city_pops</span></code> where we list the populations of those cities in that
order, and add it to our data frame.
And remember that by default, like other <code class="docutils literal notranslate"><span class="pre">pandas</span></code> functions, <code class="docutils literal notranslate"><span class="pre">assign</span></code> does not
modify the original data frame directly, so the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> data frame is unchanged!</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_lang</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
  <span class="n">city_pops</span><span class="o">=</span><span class="p">[</span><span class="mi">4098927</span><span class="p">,</span> <span class="mi">5928040</span><span class="p">,</span> <span class="mi">1392609</span><span class="p">,</span> <span class="mi">1321426</span><span class="p">,</span> <span class="mi">2463431</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
      <th>city_pops</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1898</th>
      <td>Montréal</td>
      <td>Official languages</td>
      <td>English</td>
      <td>444955</td>
      <td>620510</td>
      <td>412120</td>
      <td>2500590</td>
      <td>4098927</td>
    </tr>
    <tr>
      <th>1903</th>
      <td>Toronto</td>
      <td>Official languages</td>
      <td>English</td>
      <td>3061820</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>5600480</td>
      <td>5928040</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>Calgary</td>
      <td>Official languages</td>
      <td>English</td>
      <td>937055</td>
      <td>1065070</td>
      <td>844740</td>
      <td>1343335</td>
      <td>1392609</td>
    </tr>
    <tr>
      <th>1919</th>
      <td>Edmonton</td>
      <td>Official languages</td>
      <td>English</td>
      <td>930405</td>
      <td>1050410</td>
      <td>792700</td>
      <td>1275265</td>
      <td>1321426</td>
    </tr>
    <tr>
      <th>1923</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>1316635</td>
      <td>1622735</td>
      <td>1330555</td>
      <td>2289515</td>
      <td>2463431</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Instead of using the <code class="docutils literal notranslate"><span class="pre">assign</span></code> method we can directly modify the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> data frame using regular column assignment.
This would be a more natural choice in this particular case,
since the syntax is more convenient for simple column modifications and additions.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_lang</span><span class="p">[</span><span class="s2">&quot;city_pops&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4098927</span><span class="p">,</span> <span class="mi">5928040</span><span class="p">,</span> <span class="mi">1392609</span><span class="p">,</span> <span class="mi">1321426</span><span class="p">,</span> <span class="mi">2463431</span><span class="p">]</span>
<span class="n">english_lang</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_12/2654974267.py:1: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  english_lang[&quot;city_pops&quot;] = [4098927, 5928040, 1392609, 1321426, 2463431]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
      <th>city_pops</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1898</th>
      <td>Montréal</td>
      <td>Official languages</td>
      <td>English</td>
      <td>444955</td>
      <td>620510</td>
      <td>412120</td>
      <td>2500590</td>
      <td>4098927</td>
    </tr>
    <tr>
      <th>1903</th>
      <td>Toronto</td>
      <td>Official languages</td>
      <td>English</td>
      <td>3061820</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>5600480</td>
      <td>5928040</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>Calgary</td>
      <td>Official languages</td>
      <td>English</td>
      <td>937055</td>
      <td>1065070</td>
      <td>844740</td>
      <td>1343335</td>
      <td>1392609</td>
    </tr>
    <tr>
      <th>1919</th>
      <td>Edmonton</td>
      <td>Official languages</td>
      <td>English</td>
      <td>930405</td>
      <td>1050410</td>
      <td>792700</td>
      <td>1275265</td>
      <td>1321426</td>
    </tr>
    <tr>
      <th>1923</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>1316635</td>
      <td>1622735</td>
      <td>1330555</td>
      <td>2289515</td>
      <td>2463431</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p id="index-58">Wait a moment…what is that warning message? It seems to suggest that something went wrong, but
if we inspect the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> data frame above, it looks like the city populations were added
just fine! As it turns out, this is caused by the earlier filtering we did from <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> to
produce the original <code class="docutils literal notranslate"><span class="pre">english_lang</span></code>. The details are a little bit technical, but
<code class="docutils literal notranslate"><span class="pre">pandas</span></code> sometimes does not like it when you subset a data frame using <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> followed by
column assignment. For the purposes of your own data analysis, if you ever see a <code class="docutils literal notranslate"><span class="pre">SettingWithCopyWarning</span></code>, just make sure
to double check that the result of your column assignment looks the way you expect it to before proceeding.
For the rest of the book, we will silence that warning to help with readability.</p>
<div class="admonition note" id="index-59">
<p class="admonition-title">Note</p>
<p>Inserting the data column <code class="docutils literal notranslate"><span class="pre">[4098927,</span> <span class="pre">5928040,</span> <span class="pre">...]</span></code> manually as we did above is generally very error-prone and is not recommended.
We do it here to demonstrate another usage of <code class="docutils literal notranslate"><span class="pre">assign</span></code> and regular column assignment.
But in more advanced data wrangling,
one would solve this problem in a less error-prone way using
the <code class="docutils literal notranslate"><span class="pre">merge</span></code> function, which lets you combine two data frames. We will show you an
example using <code class="docutils literal notranslate"><span class="pre">merge</span></code> at the end of the chapter!</p>
</div>
<p>Now we have a new column with the population for each city. Finally, we can convert all the numerical
columns to proportions of people who speak English by taking the ratio of all the numerical columns
with <code class="docutils literal notranslate"><span class="pre">city_pops</span></code>. Let’s modify the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> column directly; in this case
we can just assign directly to the data frame.
This is similar to what we did in <a class="reference internal" href="#str-split"><span class="std std-numref">Section 3.4.3</span></a>,
when we first read in the <code class="docutils literal notranslate"><span class="pre">&quot;region_lang_top5_cities_messy.csv&quot;</span></code> data and we needed to convert a few
of the variables to numeric types. Here we assign to a range of columns simultaneously using <code class="docutils literal notranslate"><span class="pre">loc[]</span></code>.
Note that it is again possible to instead use the <code class="docutils literal notranslate"><span class="pre">assign</span></code> function to produce a new data
frame when modifying existing columns, although this is not commonly done.
Note also that we use the <code class="docutils literal notranslate"><span class="pre">div</span></code> method with the argument <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> to divide a range of columns in a data frame
by the values in a single column—the basic division symbol <code class="docutils literal notranslate"><span class="pre">/</span></code> won’t work in this case.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;mother_tongue&quot;</span><span class="p">:</span><span class="s2">&quot;lang_known&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">english_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">:,</span>
    <span class="s2">&quot;mother_tongue&quot;</span><span class="p">:</span><span class="s2">&quot;lang_known&quot;</span>
    <span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">english_lang</span><span class="p">[</span><span class="s2">&quot;city_pops&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">english_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
      <th>city_pops</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1898</th>
      <td>Montréal</td>
      <td>Official languages</td>
      <td>English</td>
      <td>0.108554</td>
      <td>0.151384</td>
      <td>0.100543</td>
      <td>0.610060</td>
      <td>4098927</td>
    </tr>
    <tr>
      <th>1903</th>
      <td>Toronto</td>
      <td>Official languages</td>
      <td>English</td>
      <td>0.516498</td>
      <td>0.647224</td>
      <td>0.542966</td>
      <td>0.944744</td>
      <td>5928040</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>Calgary</td>
      <td>Official languages</td>
      <td>English</td>
      <td>0.672877</td>
      <td>0.764802</td>
      <td>0.606588</td>
      <td>0.964617</td>
      <td>1392609</td>
    </tr>
    <tr>
      <th>1919</th>
      <td>Edmonton</td>
      <td>Official languages</td>
      <td>English</td>
      <td>0.704092</td>
      <td>0.794906</td>
      <td>0.599882</td>
      <td>0.965067</td>
      <td>1321426</td>
    </tr>
    <tr>
      <th>1923</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>0.534472</td>
      <td>0.658730</td>
      <td>0.540123</td>
      <td>0.929401</td>
      <td>2463431</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="using-merge-to-combine-data-frames">
<h2><span class="section-number">3.12. </span>Using <code class="docutils literal notranslate"><span class="pre">merge</span></code> to combine data frames<a class="headerlink" href="#using-merge-to-combine-data-frames" title="Permalink to this heading">#</a></h2>
<p id="index-60">Let’s return to the situation right before we added the city populations
of Toronto, Montréal, Vancouver, Calgary, and Edmonton to the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> data frame. Before adding the new column, we had filtered
<code class="docutils literal notranslate"><span class="pre">region_lang</span></code> to create the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> data frame containing only English speakers in the five cities
of interest.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1898</th>
      <td>Montréal</td>
      <td>Official languages</td>
      <td>English</td>
      <td>444955</td>
      <td>620510</td>
      <td>412120</td>
      <td>2500590</td>
    </tr>
    <tr>
      <th>1903</th>
      <td>Toronto</td>
      <td>Official languages</td>
      <td>English</td>
      <td>3061820</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>5600480</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>Calgary</td>
      <td>Official languages</td>
      <td>English</td>
      <td>937055</td>
      <td>1065070</td>
      <td>844740</td>
      <td>1343335</td>
    </tr>
    <tr>
      <th>1919</th>
      <td>Edmonton</td>
      <td>Official languages</td>
      <td>English</td>
      <td>930405</td>
      <td>1050410</td>
      <td>792700</td>
      <td>1275265</td>
    </tr>
    <tr>
      <th>1923</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>1316635</td>
      <td>1622735</td>
      <td>1330555</td>
      <td>2289515</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We then added the populations of these cities as a column
(Toronto: 5928040, Montréal: 4098927, Vancouver: 2463431,
Calgary: 1392609, and Edmonton: 1321426). We had to be careful to add those populations in the
right order; this is an error-prone process. An alternative approach, that we demonstrate here
is to (1) create a new data frame with the city names and populations, and
(2) use <code class="docutils literal notranslate"><span class="pre">merge</span></code> to combine the two data frames, recognizing that the “regions” are the same.</p>
<p>We create a new data frame by calling <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> with a dictionary
as its argument. The dictionary associates each column name in the data frame to be created
with a list of entries. Here we list city names in a column called <code class="docutils literal notranslate"><span class="pre">&quot;region&quot;</span></code>
and their populations in a column called <code class="docutils literal notranslate"><span class="pre">&quot;population&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">city_populations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
  <span class="s2">&quot;region&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">],</span>
  <span class="s2">&quot;population&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5928040</span><span class="p">,</span> <span class="mi">4098927</span><span class="p">,</span> <span class="mi">2463431</span><span class="p">,</span> <span class="mi">1392609</span><span class="p">,</span> <span class="mi">1321426</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">city_populations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Toronto</td>
      <td>5928040</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Montréal</td>
      <td>4098927</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vancouver</td>
      <td>2463431</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Calgary</td>
      <td>1392609</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Edmonton</td>
      <td>1321426</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This new data frame has the same <code class="docutils literal notranslate"><span class="pre">region</span></code> column as the <code class="docutils literal notranslate"><span class="pre">english_lang</span></code> data frame. The order of
the cities is different, but that is okay! We can use the <code class="docutils literal notranslate"><span class="pre">merge</span></code> function in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to say
we would like to combine the two data frames by matching the <code class="docutils literal notranslate"><span class="pre">region</span></code> between them. The argument
<code class="docutils literal notranslate"><span class="pre">on=&quot;region&quot;</span></code> tells pandas we would like to use the <code class="docutils literal notranslate"><span class="pre">region</span></code> column to match up the entries.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_lang</span> <span class="o">=</span> <span class="n">english_lang</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">city_populations</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>
<span class="n">english_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Montréal</td>
      <td>Official languages</td>
      <td>English</td>
      <td>444955</td>
      <td>620510</td>
      <td>412120</td>
      <td>2500590</td>
      <td>4098927</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toronto</td>
      <td>Official languages</td>
      <td>English</td>
      <td>3061820</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>5600480</td>
      <td>5928040</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Calgary</td>
      <td>Official languages</td>
      <td>English</td>
      <td>937055</td>
      <td>1065070</td>
      <td>844740</td>
      <td>1343335</td>
      <td>1392609</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Edmonton</td>
      <td>Official languages</td>
      <td>English</td>
      <td>930405</td>
      <td>1050410</td>
      <td>792700</td>
      <td>1275265</td>
      <td>1321426</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>1316635</td>
      <td>1622735</td>
      <td>1330555</td>
      <td>2289515</td>
      <td>2463431</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can see that the populations for each city are correct (e.g. Montréal: 4098927, Toronto: 5928040),
and we can proceed to with our analysis from here.</p>
</section>
<section id="summary">
<h2><span class="section-number">3.13. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>Cleaning and wrangling data can be a very time-consuming process. However,
it is a critical step in any data analysis. We have explored many different
functions for cleaning and wrangling data into a tidy format.
<a class="reference internal" href="#tab-summary-functions-table"><span class="std std-numref">Table 3.4</span></a> summarizes some of the key wrangling
functions we learned in this chapter. In the following chapters, you will
learn how you can take this tidy data and do so much more with it to answer your
burning data science questions!</p>
<table class="colwidths-auto table" id="tab-summary-functions-table">
<caption><span class="caption-number">Table 3.4 </span><span class="caption-text">Summary of wrangling functions</span><a class="headerlink" href="#tab-summary-functions-table" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">agg</span></code></p></td>
<td><p>calculates aggregated summaries of inputs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">assign</span></code></p></td>
<td><p>adds or modifies columns in a data frame</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">groupby</span></code></p></td>
<td><p>allows you to apply function(s) to groups of rows</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iloc</span></code></p></td>
<td><p>subsets columns/rows of a data frame using integer indices</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">loc</span></code></p></td>
<td><p>subsets columns/rows of a data frame using labels</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">melt</span></code></p></td>
<td><p>generally makes the data frame longer and narrower</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">merge</span></code></p></td>
<td><p>combine two data frames</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pivot</span></code></p></td>
<td><p>generally makes a data frame wider and decreases the number of rows</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.split</span></code></p></td>
<td><p>splits up a string column into multiple columns</p></td>
</tr>
</tbody>
</table>
</section>
<section id="exercises">
<h2><span class="section-number">3.14. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<p>Practice exercises for the material covered in this chapter
can be found in the accompanying
<a class="reference external" href="https://worksheets.python.datasciencebook.ca">worksheets repository</a>
in the “Cleaning and wrangling data” row.
You can launch an interactive version of the worksheet in your browser by clicking the “launch binder” button.
You can also preview a non-interactive version of the worksheet by clicking “view worksheet.”
If you instead decide to download the worksheet and run it on your own machine,
make sure to follow the instructions for computer setup
found in <a class="reference internal" href="setup.html#move-to-your-own-machine"><span class="std std-numref">Chapter 13</span></a>. This will ensure that the automated feedback
and guidance that the worksheets provide will function as intended.</p>
</section>
<section id="additional-resources">
<h2><span class="section-number">3.15. </span>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The <a class="reference external" href="https://pandas.pydata.org/docs/reference/index.html"><code class="docutils literal notranslate"><span class="pre">pandas</span></code> package documentation</a> is
another resource to learn more about the functions in this
chapter, the full set of arguments you can use, and other related functions.</p></li>
<li><p><a class="reference external" href="https://wesmckinney.com/book/"><em>Python for Data Analysis</em></a> <span id="id2">[<a class="reference internal" href="#id52" title="Wes McKinney. Python for data analysis: Data wrangling with Pandas, NumPy, and IPython. &quot; O'Reilly Media, Inc.&quot;, 2012.">McKinney, 2012</a>]</span> has a few chapters related to
data wrangling that go into more depth than this book. For example, the
<a class="reference external" href="https://wesmckinney.com/book/data-wrangling.html">data wrangling chapter</a> covers tidy data,
<code class="docutils literal notranslate"><span class="pre">melt</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot</span></code>, but also covers missing values
and additional wrangling functions (like <code class="docutils literal notranslate"><span class="pre">stack</span></code>). The <a class="reference external" href="https://wesmckinney.com/book/data-aggregation.html">data
aggregation chapter</a> covers
<code class="docutils literal notranslate"><span class="pre">groupby</span></code>, aggregating functions, <code class="docutils literal notranslate"><span class="pre">apply</span></code>, etc.</p></li>
<li><p>You will occasionally encounter a case where you need to iterate over items
in a data frame, but none of the above functions are flexible enough to do
what you want. In that case, you may consider using <a class="reference external" href="https://wesmckinney.com/book/python-basics.html#control_for">a for loop</a> <span id="id3">[<a class="reference internal" href="#id52" title="Wes McKinney. Python for data analysis: Data wrangling with Pandas, NumPy, and IPython. &quot; O'Reilly Media, Inc.&quot;, 2012.">McKinney, 2012</a>]</span>.</p></li>
</ul>
</section>
<section id="references">
<h2><span class="section-number">3.16. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<div class="docutils container" id="id4">
<dl class="citation">
<dt class="label" id="id52"><span class="brackets">McK12</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Wes McKinney. <em>Python for data analysis: Data wrangling with Pandas, NumPy, and IPython</em>. &quot; O'Reilly Media, Inc.&quot;, 2012.</p>
</dd>
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id1">Wic14</a></span></dt>
<dd><p>Hadley Wickham. Tidy data. <em>Journal of Statistical Software</em>, 59(10):1–23, 2014.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="reading.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Reading in data locally and from the web</p>
      </div>
    </a>
    <a class="right-next"
       href="viz.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Effective data visualization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">3.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-learning-objectives">3.2. Chapter learning objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frames-and-series">3.3. Data frames and series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-data-frame">3.3.1. What is a data frame?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-series">3.3.2. What is a series?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-this-have-to-do-with-data-frames">3.3.3. What does this have to do with data frames?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structures-in-python">3.3.4. Data structures in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidy-data">3.4. Tidy data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-up-going-from-wide-to-long-using-melt">3.4.1. Tidying up: going from wide to long using <code class="docutils literal notranslate"><span class="pre">melt</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-up-going-from-long-to-wide-using-pivot">3.4.2. Tidying up: going from long to wide using <code class="docutils literal notranslate"><span class="pre">pivot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-up-using-str-split-to-deal-with-multiple-separators">3.4.3. Tidying up: using <code class="docutils literal notranslate"><span class="pre">str.split</span></code> to deal with multiple separators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-to-extract-rows-or-columns">3.5. Using <code class="docutils literal notranslate"><span class="pre">[]</span></code> to extract rows or columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-columns-by-name">3.5.1. Extracting columns by name</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-that-have-a-certain-value-with">3.5.2. Extracting rows that have a certain value with <code class="docutils literal notranslate"><span class="pre">==</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-that-do-not-have-a-certain-value-with">3.5.3. Extracting rows that do not have a certain value with <code class="docutils literal notranslate"><span class="pre">!=</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-satisfying-multiple-conditions-using">3.5.4. Extracting rows satisfying multiple conditions using <code class="docutils literal notranslate"><span class="pre">&amp;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-satisfying-at-least-one-condition-using">3.5.5. Extracting rows satisfying at least one condition using <code class="docutils literal notranslate"><span class="pre">|</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-with-values-in-a-list-using-isin">3.5.6. Extracting rows with values in a list using <code class="docutils literal notranslate"><span class="pre">isin</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-above-or-below-a-threshold-using-and">3.5.7. Extracting rows above or below a threshold using <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-rows-using-query">3.5.8. Extracting rows using <code class="docutils literal notranslate"><span class="pre">query</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-loc-to-filter-rows-and-select-columns">3.6. Using <code class="docutils literal notranslate"><span class="pre">loc[]</span></code> to filter rows and select columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-iloc-to-extract-rows-and-columns-by-position">3.7. Using <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code> to extract rows and columns by position</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregating-data">3.8. Aggregating data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-summary-statistics-on-individual-columns">3.8.1. Calculating summary statistics on individual columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-summary-statistics-on-data-frames">3.8.2. Calculating summary statistics on data frames</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-operations-on-groups-of-rows-using-groupby">3.9. Performing operations on groups of rows using <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-functions-across-multiple-columns">3.10. Apply functions across multiple columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-and-adding-columns">3.11. Modifying and adding columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-merge-to-combine-data-frames">3.12. Using <code class="docutils literal notranslate"><span class="pre">merge</span></code> to combine data frames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3.13. Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">3.14. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">3.15. Additional resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">3.16. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tiffany Timbers, Trevor Campbell, Melissa Lee, Joel Ostblom, and Lindsey Heagy
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>