
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>4. Effective data visualization — Data Science: A First Introduction with Python</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet"/>
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet"/>
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet"/>
<link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" rel="stylesheet" type="text/css"/>
<link href="_static/togglebutton.css" rel="stylesheet" type="text/css"/>
<link href="_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css"/>
<link href="_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="_static/style.css" rel="stylesheet" type="text/css"/>
<link href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" rel="preload"/>
<link as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" rel="preload"/>
<script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="_static/doctools.js"></script>
<script src="_static/clipboard.min.js"></script>
<script src="_static/copybutton.js"></script>
<script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="_static/togglebutton.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="_static/design-tabs.js"></script>
<script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-7XBFF4RSN2"></script>
<script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-7XBFF4RSN2');
            </script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="_static/sphinx-thebe.js"></script>
<script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'viz';</script>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="classification1.html" rel="next" title="5. Classification I: training &amp; predicting"/>
<link href="wrangling.html" rel="prev" title="3. Cleaning and wrangling data"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<script src="website_diff.js"></script><link href="website_diff.css" rel="stylesheet" type="text/css"/></head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<a class="skip-link" href="#main-content">Skip to main content</a>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<a class="navbar-brand logo" href="index.html">
<p class="title logo__title">Data Science: A First Introduction with Python</p>
</a></div>
<div class="sidebar-primary-item"><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal link-to-diff" href="preface-text.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="foreword-text.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">About the authors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal link-to-diff" href="intro.html">1. Python and Pandas</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="reading.html">2. Reading in data locally and from the web</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="wrangling.html">3. Cleaning and wrangling data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Effective data visualization</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="classification1.html">5. Classification I: training &amp; predicting</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="classification2.html">6. Classification II: evaluation &amp; tuning</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="regression1.html">7. Regression I: K-nearest neighbors</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="regression2.html">8. Regression II: linear regression</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="clustering.html">9. Clustering</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="inference.html">10. Statistical inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter.html">11. Combining code and text with Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="version-control.html">12. Collaboration with version control</a></li>
<li class="toctree-l1"><a class="reference internal link-to-diff" href="setup.html">13. Setting up your computer</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</label></div>
</div>
<div class="header-article-items__end">
<div class="header-article-item">
<div class="article-header-buttons">
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-download-source-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="_sources/viz.md" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.md</span>
</a>
</li>
<li>
<button class="btn btn-sm btn-download-pdf-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" onclick="window.print()" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
<button class="btn btn-sm btn-fullscreen-button" data-bs-placement="bottom" data-bs-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__secondary" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</label>
</div></div>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Effective data visualization</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">4.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-learning-objectives">4.2. Chapter learning objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-the-visualization">4.3. Choosing the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#refining-the-visualization">4.4. Refining the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-visualizations-with-altair">4.5. Creating visualizations with <code class="docutils literal notranslate"><span class="pre">altair</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plots-and-line-plots-the-mauna-loa-co-text-2-data-set">4.5.1. Scatter plots and line plots: the Mauna Loa CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plots-the-old-faithful-eruption-time-data-set">4.5.2. Scatter plots: the Old Faithful eruption time data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axis-transformation-and-colored-scatter-plots-the-canadian-languages-data-set">4.5.3. Axis transformation and colored scatter plots: the Canadian languages data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-plots-the-island-landmass-data-set">4.5.4. Bar plots: the island landmass data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograms-the-michelson-speed-of-light-data-set">4.5.5. Histograms: the Michelson speed of light data set</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-layers-to-an-altair-chart">Adding layers to an <code class="docutils literal notranslate"><span class="pre">altair</span></code> chart</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-binwidth-for-histograms">Choosing a binwidth for histograms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explaining-the-visualization">4.6. Explaining the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-visualization">4.7. Saving the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">4.8. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">4.9. Additional resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.10. References</a></li>
</ul>
</nav>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article" role="main">
<section class="tex2jax_ignore mathjax_ignore" id="effective-data-visualization">
<span id="viz"></span><h1><span class="section-number">4. </span>Effective data visualization<a class="headerlink" href="#effective-data-visualization" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2><span class="section-number">4.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>This chapter will introduce concepts and tools relating to data visualization
beyond what we have seen and practiced so far.  We will focus on guiding
principles for effective data visualization and explaining visualizations
independent of any particular tool or programming language.  In the process, we
will cover some specifics of creating visualizations (scatter plots, bar
plots, line plots, and histograms) for data using Python.</p>
</section>
<section id="chapter-learning-objectives">
<h2><span class="section-number">4.2. </span>Chapter learning objectives<a class="headerlink" href="#chapter-learning-objectives" title="Permalink to this heading">#</a></h2>
<p>By the end of the chapter, readers will be able to do the following:</p>
<ul class="simple">
<li><p>Describe when to use the following kinds of visualizations to answer specific questions using a data set:</p>
<ul>
<li><p>scatter plots</p></li>
<li><p>line plots</p></li>
<li><p>bar plots</p></li>
<li><p>histogram plots</p></li>
</ul>
</li>
<li><p>Given a data set and a question, select from the above plot types and use Python to create a visualization that best answers the question.</p></li>
<li><p>Evaluate the effectiveness of a visualization and suggest improvements to better answer a given question.</p></li>
<li><p>Referring to the visualization, communicate the conclusions in non-technical terms.</p></li>
<li><p>Identify rules of thumb for creating effective visualizations.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">altair</span></code> library in Python to create and refine the above visualizations using:</p>
<ul>
<li><p>graphical marks: <code class="docutils literal notranslate"><span class="pre">mark_point</span></code>, <code class="docutils literal notranslate"><span class="pre">mark_line</span></code>, <code class="docutils literal notranslate"><span class="pre">mark_circle</span></code>, <code class="docutils literal notranslate"><span class="pre">mark_bar</span></code>, <code class="docutils literal notranslate"><span class="pre">mark_rule</span></code></p></li>
<li><p>encoding channels: <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">color</span></code>, <code class="docutils literal notranslate"><span class="pre">shape</span></code></p></li>
<li><p>labeling: <code class="docutils literal notranslate"><span class="pre">title</span></code></p></li>
<li><p>transformations: <code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
<li><p>subplots: <code class="docutils literal notranslate"><span class="pre">facet</span></code></p></li>
</ul>
</li>
<li><p>Define the two key aspects of <code class="docutils literal notranslate"><span class="pre">altair</span></code> charts:</p>
<ul>
<li><p>graphical marks</p></li>
<li><p>encoding channels</p></li>
</ul>
</li>
<li><p>Describe the difference in raster and vector output formats.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">chart.save()</span></code> to save visualizations in <code class="docutils literal notranslate"><span class="pre">.png</span></code> and <code class="docutils literal notranslate"><span class="pre">.svg</span></code> format.</p></li>
</ul>
</section>
<section id="choosing-the-visualization">
<h2><span class="section-number">4.3. </span>Choosing the visualization<a class="headerlink" href="#choosing-the-visualization" title="Permalink to this heading">#</a></h2>
<p><font size="5"><em>Ask a question, and answer it</em></font></p>
<p id="index-0">The purpose of a visualization is to answer a question
about a data set of interest. So naturally, the
first thing to do <strong>before</strong> creating a visualization is to formulate the
question about the data you are trying to answer.  A good visualization will
clearly answer your question without distraction; a <em>great</em> visualization will
suggest even what the question was itself without additional explanation.
Imagine your visualization as part of a poster presentation for a project; even
if you aren’t standing at the poster explaining things, an effective
visualization will convey your message to the audience.</p>
<p>Recall the different data analysis questions
from <a class="reference internal link-to-diff" href="intro.html#intro"><span class="std std-numref">Chapter 1</span></a>.
With the visualizations we will cover in this chapter,
we will be able to answer <em>only descriptive and exploratory</em> questions.
Be careful to not answer any <em>predictive, inferential, causal</em>
<em>or mechanistic</em> questions with the visualizations presented here,
as we have not learned the tools necessary to do that properly just yet.</p>
<p>As with most coding tasks, it is totally fine (and quite common) to make
mistakes and iterate a few times before you find the right visualization for
your data and question. There are many different kinds of plotting
graphics available to use (see Chapter 5 of <em>Fundamentals of Data Visualization</em> <span id="id1">[<a class="reference internal" href="#id38" title="Claus Wilke. Fundamentals of Data Visualization. O'Reilly Media, 2019. URL: https://clauswilke.com/dataviz/.">Wilke, 2019</a>]</span> for a directory).
The types of plots that we introduce in this book are shown in <a class="reference internal" href="#plot-sketches"><span class="std std-numref">Fig. 4.1</span></a>;
which one you should select depends on your data
and the question you want to answer.
In general, the guiding principles of when to use each type of plot
are as follows:</p>
<ul class="simple" id="index-1">
<li><p><strong>scatter plots</strong> visualize the relationship between two quantitative variables</p></li>
<li><p><strong>line plots</strong> visualize trends with respect to an independent, ordered quantity (e.g., time)</p></li>
<li><p><strong>bar plots</strong> visualize comparisons of amounts</p></li>
<li><p><strong>histograms</strong> visualize the distribution of one quantitative variable (i.e., all its possible values and how often they occur)</p></li>
</ul>
<figure class="align-default" id="plot-sketches">
<a class="reference internal image-reference" href="_images/plot-sketches-1.png"><img alt="_images/plot-sketches-1.png" src="_images/plot-sketches-1.png" style="height: 400px;"/></a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Examples of scatter, line and bar plots, as well as histograms.</span><a class="headerlink" href="#plot-sketches" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>All types of visualization have their (mis)uses, but three kinds are usually
hard to understand or are easily replaced with an oft-better alternative.  In
particular, you should avoid <strong>pie charts</strong>; it is generally better to use
bars, as it is easier to compare bar heights than pie slice sizes.  You should
also not use <strong>3-D visualizations</strong>, as they are typically hard to understand
when converted to a static 2-D image format. Finally, do not use tables to make
numerical comparisons; humans are much better at quickly processing visual
information than text and math. Bar plots are again typically a better
alternative.</p>
</section>
<section id="refining-the-visualization">
<h2><span class="section-number">4.4. </span>Refining the visualization<a class="headerlink" href="#refining-the-visualization" title="Permalink to this heading">#</a></h2>
<p><font size="5"><em>Convey the message, minimize noise</em></font></p>
<p>Just being able to make a visualization in Python with <code class="docutils literal notranslate"><span class="pre">altair</span></code> (or any other tool
for that matter) doesn’t mean that it effectively communicates your message to
others. Once you have selected a broad type of visualization to use, you will
have to refine it to suit your particular need.  Some rules of thumb for doing
this are listed below. They generally fall into two classes: you want to
<em>make your visualization convey your message</em>, and you want to <em>reduce visual noise</em>
as much as possible. Humans have limited cognitive ability to process
information; both of these types of refinement aim to reduce the mental load on
your audience when viewing your visualization, making it easier for them to
understand and remember your message quickly.</p>
<p><strong>Convey the message</strong></p>
<ul class="simple">
<li><p>Make sure the visualization answers the question you have asked most simply and plainly as possible.</p></li>
<li><p>Use legends and labels so that your visualization is understandable without reading the surrounding text.</p></li>
<li><p>Ensure the text, symbols, lines, etc., on your visualization are big enough to be easily read.</p></li>
<li><p>Ensure the data are clearly visible; don’t hide the shape/distribution of the data behind other objects (e.g.,  a bar).</p></li>
<li><p>Make sure to use color schemes that are understandable by those with
colorblindness (a surprisingly large fraction of the overall
population—from about 1% to 10%, depending on sex and ancestry <span id="id2">[<a class="reference internal" href="#id20" title="Sameer Deeb. The molecular basis of variation in human color vision. Clinical Genetics, 67:369–377, 2005.">Deeb, 2005</a>]</span>).
For example, <a class="reference external" href="https://altair-viz.github.io/user_guide/customization.html#customizing-colors">Color Schemes</a>
provides the ability to pick such color schemes, and you can check
your visualizations after you have created them by uploading to online tools
such as a <a class="reference external" href="https://www.color-blindness.com/coblis-color-blindness-simulator/">color blindness simulator</a>.</p></li>
<li><p>Redundancy can be helpful; sometimes conveying the same message in multiple ways reinforces it for the audience.</p></li>
</ul>
<p><strong>Minimize noise</strong></p>
<ul class="simple">
<li><p>Use colors sparingly. Too many different colors can be distracting, create false patterns, and detract from the message.</p></li>
<li><p>Be wary of overplotting. Overplotting is when marks that represent the data
overlap, and is problematic as it prevents you from seeing how many data
points are represented in areas of the visualization where this occurs. If your
plot has too many dots or lines and starts to look like a mess, you need to do
something different.</p></li>
<li><p>Only make the plot area (where the dots, lines, bars are) as big as needed. Simple plots can be made small.</p></li>
<li><p>Don’t adjust the axes to zoom in on small differences. If the difference is small, show that it’s small!</p></li>
</ul>
</section>
<section id="creating-visualizations-with-altair">
<h2><span class="section-number">4.5. </span>Creating visualizations with <code class="docutils literal notranslate"><span class="pre">altair</span></code><a class="headerlink" href="#creating-visualizations-with-altair" title="Permalink to this heading">#</a></h2>
<p><font size="5"><em>Build the visualization iteratively</em></font></p>
<p id="index-2">This section will cover examples of how to choose and refine a visualization given a data set and a question that you want to answer,
and then how to create the visualization in Python using <code class="docutils literal notranslate"><span class="pre">altair</span></code>.  To use the <code class="docutils literal notranslate"><span class="pre">altair</span></code> package, we need to first import it. We will also import <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to use for reading in the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this chapter, we will provide example visualizations using relatively small
data sets, so we are fine using the default settings in <code class="docutils literal notranslate"><span class="pre">altair</span></code>. However,
<code class="docutils literal notranslate"><span class="pre">altair</span></code> will raise an error if you try to plot with a data frame that has more
than 5,000 rows. The simplest way to plot larger data sets is to enable the
<code class="docutils literal notranslate"><span class="pre">vegafusion</span></code> data transformer right after you import the <code class="docutils literal notranslate"><span class="pre">altair</span></code> package:
<code class="docutils literal notranslate"><span class="pre">alt.data_transformers.enable("vegafusion")</span></code>. This will allow you to plot up to
100,000 graphical objects (e.g., a scatter plot with 100,000 points). To
visualize <em>even larger</em> data sets, see <a class="reference external" href="https://altair-viz.github.io/user_guide/large_datasets">the <code class="docutils literal notranslate"><span class="pre">altair</span></code> documentation</a>.</p>
</div>
<section id="scatter-plots-and-line-plots-the-mauna-loa-co-text-2-data-set">
<h3><span class="section-number">4.5.1. </span>Scatter plots and line plots: the Mauna Loa CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> data set<a class="headerlink" href="#scatter-plots-and-line-plots-the-mauna-loa-co-text-2-data-set" title="Permalink to this heading">#</a></h3>
<p id="index-3">The <a class="reference external" href="https://www.esrl.noaa.gov/gmd/ccgg/trends/data.html">Mauna Loa CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> data set</a>,
curated by Dr. Pieter Tans, NOAA/GML
and Dr. Ralph Keeling, Scripps Institution of Oceanography,
records the atmospheric concentration of carbon dioxide
(CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span>, in parts per million)
at the Mauna Loa research station in Hawaii
from 1959 onward <span id="id3">[<a class="reference internal" href="#id49" title="Pieter Tans and Ralph Keeling. Trends in atmospheric carbon dioxide. 2020. URL: https://gml.noaa.gov/ccgg/trends/data.html (visited on 2020-07-04).">Tans and Keeling, 2020</a>]</span>.
For this book, we are going to focus on the years 1980-2020.</p>
<p id="index-4"><strong>Question:</strong> Does the concentration of atmospheric CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> change over time,
and are there any interesting patterns to note?</p>
<p>To get started, we will read and inspect the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mauna loa carbon dioxide data</span>
<span class="n">co2_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">"data/mauna_loa_data.csv"</span><span class="p">,</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">"date_measured"</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">co2_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date_measured</th>
<th>ppm</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1980-02-01</td>
<td>338.34</td>
</tr>
<tr>
<th>1</th>
<td>1980-03-01</td>
<td>340.01</td>
</tr>
<tr>
<th>2</th>
<td>1980-04-01</td>
<td>340.93</td>
</tr>
<tr>
<th>3</th>
<td>1980-05-01</td>
<td>341.48</td>
</tr>
<tr>
<th>4</th>
<td>1980-06-01</td>
<td>341.33</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>479</th>
<td>2020-02-01</td>
<td>414.11</td>
</tr>
<tr>
<th>480</th>
<td>2020-03-01</td>
<td>414.51</td>
</tr>
<tr>
<th>481</th>
<td>2020-04-01</td>
<td>416.21</td>
</tr>
<tr>
<th>482</th>
<td>2020-05-01</td>
<td>417.07</td>
</tr>
<tr>
<th>483</th>
<td>2020-06-01</td>
<td>416.39</td>
</tr>
</tbody>
</table>
<p>484 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 484 entries, 0 to 483
Data columns (total 2 columns):
 #   Column         Non-Null Count  Dtype         
---  ------         --------------  -----         
 0   date_measured  484 non-null    datetime64[ns]
 1   ppm            484 non-null    float64       
dtypes: datetime64[ns](1), float64(1)
memory usage: 7.7 KB
</pre></div>
</div>
</div>
</div>
<p>We see that there are two columns in the <code class="docutils literal notranslate"><span class="pre">co2_df</span></code> data frame; <code class="docutils literal notranslate"><span class="pre">date_measured</span></code> and <code class="docutils literal notranslate"><span class="pre">ppm</span></code>.
The <code class="docutils literal notranslate"><span class="pre">date_measured</span></code> column holds the date the measurement was taken,
and is of type <code class="docutils literal notranslate"><span class="pre">datetime64</span></code>.
The <code class="docutils literal notranslate"><span class="pre">ppm</span></code> column holds the value of CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> in parts per million
that was measured on each date, and is type <code class="docutils literal notranslate"><span class="pre">float64</span></code>; this is the usual
type for decimal numbers.</p>
<div class="admonition note" id="index-5">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">read_csv</span></code> was able to parse the <code class="docutils literal notranslate"><span class="pre">date_measured</span></code> column into the
<code class="docutils literal notranslate"><span class="pre">datetime</span></code> vector type because it was entered
in the international standard date format,
called ISO 8601, which lists dates as <code class="docutils literal notranslate"><span class="pre">year-month-day</span></code> and we used <code class="docutils literal notranslate"><span class="pre">parse_dates=True</span></code>.
<code class="docutils literal notranslate"><span class="pre">datetime</span></code> vectors are <code class="docutils literal notranslate"><span class="pre">double</span></code> vectors with special properties that allow
them to handle dates correctly.
For example, <code class="docutils literal notranslate"><span class="pre">datetime</span></code> type vectors allow functions like <code class="docutils literal notranslate"><span class="pre">altair</span></code>
to treat them as numeric dates and not as character vectors,
even though they contain non-numeric characters
(e.g., in the <code class="docutils literal notranslate"><span class="pre">date_measured</span></code> column in the <code class="docutils literal notranslate"><span class="pre">co2_df</span></code> data frame).
This means Python will not accidentally plot the dates in the wrong order
(i.e., not alphanumerically as would happen if it was a character vector).
More about dates and times can be viewed <a class="reference external" href="https://wesmckinney.com/book/time-series.html">here</a>.</p>
</div>
<p>Since we are investigating a relationship between two variables
(CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> concentration and date),
a scatter plot is a good place to start.
Scatter plots show the data as individual points with <code class="docutils literal notranslate"><span class="pre">x</span></code> (horizontal axis)
and <code class="docutils literal notranslate"><span class="pre">y</span></code> (vertical axis) coordinates.
Here, we will use the measurement date as the <code class="docutils literal notranslate"><span class="pre">x</span></code> coordinate
and the CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> concentration as the <code class="docutils literal notranslate"><span class="pre">y</span></code> coordinate.
We create a chart with the <code class="docutils literal notranslate"><span class="pre">alt.Chart()</span></code> function.
There are a few basic aspects of a plot that we need to specify:</p>
<ul class="simple" id="index-6">
<li><p>The name of the <strong>data frame</strong> to visualize.</p>
<ul>
<li><p>Here, we specify the <code class="docutils literal notranslate"><span class="pre">co2_df</span></code> data frame as an argument to <code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code></p></li>
</ul>
</li>
<li><p>The <strong>graphical mark</strong>, which specifies how the mapped data should be displayed.</p>
<ul>
<li><p>To create a graphical mark, we use <code class="docutils literal notranslate"><span class="pre">Chart.mark_*</span></code> methods (see the
<a class="reference external" href="https://altair-viz.github.io/user_guide/marks.html">altair reference</a>
for a list of graphical mark).</p></li>
<li><p>Here, we use the <code class="docutils literal notranslate"><span class="pre">mark_point</span></code> function to visualize our data as a scatter plot.</p></li>
</ul>
</li>
<li><p>The <strong>encoding channels</strong>, which tells <code class="docutils literal notranslate"><span class="pre">altair</span></code> how the columns in the data frame map to visual properties in the chart.</p>
<ul>
<li><p>To create an encoding, we use the <code class="docutils literal notranslate"><span class="pre">encode</span></code> function.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">encode</span></code> method builds a key-value mapping between encoding channels (such as x, y) to fields in the data set, accessed by field name (column names)</p></li>
<li><p>Here, we set the <code class="docutils literal notranslate"><span class="pre">x</span></code> axis of the plot to the <code class="docutils literal notranslate"><span class="pre">date_measured</span></code> variable,
and on the <code class="docutils literal notranslate"><span class="pre">y</span></code> axis, we plot the <code class="docutils literal notranslate"><span class="pre">ppm</span></code> variable.</p></li>
<li><p>For the y-axis, we also provided the method
<code class="docutils literal notranslate"><span class="pre">scale(zero=False)</span></code>. By default, <code class="docutils literal notranslate"><span class="pre">altair</span></code> chooses the y-limits
based on the data and will keep <code class="docutils literal notranslate"><span class="pre">y=0</span></code> in view.
This is often a helpful default, but here it makes it
difficult to see any trends in our data since the smallest value is &gt;300
ppm. So by providing <code class="docutils literal notranslate"><span class="pre">scale(zero=False)</span></code>, we tell altair to
choose a reasonable lower bound based on our data, and that lower bound
doesn’t have to be zero.</p></li>
<li><p>To change the properties of the encoding channels,
we need to leverage the helper functions <code class="docutils literal notranslate"><span class="pre">alt.Y</span></code> and <code class="docutils literal notranslate"><span class="pre">alt.X</span></code>.
These helpers have the role of customizing things like order, titles, and scales.
Here, we use <code class="docutils literal notranslate"><span class="pre">alt.Y</span></code> to change the domain of the y-axis,
so that it starts from the lowest value in the <code class="docutils literal notranslate"><span class="pre">date_measured</span></code> column
rather than from zero.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_scatter</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">co2_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"date_measured"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"ppm"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="co2-scatter" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-6b0ec951adcd4b9495e64834f9fcc32f.vega-embed</ins><del>#altair-viz-d38eb9c04143452f9becd1d2b2200653.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-6b0ec951adcd4b9495e64834f9fcc32f.vega-embed</ins><del>#altair-viz-d38eb9c04143452f9becd1d2b2200653.vega-embed</del> details,
  <ins>#altair-viz-6b0ec951adcd4b9495e64834f9fcc32f.vega-embed</ins><del>#altair-viz-d38eb9c04143452f9becd1d2b2200653.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-6b0ec951adcd4b9495e64834f9fcc32f"><div id="altair-viz-d38eb9c04143452f9becd1d2b2200653"></div><img src="prerendered/co2-scatter.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.2 </span><span class="caption-text">Scatter plot of atmospheric concentration of CO<span class="math notranslate nohighlight">\(_{2}\)</span> over time.</span><a class="headerlink" href="#co2-scatter" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>The visualization in <a class="reference internal" href="#co2-scatter"><span class="std std-numref">Fig. 4.2</span></a>
shows a clear upward trend
in the atmospheric concentration of CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> over time.
This plot answers the first part of our question in the affirmative,
but that appears to be the only conclusion one can make
from the scatter visualization.</p>
<p>One important thing to note about this data is that one of the variables
we are exploring is time.
Time is a special kind of quantitative variable
because it forces additional structure on the data—the
data points have a natural order.
Specifically, each observation in the data set has a predecessor
and a successor, and the order of the observations matters; changing their order
alters their meaning.
In situations like this, we typically use a line plot to visualize
the data. Line plots connect the sequence of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> coordinates
of the observations with line segments, thereby emphasizing their order.</p>
<p id="index-7">We can create a line plot in <code class="docutils literal notranslate"><span class="pre">altair</span></code> using the <code class="docutils literal notranslate"><span class="pre">mark_line</span></code> function.
Let’s now try to visualize the <code class="docutils literal notranslate"><span class="pre">co2_df</span></code> as a line plot
with just the default arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_line</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">co2_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"date_measured"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"ppm"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="co2-line" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-6168976066a24b5b9ebdcc523955cd95.vega-embed</ins><del>#altair-viz-0a330046645946f89d67e6bc1b21410a.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-6168976066a24b5b9ebdcc523955cd95.vega-embed</ins><del>#altair-viz-0a330046645946f89d67e6bc1b21410a.vega-embed</del> details,
  <ins>#altair-viz-6168976066a24b5b9ebdcc523955cd95.vega-embed</ins><del>#altair-viz-0a330046645946f89d67e6bc1b21410a.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-6168976066a24b5b9ebdcc523955cd95"><div id="altair-viz-0a330046645946f89d67e6bc1b21410a"></div><img src="prerendered/co2-line.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.3 </span><span class="caption-text">Line plot of atmospheric concentration of CO<span class="math notranslate nohighlight">\(_{2}\)</span> over time.</span><a class="headerlink" href="#co2-line" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p id="index-8">Aha! <a class="reference internal" href="#co2-line"><span class="std std-numref">Fig. 4.3</span></a> shows us there <em>is</em> another interesting
phenomenon in the data: in addition to increasing over time, the concentration
seems to oscillate as well.  Given the visualization as it is now, it is still
hard to tell how fast the oscillation is, but nevertheless, the line seems to
be a better choice for answering the question than the scatter plot was. The
comparison between these two visualizations also illustrates a common issue with
scatter plots: often, the points are shown too close together or even on top of
one another, muddling information that would otherwise be clear
(<em>overplotting</em>).</p>
<p id="index-9">Now that we have settled on the rough details of the visualization, it is time
to refine things. This plot is fairly straightforward, and there is not much
visual noise to remove. But there are a few things we must do to improve
clarity, such as adding informative axis labels and making the font a more
readable size.  To add axis labels, we use the <code class="docutils literal notranslate"><span class="pre">title</span></code> method along with <code class="docutils literal notranslate"><span class="pre">alt.X</span></code> and <code class="docutils literal notranslate"><span class="pre">alt.Y</span></code> functions. To
change the font size, we use the <code class="docutils literal notranslate"><span class="pre">configure_axis</span></code> function with the
<code class="docutils literal notranslate"><span class="pre">titleFontSize</span></code> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_line_labels</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">co2_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"date_measured"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"ppm"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Atmospheric CO2 (ppm)"</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="co2-line-labels" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-5fa855f1249947a59ca7d4fb64bf43f7.vega-embed</ins><del>#altair-viz-b8ff5f0f231143868463661ff772123a.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-5fa855f1249947a59ca7d4fb64bf43f7.vega-embed</ins><del>#altair-viz-b8ff5f0f231143868463661ff772123a.vega-embed</del> details,
  <ins>#altair-viz-5fa855f1249947a59ca7d4fb64bf43f7.vega-embed</ins><del>#altair-viz-b8ff5f0f231143868463661ff772123a.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5fa855f1249947a59ca7d4fb64bf43f7"><div id="altair-viz-b8ff5f0f231143868463661ff772123a"></div><img src="prerendered/co2-line-labels.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.4 </span><span class="caption-text">Line plot of atmospheric concentration of CO<span class="math notranslate nohighlight">\(_{2}\)</span> over time with clearer axes and labels.</span><a class="headerlink" href="#co2-line-labels" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">configure_*</span></code> functions in <code class="docutils literal notranslate"><span class="pre">altair</span></code> support additional customization,
such as updating the size of the plot, changing
the font color, and many other options that can be viewed
<a class="reference external" href="https://altair-viz.github.io/user_guide/configuration.html">here</a>.</p>
</div>
<p id="index-10">Finally, let’s see if we can better understand the oscillation by changing the
visualization slightly. Note that it is totally fine to use a small number of
visualizations to answer different aspects of the question you are trying to
answer. We will accomplish this by using <em>scale</em>,
another important feature of <code class="docutils literal notranslate"><span class="pre">altair</span></code> that easily transforms the different
variables and set limits.
In particular, here, we will use the <code class="docutils literal notranslate"><span class="pre">alt.Scale</span></code> function to zoom in
on just a few years of data (say, 1990-1995). The
<code class="docutils literal notranslate"><span class="pre">domain</span></code> argument takes a list of length two
to specify the upper and lower bounds to limit the axis.
We also added the argument <code class="docutils literal notranslate"><span class="pre">clip=True</span></code> to <code class="docutils literal notranslate"><span class="pre">mark_line</span></code>. This tells <code class="docutils literal notranslate"><span class="pre">altair</span></code>
to “clip” (remove) the data outside of the specified domain that we set so that it doesn’t
extend past the plot area.
Since we are using both the <code class="docutils literal notranslate"><span class="pre">scale</span></code> and <code class="docutils literal notranslate"><span class="pre">title</span></code> method on the encodings
we stack them on separate lines to make the code easier to read.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_line_scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">co2_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"date_measured"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s2">"1990"</span><span class="p">,</span> <span class="s2">"1995"</span><span class="p">])</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Measurement Date"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"ppm"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Atmospheric CO2 (ppm)"</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="co2-line-scale" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-8f9dd0753aa34297919c6aa1e2ee25cf.vega-embed</ins><del>#altair-viz-0ac0f074eb85444e93fb50e31f443460.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-8f9dd0753aa34297919c6aa1e2ee25cf.vega-embed</ins><del>#altair-viz-0ac0f074eb85444e93fb50e31f443460.vega-embed</del> details,
  <ins>#altair-viz-8f9dd0753aa34297919c6aa1e2ee25cf.vega-embed</ins><del>#altair-viz-0ac0f074eb85444e93fb50e31f443460.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-8f9dd0753aa34297919c6aa1e2ee25cf"><div id="altair-viz-0ac0f074eb85444e93fb50e31f443460"></div><img src="prerendered/co2-line-scale.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Line plot of atmospheric concentration of CO<span class="math notranslate nohighlight">\(_{2}\)</span> from 1990 to 1995.</span><a class="headerlink" href="#co2-line-scale" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>Interesting! It seems that each year, the atmospheric CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> increases
until it reaches its peak somewhere around April, decreases until around late
September, and finally increases again until the end of the year. In Hawaii,
there are two seasons: summer from May through October, and winter from
November through April.  Therefore, the oscillating pattern in CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span>
matches up fairly closely with the two seasons.</p>
<p>A useful analogy to constructing a data visualization is painting a picture.
We start with a blank canvas,
and the first thing we do is prepare the surface
for our painting by adding primer.
In our data visualization this is akin to calling <code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code>
and specifying the data set we will be using.
Next, we sketch out the background of the painting.
In our data visualization,
this would be when we map data to the axes in the <code class="docutils literal notranslate"><span class="pre">encode</span></code> function.
Then we add our key visual subjects to the painting.
In our data visualization,
this would be the graphical marks (e.g., <code class="docutils literal notranslate"><span class="pre">mark_point</span></code>, <code class="docutils literal notranslate"><span class="pre">mark_line</span></code>, etc.).
And finally, we work on adding details and refinements to the painting.
In our data visualization this would be when we fine tune axis labels,
change the font, adjust the point size, and do other related things.</p>
</section>
<section id="scatter-plots-the-old-faithful-eruption-time-data-set">
<h3><span class="section-number">4.5.2. </span>Scatter plots: the Old Faithful eruption time data set<a class="headerlink" href="#scatter-plots-the-old-faithful-eruption-time-data-set" title="Permalink to this heading">#</a></h3>
<p id="index-11">The <code class="docutils literal notranslate"><span class="pre">faithful</span></code> data set contains measurements
of the waiting time between eruptions
and the subsequent eruption duration (in minutes) of the Old Faithful
geyser in Yellowstone National Park, Wyoming, United States.
First, we will read the data and then answer the following question:</p>
<p id="index-12"><strong>Question:</strong> Is there a relationship between the waiting time before an eruption
and the duration of the eruption?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faithful</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/faithful.csv"</span><span class="p">)</span>
<span class="n">faithful</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>eruptions</th>
<th>waiting</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3.600</td>
<td>79</td>
</tr>
<tr>
<th>1</th>
<td>1.800</td>
<td>54</td>
</tr>
<tr>
<th>2</th>
<td>3.333</td>
<td>74</td>
</tr>
<tr>
<th>3</th>
<td>2.283</td>
<td>62</td>
</tr>
<tr>
<th>4</th>
<td>4.533</td>
<td>85</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>267</th>
<td>4.117</td>
<td>81</td>
</tr>
<tr>
<th>268</th>
<td>2.150</td>
<td>46</td>
</tr>
<tr>
<th>269</th>
<td>4.417</td>
<td>90</td>
</tr>
<tr>
<th>270</th>
<td>1.817</td>
<td>46</td>
</tr>
<tr>
<th>271</th>
<td>4.467</td>
<td>74</td>
</tr>
</tbody>
</table>
<p>272 rows × 2 columns</p>
</div></div></div>
</div>
<p>Here again, we investigate the relationship between two quantitative variables
(waiting time and eruption time).
But if you look at the output of the data frame,
you’ll notice that unlike time in the Mauna Loa CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> data set,
neither of the variables here have a natural order to them.
So a scatter plot is likely to be the most appropriate
visualization. Let’s create a scatter plot using the <code class="docutils literal notranslate"><span class="pre">altair</span></code>
package with the <code class="docutils literal notranslate"><span class="pre">waiting</span></code> variable on the horizontal axis, the <code class="docutils literal notranslate"><span class="pre">eruptions</span></code>
variable on the vertical axis, and <code class="docutils literal notranslate"><span class="pre">mark_point</span></code> as the graphical mark.
The result is shown in <a class="reference internal" href="#faithful-scatter"><span class="std std-numref">Fig. 4.6</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faithful_scatter</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">faithful</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"waiting"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"eruptions"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="faithful-scatter" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-7f85685f472940e6a2e8c82c992a1329.vega-embed</ins><del>#altair-viz-7665d6b1792442d293978c938202c86a.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-7f85685f472940e6a2e8c82c992a1329.vega-embed</ins><del>#altair-viz-7665d6b1792442d293978c938202c86a.vega-embed</del> details,
  <ins>#altair-viz-7f85685f472940e6a2e8c82c992a1329.vega-embed</ins><del>#altair-viz-7665d6b1792442d293978c938202c86a.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-7f85685f472940e6a2e8c82c992a1329"><div id="altair-viz-7665d6b1792442d293978c938202c86a"></div><img src="prerendered/faithful-scatter.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.6 </span><span class="caption-text">Scatter plot of waiting time and eruption time.</span><a class="headerlink" href="#faithful-scatter" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>We can see in <a class="reference internal" href="#faithful-scatter"><span class="std std-numref">Fig. 4.6</span></a> that the data tend to fall
into two groups: one with short waiting and eruption times, and one with long
waiting and eruption times. Note that in this case, there is no overplotting:
the points are generally nicely visually separated, and the pattern they form
is clear.
In order to refine the visualization, we need only to add axis
labels and make the font more readable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faithful_scatter_labels</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">faithful</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"waiting"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Waiting Time (mins)"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"eruptions"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Eruption Duration (mins)"</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="faithful-scatter-labels" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-5c2a9a4c8ff84b10a75ce376a94fe978.vega-embed</ins><del>#altair-viz-3d1dae0eacc04c4784ddd2e0e67a133f.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-5c2a9a4c8ff84b10a75ce376a94fe978.vega-embed</ins><del>#altair-viz-3d1dae0eacc04c4784ddd2e0e67a133f.vega-embed</del> details,
  <ins>#altair-viz-5c2a9a4c8ff84b10a75ce376a94fe978.vega-embed</ins><del>#altair-viz-3d1dae0eacc04c4784ddd2e0e67a133f.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5c2a9a4c8ff84b10a75ce376a94fe978"><div id="altair-viz-3d1dae0eacc04c4784ddd2e0e67a133f"></div><img src="prerendered/faithful-scatter-labels.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.7 </span><span class="caption-text">Scatter plot of waiting time and eruption time with clearer axes and labels.</span><a class="headerlink" href="#faithful-scatter-labels" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>We can change the size of the point and color of the plot by specifying <code class="docutils literal notranslate"><span class="pre">mark_point(size=10,</span> <span class="pre">color="black")</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faithful_scatter_labels_black</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">faithful</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"waiting"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Waiting Time (mins)"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"eruptions"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Eruption Duration (mins)"</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="faithful-scatter-labels-black" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-a077e101bd2e4c64b4116453269b3d94.vega-embed</ins><del>#altair-viz-3b300034f8c049a38b2ddd3daa30438b.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-a077e101bd2e4c64b4116453269b3d94.vega-embed</ins><del>#altair-viz-3b300034f8c049a38b2ddd3daa30438b.vega-embed</del> details,
  <ins>#altair-viz-a077e101bd2e4c64b4116453269b3d94.vega-embed</ins><del>#altair-viz-3b300034f8c049a38b2ddd3daa30438b.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a077e101bd2e4c64b4116453269b3d94"><div id="altair-viz-3b300034f8c049a38b2ddd3daa30438b"></div><img src="prerendered/faithful-scatter-labels-black.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.8 </span><span class="caption-text">Scatter plot of waiting time and eruption time with black points.</span><a class="headerlink" href="#faithful-scatter-labels-black" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
</section>
<section id="axis-transformation-and-colored-scatter-plots-the-canadian-languages-data-set">
<h3><span class="section-number">4.5.3. </span>Axis transformation and colored scatter plots: the Canadian languages data set<a class="headerlink" href="#axis-transformation-and-colored-scatter-plots-the-canadian-languages-data-set" title="Permalink to this heading">#</a></h3>
<p id="index-13">Recall the <code class="docutils literal notranslate"><span class="pre">can_lang</span></code> data set <span id="id4">[<a class="reference internal" href="#id31" title="Tiffany Timbers. canlang: Canadian Census language data. 2020. R package version 0.0.9. URL: https://ttimbers.github.io/canlang/.">Timbers, 2020</a>]</span> from <a class="reference internal link-to-diff" href="intro.html#intro"><span class="std std-numref">Chapters 1</span></a>, <a class="reference internal link-to-diff" href="reading.html#reading"><span class="std std-numref">2</span></a>, and <a class="reference internal link-to-diff" href="wrangling.html#wrangling"><span class="std std-numref">3</span></a>.
It contains counts of languages from the 2016
Canadian census.</p>
<p id="index-14"><strong>Question:</strong> Is there a relationship between
the percentage of people who speak a language as their mother tongue and
the percentage for whom that is the primary language spoken at home?
And is there a pattern in the strength of this relationship in the
higher-level language categories (Official languages, Aboriginal languages, or
non-official and non-Aboriginal languages)?</p>
<p>To get started, we will read and inspect the data:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/can_lang.csv"</span><span class="p">)</span>
<span class="n">can_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>category</th>
<th>language</th>
<th>mother_tongue</th>
<th>most_at_home</th>
<th>most_at_work</th>
<th>lang_known</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Aboriginal languages</td>
<td>Aboriginal languages, n.o.s.</td>
<td>590</td>
<td>235</td>
<td>30</td>
<td>665</td>
</tr>
<tr>
<th>1</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Afrikaans</td>
<td>10260</td>
<td>4785</td>
<td>85</td>
<td>23415</td>
</tr>
<tr>
<th>2</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Afro-Asiatic languages, n.i.e.</td>
<td>1150</td>
<td>445</td>
<td>10</td>
<td>2775</td>
</tr>
<tr>
<th>3</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Akan (Twi)</td>
<td>13460</td>
<td>5985</td>
<td>25</td>
<td>22150</td>
</tr>
<tr>
<th>4</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Albanian</td>
<td>26895</td>
<td>13135</td>
<td>345</td>
<td>31930</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>209</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Wolof</td>
<td>3990</td>
<td>1385</td>
<td>10</td>
<td>8240</td>
</tr>
<tr>
<th>210</th>
<td>Aboriginal languages</td>
<td>Woods Cree</td>
<td>1840</td>
<td>800</td>
<td>75</td>
<td>2665</td>
</tr>
<tr>
<th>211</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Wu (Shanghainese)</td>
<td>12915</td>
<td>7650</td>
<td>105</td>
<td>16530</td>
</tr>
<tr>
<th>212</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Yiddish</td>
<td>13555</td>
<td>7085</td>
<td>895</td>
<td>20985</td>
</tr>
<tr>
<th>213</th>
<td>Non-Official &amp; Non-Aboriginal languages</td>
<td>Yoruba</td>
<td>9080</td>
<td>2615</td>
<td>15</td>
<td>22415</td>
</tr>
</tbody>
</table>
<p>214 rows × 6 columns</p>
</div></div></div>
</div>
<p id="index-15">We will begin with a scatter plot of the <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> columns from our data frame.
As we have seen in the scatter plots in the previous section,
the default behavior of <code class="docutils literal notranslate"><span class="pre">mark_point</span></code> is to draw the outline of each point.
If we would like to fill them in,
we can pass the argument <code class="docutils literal notranslate"><span class="pre">filled=True</span></code> to <code class="docutils literal notranslate"><span class="pre">mark_point</span></code>
or use the shortcut <code class="docutils literal notranslate"><span class="pre">mark_circle</span></code>.
Whether to fill points or not is mostly a matter of personal preferences,
although hollow points can make it easier to see individual points
when there are many overlapping points in a chart.
The resulting plot is shown in <a class="reference internal" href="#can-lang-plot"><span class="std std-numref">Fig. 4.9</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"most_at_home"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"mother_tongue"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-a17729c571b8421aab7efeaa967c8229.vega-embed</ins><del>#altair-viz-bb7cd36dc9834d3bb6352abc804d931c.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-a17729c571b8421aab7efeaa967c8229.vega-embed</ins><del>#altair-viz-bb7cd36dc9834d3bb6352abc804d931c.vega-embed</del> details,
  <ins>#altair-viz-a17729c571b8421aab7efeaa967c8229.vega-embed</ins><del>#altair-viz-bb7cd36dc9834d3bb6352abc804d931c.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a17729c571b8421aab7efeaa967c8229"><div id="altair-viz-bb7cd36dc9834d3bb6352abc804d931c"></div><img src="prerendered/can-lang-plot.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.9 </span><span class="caption-text">Scatter plot of number of Canadians reporting a language as their mother tongue vs the primary language at home</span><a class="headerlink" href="#can-lang-plot" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>To make an initial improvement in the interpretability
of <a class="reference internal" href="#can-lang-plot"><span class="std std-numref">Fig. 4.9</span></a>, we should
replace the default axis
names with more informative labels.
To make the axes labels on the plots more readable,
we can print long labels over multiple lines.
To achieve this, we specify the title as a list of strings
where each string in the list will correspond to a new line of text.
We can also increase the font size to further
improve readability.</p>
<div class="cell docutils container" id="index-16">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_labels</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(number of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(number of Canadian residents)"</span><span class="p">])</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-labels" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-0c4292a64dd44f19ac22c08db34ddda0.vega-embed</ins><del>#altair-viz-8de83c92e78a4c8bb240eca0eceb1daf.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-0c4292a64dd44f19ac22c08db34ddda0.vega-embed</ins><del>#altair-viz-8de83c92e78a4c8bb240eca0eceb1daf.vega-embed</del> details,
  <ins>#altair-viz-0c4292a64dd44f19ac22c08db34ddda0.vega-embed</ins><del>#altair-viz-8de83c92e78a4c8bb240eca0eceb1daf.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0c4292a64dd44f19ac22c08db34ddda0"><div id="altair-viz-8de83c92e78a4c8bb240eca0eceb1daf"></div><img src="prerendered/can-lang-plot-labels.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.10 </span><span class="caption-text">Scatter plot of number of Canadians reporting a language as their mother tongue vs the primary language at home with x and y labels.</span><a class="headerlink" href="#can-lang-plot-labels" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>Okay! The axes and labels in <a class="reference internal" href="#can-lang-plot-labels"><span class="std std-numref">Fig. 4.10</span></a> are
much more readable and interpretable now. However, the scatter points themselves could use
some work; most of the 214 data points are bunched
up in the lower left-hand side of the visualization. The data is clumped because
many more people in Canada speak English or French (the two points in
the upper right corner) than other languages.
In particular, the most common mother tongue language
has <span class="pasted-text">19,460,850</span> speakers,
while the least common has only <span class="pasted-text">10</span>.
That’s a six-decimal-place difference
in the magnitude of these two numbers!
We can confirm that the two points in the upper right-hand corner correspond
to Canada’s two official languages by filtering the data:</p>
<div class="cell tag_output_scroll docutils container" id="index-17">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">can_lang</span><span class="p">[</span><span class="s2">"language"</span><span class="p">]</span><span class="o">==</span><span class="s2">"English"</span><span class="p">)</span>
    <span class="o">|</span> <span class="p">(</span><span class="n">can_lang</span><span class="p">[</span><span class="s2">"language"</span><span class="p">]</span><span class="o">==</span><span class="s2">"French"</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>category</th>
<th>language</th>
<th>mother_tongue</th>
<th>most_at_home</th>
<th>most_at_work</th>
<th>lang_known</th>
</tr>
</thead>
<tbody>
<tr>
<th>54</th>
<td>Official languages</td>
<td>English</td>
<td>19460850</td>
<td>22162865</td>
<td>15265335</td>
<td>29748265</td>
</tr>
<tr>
<th>59</th>
<td>Official languages</td>
<td>French</td>
<td>7166700</td>
<td>6943800</td>
<td>3825215</td>
<td>10242945</td>
</tr>
</tbody>
</table>
</div></div></div>
</div>
<p id="index-18">Recall that our question about this data pertains to <em>all</em> languages;
so to properly answer our question,
we will need to adjust the scale of the axes so that we can clearly
see all of the scatter points.
In particular, we will improve the plot by adjusting the horizontal
and vertical axes so that they are on a <strong>logarithmic</strong> (or <strong>log</strong>) scale.
Log scaling is useful when your data take both <em>very large</em> and <em>very small</em> values,
because it helps space out small values and squishes larger values together.
For example, <span class="math notranslate nohighlight">\(\log_{10}(1) = 0\)</span>, <span class="math notranslate nohighlight">\(\log_{10}(10) = 1\)</span>, <span class="math notranslate nohighlight">\(\log_{10}(100) = 2\)</span>, and <span class="math notranslate nohighlight">\(\log_{10}(1000) = 3\)</span>;
on the logarithmic scale,
the values 1, 10, 100, and 1000 are all the same distance apart!
So we see that applying this function is moving big values closer together
and moving small values farther apart.
Note that if your data can take the value 0, logarithmic scaling may not
be appropriate (since <code class="docutils literal notranslate"><span class="pre">log10(0)</span></code> is <code class="docutils literal notranslate"><span class="pre">-inf</span></code> in Python). There are other ways to transform
the data in such a case, but these are beyond the scope of the book.</p>
<p>We can accomplish logarithmic scaling in the <code class="docutils literal notranslate"><span class="pre">altair</span></code> visualization
using the argument <code class="docutils literal notranslate"><span class="pre">type="log"</span></code> in the scale method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_log</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(number of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(number of Canadian residents)"</span><span class="p">])</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-log" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-5097575b39854009990f1f52cf0fb448.vega-embed</ins><del>#altair-viz-6e89bd3a5eaa4f7bba57f7c2d8b73a4e.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-5097575b39854009990f1f52cf0fb448.vega-embed</ins><del>#altair-viz-6e89bd3a5eaa4f7bba57f7c2d8b73a4e.vega-embed</del> details,
  <ins>#altair-viz-5097575b39854009990f1f52cf0fb448.vega-embed</ins><del>#altair-viz-6e89bd3a5eaa4f7bba57f7c2d8b73a4e.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5097575b39854009990f1f52cf0fb448"><div id="altair-viz-6e89bd3a5eaa4f7bba57f7c2d8b73a4e"></div><img src="prerendered/can-lang-plot-log.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.11 </span><span class="caption-text">Scatter plot of number of Canadians reporting a language as their mother tongue vs the primary language at home with log-adjusted x and y axes.</span><a class="headerlink" href="#can-lang-plot-log" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>You will notice two things in the chart above,
changing the axis to log creates many axis ticks and gridlines,
which makes the appearance of the chart rather noisy
and it is hard to focus on the data.
You can also see that the second last tick label is missing on the x-axis;
Altair dropped it because there wasn’t space to fit in all the large numbers next to each other.
It is also hard to see if the label for 100,000,000 is for the last or second last tick.
To fix these issue,
we can limit the number of ticks and gridlines to only include the seven major ones,
and change the number formatting to include a suffix which makes the labels shorter.</p>
<div class="cell docutils container" id="index-19">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_log_revised</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(number of Canadian residents)"</span><span class="p">])</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"s"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(number of Canadian residents)"</span><span class="p">])</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"s"</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-log-revised" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-b6ac554a6cba421e8b918412bbe272f3.vega-embed</ins><del>#altair-viz-a87d38d7f004419ca98cee2582876d6a.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-b6ac554a6cba421e8b918412bbe272f3.vega-embed</ins><del>#altair-viz-a87d38d7f004419ca98cee2582876d6a.vega-embed</del> details,
  <ins>#altair-viz-b6ac554a6cba421e8b918412bbe272f3.vega-embed</ins><del>#altair-viz-a87d38d7f004419ca98cee2582876d6a.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b6ac554a6cba421e8b918412bbe272f3"><div id="altair-viz-a87d38d7f004419ca98cee2582876d6a"></div><img src="prerendered/can-lang-plot-log-revised.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.12 </span><span class="caption-text">Scatter plot of number of Canadians reporting a language as their mother tongue vs the primary language at home with log-adjusted x and y axes. Only the major gridlines are shown. The suffix “k” indicates 1,000 (“kilo”), while the suffix “M” indicates 1,000,000 (“million”).</span><a class="headerlink" href="#can-lang-plot-log-revised" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>Similar to some of the examples in <a class="reference internal link-to-diff" href="wrangling.html#wrangling"><span class="std std-numref">Chapter 3</span></a>,
we can convert the counts to percentages to give them context
and make them easier to understand.
We can do this by dividing the number of people reporting a given language
as their mother tongue or primary language at home
by the number of people who live in Canada and multiplying by 100%.
For example,
the percentage of people who reported that their mother tongue was English
in the 2016 Canadian census
was <span class="pasted-text">19,460,850</span> / <span class="pasted-text">35,151,728</span> <span class="math notranslate nohighlight">\(\times\)</span>
100% = <span class="pasted-text">55.36</span>%</p>
<p>Below we assign the percentages of people reporting a given
language as their mother tongue and primary language at home
to two new columns in the <code class="docutils literal notranslate"><span class="pre">can_lang</span></code> data frame. Since the new columns are appended to the
end of the data table, we selected the new columns after the transformation so
you can clearly see the mutated output from the table.
Note that we formatted the number for the Canadian population
using <code class="docutils literal notranslate"><span class="pre">_</span></code> so that it is easier to read;
this does not affect how Python interprets the number
and is just added for readability.</p>
<div class="cell docutils container" id="index-20">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">canadian_population</span> <span class="o">=</span> <span class="mi">35_151_728</span>
<span class="n">can_lang</span><span class="p">[</span><span class="s2">"mother_tongue_percent"</span><span class="p">]</span> <span class="o">=</span> <span class="n">can_lang</span><span class="p">[</span><span class="s2">"mother_tongue"</span><span class="p">]</span><span class="o">/</span><span class="n">canadian_population</span><span class="o">*</span><span class="mi">100</span>
<span class="n">can_lang</span><span class="p">[</span><span class="s2">"most_at_home_percent"</span><span class="p">]</span> <span class="o">=</span> <span class="n">can_lang</span><span class="p">[</span><span class="s2">"most_at_home"</span><span class="p">]</span><span class="o">/</span><span class="n">canadian_population</span><span class="o">*</span><span class="mi">100</span>
<span class="n">can_lang</span><span class="p">[[</span><span class="s2">"mother_tongue_percent"</span><span class="p">,</span> <span class="s2">"most_at_home_percent"</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>mother_tongue_percent</th>
<th>most_at_home_percent</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0.001678</td>
<td>0.000669</td>
</tr>
<tr>
<th>1</th>
<td>0.029188</td>
<td>0.013612</td>
</tr>
<tr>
<th>2</th>
<td>0.003272</td>
<td>0.001266</td>
</tr>
<tr>
<th>3</th>
<td>0.038291</td>
<td>0.017026</td>
</tr>
<tr>
<th>4</th>
<td>0.076511</td>
<td>0.037367</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>209</th>
<td>0.011351</td>
<td>0.003940</td>
</tr>
<tr>
<th>210</th>
<td>0.005234</td>
<td>0.002276</td>
</tr>
<tr>
<th>211</th>
<td>0.036741</td>
<td>0.021763</td>
</tr>
<tr>
<th>212</th>
<td>0.038561</td>
<td>0.020155</td>
</tr>
<tr>
<th>213</th>
<td>0.025831</td>
<td>0.007439</td>
</tr>
</tbody>
</table>
<p>211 rows × 2 columns</p>
</div></div></div>
</div>
<p>Next, we will edit the visualization to use the percentages we just computed
(and change our axis labels to reflect this change in
units). <a class="reference internal" href="#can-lang-plot-percent"><span class="std std-numref">Fig. 4.13</span></a> displays
the final result.
Here all the tick labels fit by default so we are not changing the labels to include suffixes.
Note that suffixes can also be harder to understand,
so it is often advisable to avoid them (particularly for small quantities)
unless you are communicating to a technical audience.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_percent</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-percent" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-b420419d15774eed987a2dc7409999df.vega-embed</ins><del>#altair-viz-0a056d0ff719419fa4e59582c20d3ecb.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-b420419d15774eed987a2dc7409999df.vega-embed</ins><del>#altair-viz-0a056d0ff719419fa4e59582c20d3ecb.vega-embed</del> details,
  <ins>#altair-viz-b420419d15774eed987a2dc7409999df.vega-embed</ins><del>#altair-viz-0a056d0ff719419fa4e59582c20d3ecb.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b420419d15774eed987a2dc7409999df"><div id="altair-viz-0a056d0ff719419fa4e59582c20d3ecb"></div><img src="prerendered/can-lang-plot-percent.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.13 </span><span class="caption-text">Scatter plot of percentage of Canadians reporting a language as their mother tongue vs the primary language at home.</span><a class="headerlink" href="#can-lang-plot-percent" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p><a class="reference internal" href="#can-lang-plot-percent"><span class="std std-numref">Fig. 4.13</span></a> is the appropriate
visualization to use to answer the first question in this section, i.e.,
whether there is a relationship between the percentage of people who speak
a language as their mother tongue and the percentage for whom that
is the primary language spoken at home.
To fully answer the question, we need to use
<a class="reference internal" href="#can-lang-plot-percent"><span class="std std-numref">Fig. 4.13</span></a>
to assess a few key characteristics of the data:</p>
<ul class="simple" id="index-21">
<li><p><strong>Direction:</strong> if the y variable tends to increase when the x variable increases, then y has a <strong>positive</strong> relationship with x. If
y tends to decrease when x increases, then y has a <strong>negative</strong> relationship with x. If y does not meaningfully increase or decrease
as x increases, then y has <strong>little or no</strong> relationship with x.</p></li>
</ul>
<ul class="simple" id="index-22">
<li><p><strong>Strength:</strong> if the y variable <em>reliably</em> increases, decreases, or stays flat as x increases,
then the relationship is <strong>strong</strong>. Otherwise, the relationship is <strong>weak</strong>. Intuitively,
the relationship is strong when the scatter points are close together and look more like a “line” or “curve” than a “cloud.”</p></li>
</ul>
<ul class="simple" id="index-23">
<li><p><strong>Shape:</strong> if you can draw a straight line roughly through the data points, the relationship is <strong>linear</strong>. Otherwise, it is <strong>nonlinear</strong>.</p></li>
</ul>
<p>In <a class="reference internal" href="#can-lang-plot-percent"><span class="std std-numref">Fig. 4.13</span></a>, we see that
as the percentage of people who have a language as their mother tongue increases,
so does the percentage of people who speak that language at home.
Therefore, there is a <strong>positive</strong> relationship between these two variables.
Furthermore, because the points in <a class="reference internal" href="#can-lang-plot-percent"><span class="std std-numref">Fig. 4.13</span></a>
are fairly close together, and the points look more like a “line” than a “cloud”,
we can say that this is a <strong>strong</strong> relationship.
And finally, because drawing a straight line through these points in
<a class="reference internal" href="#can-lang-plot-percent"><span class="std std-numref">Fig. 4.13</span></a>
would fit the pattern we observe quite well, we say that the relationship is <strong>linear</strong>.</p>
<p>Onto the second part of our exploratory data analysis question!
Recall that we are interested in knowing whether the strength
of the relationship we uncovered
in <a class="reference internal" href="#can-lang-plot-percent"><span class="std std-numref">Fig. 4.13</span></a> depends
on the higher-level language category (Official languages, Aboriginal languages,
and non-official, non-Aboriginal languages).
One common way to explore this
is to color the data points on the scatter plot we have already created by
group. For example, given that we have the higher-level language category for
each language recorded in the 2016 Canadian census, we can color the points in
our previous
scatter plot to represent each language’s higher-level language category.</p>
<p>Here we want to distinguish the values according to the <code class="docutils literal notranslate"><span class="pre">category</span></code> group with
which they belong.  We can add the argument <code class="docutils literal notranslate"><span class="pre">color</span></code> to the <code class="docutils literal notranslate"><span class="pre">encode</span></code> method, specifying
that the <code class="docutils literal notranslate"><span class="pre">category</span></code> column should color the points. Adding this argument will
color the points according to their group and add a legend at the side of the
plot.
Since the labels of the language category as descriptive of their own,
we can remove the title of the legend to reduce visual clutter without reducing the effectiveness of the chart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_category</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"category"</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-category" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-c82a1b6a268048f0aba61c73036d2f8a.vega-embed</ins><del>#altair-viz-e6f151018b4642bab3e6d34f2e22aa26.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-c82a1b6a268048f0aba61c73036d2f8a.vega-embed</ins><del>#altair-viz-e6f151018b4642bab3e6d34f2e22aa26.vega-embed</del> details,
  <ins>#altair-viz-c82a1b6a268048f0aba61c73036d2f8a.vega-embed</ins><del>#altair-viz-e6f151018b4642bab3e6d34f2e22aa26.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-c82a1b6a268048f0aba61c73036d2f8a"><div id="altair-viz-e6f151018b4642bab3e6d34f2e22aa26"></div><img src="prerendered/can-lang-plot-category.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.14 </span><span class="caption-text">Scatter plot of percentage of Canadians reporting a language as their mother tongue vs the primary language at home colored by language category.</span><a class="headerlink" href="#can-lang-plot-category" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>Another thing we can adjust is the location of the legend.
This is a matter of preference and not critical for the visualization.
We move the legend title using the <code class="docutils literal notranslate"><span class="pre">alt.Legend</span></code> method
and specify that we want it on the top of the chart.
This automatically changes the legend items to be laid out horizontally instead of vertically,
but we could also keep the vertical layout by specifying <code class="docutils literal notranslate"><span class="pre">direction="vertical"</span></code> inside <code class="docutils literal notranslate"><span class="pre">alt.Legend</span></code>.</p>
<div class="cell docutils container" id="index-24">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_legend</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"category"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-legend" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-09a1e9e817a94e209747533c674b0265.vega-embed</ins><del>#altair-viz-213f2aca11dc4e26bf2ba6a3c7662040.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-09a1e9e817a94e209747533c674b0265.vega-embed</ins><del>#altair-viz-213f2aca11dc4e26bf2ba6a3c7662040.vega-embed</del> details,
  <ins>#altair-viz-09a1e9e817a94e209747533c674b0265.vega-embed</ins><del>#altair-viz-213f2aca11dc4e26bf2ba6a3c7662040.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-09a1e9e817a94e209747533c674b0265"><div id="altair-viz-213f2aca11dc4e26bf2ba6a3c7662040"></div><img src="prerendered/can-lang-plot-legend.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.15 </span><span class="caption-text">Scatter plot of percentage of Canadians reporting a language as their mother tongue vs the primary language at home colored by language category with the legend edited.</span><a class="headerlink" href="#can-lang-plot-legend" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p id="index-25">In <a class="reference internal" href="#can-lang-plot-legend"><span class="std std-numref">Fig. 4.15</span></a>, the points are colored with
the default <code class="docutils literal notranslate"><span class="pre">altair</span></code> color scheme, which is called <code class="docutils literal notranslate"><span class="pre">"tableau10"</span></code>. This is an appropriate choice for most situations and is also easy to read for people with reduced color vision.
In general, the color schemes that are used by default in Altair are adapted to the type of data that is displayed and selected to be easy to interpret both for people with good and reduced color vision.
If you are unsure about a certain color combination, you can use
this <a class="reference external" href="https://www.color-blindness.com/coblis-color-blindness-simulator/">color blindness simulator</a> to check
if your visualizations are color-blind friendly.</p>
<p>All the available color schemes and information on how to create your own can be viewed <a class="reference external" href="https://altair-viz.github.io/user_guide/customization.html#customizing-colors">in the Altair documentation</a>.
To change the color scheme of our chart,
we can add the <code class="docutils literal notranslate"><span class="pre">scheme</span></code> argument in the <code class="docutils literal notranslate"><span class="pre">scale</span></code> of the <code class="docutils literal notranslate"><span class="pre">color</span></code> encoding.
Below we pick the <code class="docutils literal notranslate"><span class="pre">"dark2"</span></code> theme, with the result shown
in <a class="reference internal" href="#can-lang-plot-theme"><span class="std std-numref">Fig. 4.16</span></a>.
We also set the <code class="docutils literal notranslate"><span class="pre">shape</span></code> aesthetic mapping to the <code class="docutils literal notranslate"><span class="pre">category</span></code> variable as well;
this makes the scatter point shapes different for each language category. This kind of
visual redundancy—i.e., conveying the same information with both scatter point color and shape—can
further improve the clarity and accessibility of your visualization,
but can add visual noise if there are many different shapes and colors,
so it should be used with care.
Note that we are switching back to the use of <code class="docutils literal notranslate"><span class="pre">mark_point</span></code> here
since <code class="docutils literal notranslate"><span class="pre">mark_circle</span></code> does not support the <code class="docutils literal notranslate"><span class="pre">shape</span></code> encoding
and will always show up as a filled circle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_theme</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"category"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">"dark2"</span><span class="p">),</span>
    <span class="n">shape</span><span class="o">=</span><span class="s2">"category"</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-theme" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-4ae3728d6c074005b135585ea831e8ad.vega-embed</ins><del>#altair-viz-1c19691201a74c2981c28c5958dd04f2.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-4ae3728d6c074005b135585ea831e8ad.vega-embed</ins><del>#altair-viz-1c19691201a74c2981c28c5958dd04f2.vega-embed</del> details,
  <ins>#altair-viz-4ae3728d6c074005b135585ea831e8ad.vega-embed</ins><del>#altair-viz-1c19691201a74c2981c28c5958dd04f2.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-4ae3728d6c074005b135585ea831e8ad"><div id="altair-viz-1c19691201a74c2981c28c5958dd04f2"></div><img src="prerendered/can-lang-plot-theme.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.16 </span><span class="caption-text">Scatter plot of percentage of Canadians reporting a language as their mother tongue vs the primary language at home colored by language category with custom colors and shapes.</span><a class="headerlink" href="#can-lang-plot-theme" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>The chart above gives a good indication of how the different language categories differ,
and this information is sufficient to answer our research question.
But what if we want to know exactly which language correspond to which point in the chart?
With a regular visualization library this would not be possible,
as adding text labels for each individual language
would add a lot of visual noise and make the chart difficult to interpret.
However, since Altair is an interactive visualization library we can add information on demand
via the <code class="docutils literal notranslate"><span class="pre">Tooltip</span></code> encoding channel,
so that text labels for each point show up once we hover over it with the mouse pointer.
Here we also add the exact values of the variables on the x and y-axis to the tooltip.</p>
<div class="cell docutils container" id="index-26">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang_plot_tooltip</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"most_at_home_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Language spoken most at home"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"mother_tongue_percent"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">([</span><span class="s2">"Mother tongue"</span><span class="p">,</span> <span class="s2">"(percentage of Canadian residents)"</span><span class="p">]),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"category"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">"dark2"</span><span class="p">),</span>
    <span class="n">shape</span><span class="o">=</span><span class="s2">"category"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">([</span><span class="s2">"language"</span><span class="p">,</span> <span class="s2">"mother_tongue"</span><span class="p">,</span> <span class="s2">"most_at_home"</span><span class="p">])</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">titleFontSize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="can-lang-plot-tooltip" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-85ed655f44eb47eda5828e524f058f32.vega-embed</ins><del>#altair-viz-9d4f5edd11ec404cb1c1eb91b0e1532c.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-85ed655f44eb47eda5828e524f058f32.vega-embed</ins><del>#altair-viz-9d4f5edd11ec404cb1c1eb91b0e1532c.vega-embed</del> details,
  <ins>#altair-viz-85ed655f44eb47eda5828e524f058f32.vega-embed</ins><del>#altair-viz-9d4f5edd11ec404cb1c1eb91b0e1532c.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-85ed655f44eb47eda5828e524f058f32"><div id="altair-viz-9d4f5edd11ec404cb1c1eb91b0e1532c"></div><img src="prerendered/can-lang-plot-tooltip.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.17 </span><span class="caption-text">Scatter plot of percentage of Canadians reporting a language as their mother tongue vs the primary language at home colored by language category with custom colors and mouse hover tooltip.</span><a class="headerlink" href="#can-lang-plot-tooltip" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>From the visualization in <a class="reference internal" href="#can-lang-plot-tooltip"><span class="std std-numref">Fig. 4.17</span></a>,
we can now clearly see that the vast majority of Canadians reported one of the official languages
as their mother tongue and as the language they speak most often at home.
What do we see when considering the second part of our exploratory question?
Do we see a difference in the relationship
between languages spoken as a mother tongue and as a primary language
at home across the higher-level language categories?
Based on <a class="reference internal" href="#can-lang-plot-tooltip"><span class="std std-numref">Fig. 4.17</span></a>, there does not
appear to be much of a difference.
For each higher-level language category,
there appears to be a strong, positive, and linear relationship between
the percentage of people who speak a language as their mother tongue
and the percentage who speak it as their primary language at home.
The relationship looks similar regardless of the category.</p>
<p>Does this mean that this relationship is positive for all languages in the
world? And further, can we use this data visualization on its own to predict how many people
have a given language as their mother tongue if we know how many people speak
it as their primary language at home? The answer to both these questions is
“no!” However, with exploratory data analysis, we can create new hypotheses,
ideas, and questions (like the ones at the beginning of this paragraph).
Answering those questions often involves doing more complex analyses, and sometimes
even gathering additional data. We will see more of such complex analyses later on in
this book.</p>
</section>
<section id="bar-plots-the-island-landmass-data-set">
<h3><span class="section-number">4.5.4. </span>Bar plots: the island landmass data set<a class="headerlink" href="#bar-plots-the-island-landmass-data-set" title="Permalink to this heading">#</a></h3>
<p id="index-27">The <code class="docutils literal notranslate"><span class="pre">islands.csv</span></code> data set contains a list of Earth’s landmasses as well as their area (in thousands of square miles) <span id="id5">[<a class="reference internal" href="#id51" title="Donald R. McNeil. Interactive Data Analysis: A Practical Primer. Wiley, 1977.">McNeil, 1977</a>]</span>.</p>
<p id="index-28"><strong>Question:</strong> Are the continents (North / South America, Africa, Europe, Asia, Australia, Antarctica) Earth’s seven largest landmasses? If so, what are the next few largest landmasses after those?</p>
<p>To get started, we will read and inspect the data:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">islands_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/islands.csv"</span><span class="p">)</span>
<span class="n">islands_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>landmass</th>
<th>size</th>
<th>landmass_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Africa</td>
<td>11506</td>
<td>Continent</td>
</tr>
<tr>
<th>1</th>
<td>Antarctica</td>
<td>5500</td>
<td>Continent</td>
</tr>
<tr>
<th>2</th>
<td>Asia</td>
<td>16988</td>
<td>Continent</td>
</tr>
<tr>
<th>3</th>
<td>Australia</td>
<td>2968</td>
<td>Continent</td>
</tr>
<tr>
<th>4</th>
<td>Axel Heiberg</td>
<td>16</td>
<td>Other</td>
</tr>
<tr>
<th>5</th>
<td>Baffin</td>
<td>184</td>
<td>Other</td>
</tr>
<tr>
<th>6</th>
<td>Banks</td>
<td>23</td>
<td>Other</td>
</tr>
<tr>
<th>7</th>
<td>Borneo</td>
<td>280</td>
<td>Other</td>
</tr>
<tr>
<th>8</th>
<td>Britain</td>
<td>84</td>
<td>Other</td>
</tr>
<tr>
<th>9</th>
<td>Celebes</td>
<td>73</td>
<td>Other</td>
</tr>
<tr>
<th>10</th>
<td>Celon</td>
<td>25</td>
<td>Other</td>
</tr>
<tr>
<th>11</th>
<td>Cuba</td>
<td>43</td>
<td>Other</td>
</tr>
<tr>
<th>12</th>
<td>Devon</td>
<td>21</td>
<td>Other</td>
</tr>
<tr>
<th>13</th>
<td>Ellesmere</td>
<td>82</td>
<td>Other</td>
</tr>
<tr>
<th>14</th>
<td>Europe</td>
<td>3745</td>
<td>Continent</td>
</tr>
<tr>
<th>15</th>
<td>Greenland</td>
<td>840</td>
<td>Other</td>
</tr>
<tr>
<th>16</th>
<td>Hainan</td>
<td>13</td>
<td>Other</td>
</tr>
<tr>
<th>17</th>
<td>Hispaniola</td>
<td>30</td>
<td>Other</td>
</tr>
<tr>
<th>18</th>
<td>Hokkaido</td>
<td>30</td>
<td>Other</td>
</tr>
<tr>
<th>19</th>
<td>Honshu</td>
<td>89</td>
<td>Other</td>
</tr>
<tr>
<th>20</th>
<td>Iceland</td>
<td>40</td>
<td>Other</td>
</tr>
<tr>
<th>21</th>
<td>Ireland</td>
<td>33</td>
<td>Other</td>
</tr>
<tr>
<th>22</th>
<td>Java</td>
<td>49</td>
<td>Other</td>
</tr>
<tr>
<th>23</th>
<td>Kyushu</td>
<td>14</td>
<td>Other</td>
</tr>
<tr>
<th>24</th>
<td>Luzon</td>
<td>42</td>
<td>Other</td>
</tr>
<tr>
<th>25</th>
<td>Madagascar</td>
<td>227</td>
<td>Other</td>
</tr>
<tr>
<th>26</th>
<td>Melville</td>
<td>16</td>
<td>Other</td>
</tr>
<tr>
<th>27</th>
<td>Mindanao</td>
<td>36</td>
<td>Other</td>
</tr>
<tr>
<th>28</th>
<td>Moluccas</td>
<td>29</td>
<td>Other</td>
</tr>
<tr>
<th>29</th>
<td>New Britain</td>
<td>15</td>
<td>Other</td>
</tr>
<tr>
<th>30</th>
<td>New Guinea</td>
<td>306</td>
<td>Other</td>
</tr>
<tr>
<th>31</th>
<td>New Zealand (N)</td>
<td>44</td>
<td>Other</td>
</tr>
<tr>
<th>32</th>
<td>New Zealand (S)</td>
<td>58</td>
<td>Other</td>
</tr>
<tr>
<th>33</th>
<td>Newfoundland</td>
<td>43</td>
<td>Other</td>
</tr>
<tr>
<th>34</th>
<td>North America</td>
<td>9390</td>
<td>Continent</td>
</tr>
<tr>
<th>35</th>
<td>Novaya Zemlya</td>
<td>32</td>
<td>Other</td>
</tr>
<tr>
<th>36</th>
<td>Prince of Wales</td>
<td>13</td>
<td>Other</td>
</tr>
<tr>
<th>37</th>
<td>Sakhalin</td>
<td>29</td>
<td>Other</td>
</tr>
<tr>
<th>38</th>
<td>South America</td>
<td>6795</td>
<td>Continent</td>
</tr>
<tr>
<th>39</th>
<td>Southampton</td>
<td>16</td>
<td>Other</td>
</tr>
<tr>
<th>40</th>
<td>Spitsbergen</td>
<td>15</td>
<td>Other</td>
</tr>
<tr>
<th>41</th>
<td>Sumatra</td>
<td>183</td>
<td>Other</td>
</tr>
<tr>
<th>42</th>
<td>Taiwan</td>
<td>14</td>
<td>Other</td>
</tr>
<tr>
<th>43</th>
<td>Tasmania</td>
<td>26</td>
<td>Other</td>
</tr>
<tr>
<th>44</th>
<td>Tierra del Fuego</td>
<td>19</td>
<td>Other</td>
</tr>
<tr>
<th>45</th>
<td>Timor</td>
<td>13</td>
<td>Other</td>
</tr>
<tr>
<th>46</th>
<td>Vancouver</td>
<td>12</td>
<td>Other</td>
</tr>
<tr>
<th>47</th>
<td>Victoria</td>
<td>82</td>
<td>Other</td>
</tr>
</tbody>
</table>
</div></div></div>
</div>
<p>Here, we have a data frame of Earth’s landmasses,
and are trying to compare their sizes.
The right type of visualization to answer this question is a bar plot.
In a bar plot, the height of each bar represents the value of an <em>amount</em>
(a size, count, proportion, percentage, etc).
They are particularly useful for comparing counts or proportions across different
groups of a categorical variable. Note, however, that bar plots should generally not be
used to display mean or median values, as they hide important information about
the variation of the data. Instead it’s better to show the distribution of
all the individual data points, e.g., using a histogram, which we will discuss further in <a class="reference internal" href="#histogramsviz"><span class="std std-numref">Section 4.5.5</span></a>.</p>
<p id="index-29">We specify that we would like to use a bar plot
via the <code class="docutils literal notranslate"><span class="pre">mark_bar</span></code> function in <code class="docutils literal notranslate"><span class="pre">altair</span></code>.
The result is shown in <a class="reference internal" href="#islands-bar"><span class="std std-numref">Fig. 4.18</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">islands_bar</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">islands_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"landmass"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"size"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="islands-bar" style="width: 400px">
<div class="output text_html">
<style>
  <ins>#altair-viz-5371f55367a2456a8a6e7f54ac0e069b.vega-embed</ins><del>#altair-viz-2214a65002aa421a982312a8351cb7fd.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-5371f55367a2456a8a6e7f54ac0e069b.vega-embed</ins><del>#altair-viz-2214a65002aa421a982312a8351cb7fd.vega-embed</del> details,
  <ins>#altair-viz-5371f55367a2456a8a6e7f54ac0e069b.vega-embed</ins><del>#altair-viz-2214a65002aa421a982312a8351cb7fd.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5371f55367a2456a8a6e7f54ac0e069b"><div id="altair-viz-2214a65002aa421a982312a8351cb7fd"></div><img src="prerendered/islands-bar.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.18 </span><span class="caption-text">Bar plot of Earth’s landmass sizes. The plot is too wide with the default settings.</span><a class="headerlink" href="#islands-bar" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>Alright, not bad! The plot in <a class="reference internal" href="#islands-bar"><span class="std std-numref">Fig. 4.18</span></a> is
definitely the right kind of visualization, as we can clearly see and compare
sizes of landmasses. The major issues are that the smaller landmasses’ sizes
are hard to distinguish, and the plot is so wide that we can’t compare them all! But remember that the
question we asked was only about the largest landmasses; let’s make the plot a
little bit clearer by keeping only the largest 12 landmasses. We do this using
the <code class="docutils literal notranslate"><span class="pre">nlargest</span></code> function: the first argument is the number of rows we want and
the second is the name of the column we want to use for comparing which is
largest. Then to help make the landmass labels easier to read
we’ll swap the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> variables,
so that the labels are on the y-axis and we don’t have to tilt our head to read them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Recall that in <a class="reference internal link-to-diff" href="intro.html#intro"><span class="std std-numref">Chapter 1</span></a>, we used <code class="docutils literal notranslate"><span class="pre">sort_values</span></code> followed by <code class="docutils literal notranslate"><span class="pre">head</span></code> to obtain
the ten rows with the largest values of a variable. We could have instead used the <code class="docutils literal notranslate"><span class="pre">nlargest</span></code> function
from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> for this purpose. The <code class="docutils literal notranslate"><span class="pre">nsmallest</span></code> and <code class="docutils literal notranslate"><span class="pre">nlargest</span></code> functions achieve the same goal
as <code class="docutils literal notranslate"><span class="pre">sort_values</span></code> followed by <code class="docutils literal notranslate"><span class="pre">head</span></code>, but are slightly more efficient because they are specialized for this purpose.
In general, it is good to use more specialized functions when they are available!</p>
</div>
<div class="cell docutils container" id="index-30">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">islands_top12</span> <span class="o">=</span> <span class="n">islands_df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="s2">"size"</span><span class="p">)</span>

<span class="n">islands_bar_top</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">islands_top12</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"size"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"landmass"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="islands-bar-top" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-8c22d1555a924aecb3fe3bbdce6cc888.vega-embed</ins><del>#altair-viz-13592b1568e741b0bf90207d915915c0.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-8c22d1555a924aecb3fe3bbdce6cc888.vega-embed</ins><del>#altair-viz-13592b1568e741b0bf90207d915915c0.vega-embed</del> details,
  <ins>#altair-viz-8c22d1555a924aecb3fe3bbdce6cc888.vega-embed</ins><del>#altair-viz-13592b1568e741b0bf90207d915915c0.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-8c22d1555a924aecb3fe3bbdce6cc888"><div id="altair-viz-13592b1568e741b0bf90207d915915c0"></div><img src="prerendered/islands-bar-top.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.19 </span><span class="caption-text">Bar plot of size for Earth’s largest 12 landmasses.</span><a class="headerlink" href="#islands-bar-top" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>The plot in <a class="reference internal" href="#islands-bar-top"><span class="std std-numref">Fig. 4.19</span></a> is definitely clearer now,
and allows us to answer our initial questions:
“Are the seven continents Earth’s largest landmasses?”
and “Which are the next few largest landmasses?”.
However, we could still improve this visualization
by coloring the bars based on whether they correspond to a continent, and
by organizing the bars by landmass size rather than by alphabetical order.
The data for coloring the bars is stored in the <code class="docutils literal notranslate"><span class="pre">landmass_type</span></code> column, so
we set the <code class="docutils literal notranslate"><span class="pre">color</span></code> encoding to <code class="docutils literal notranslate"><span class="pre">landmass_type</span></code>.
To organize the landmasses by their <code class="docutils literal notranslate"><span class="pre">size</span></code> variable,
we will use the altair <code class="docutils literal notranslate"><span class="pre">sort</span></code> function
in the y-encoding of the chart.
Since the <code class="docutils literal notranslate"><span class="pre">size</span></code> variable is encoded in the x channel of the chart,
we specify <code class="docutils literal notranslate"><span class="pre">sort("x")</span></code> on <code class="docutils literal notranslate"><span class="pre">alt.Y</span></code>.
This plots the values on <code class="docutils literal notranslate"><span class="pre">y</span></code> axis
in the ascending order of <code class="docutils literal notranslate"><span class="pre">x</span></code> axis values.
This creates a chart where the largest bar is the closest to the axis line,
which is generally the most visually appealing when sorting bars.
If instead we wanted to sort the values on <code class="docutils literal notranslate"><span class="pre">y-axis</span></code> in descending order of <code class="docutils literal notranslate"><span class="pre">x-axis</span></code>,
we could add a minus sign to reverse the order and specify <code class="docutils literal notranslate"><span class="pre">sort="-x"</span></code>.</p>
<p id="index-31">To finalize this plot we will customize the axis and legend labels using the <code class="docutils literal notranslate"><span class="pre">title</span></code> method,
and add a title to the chart by specifying the <code class="docutils literal notranslate"><span class="pre">title</span></code> argument of <code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code>.
Plot titles are not always required, especially when it would be redundant with an already-existing
caption or surrounding context (e.g., in a slide presentation with annotations).
But if you decide to include one, a good plot title should provide the take home message
that you want readers to focus on, e.g., “Earth’s seven largest landmasses are continents,”
or a more general summary of the information displayed, e.g., “Earth’s twelve largest landmasses.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">islands_plot_sorted</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
	<span class="n">islands_top12</span><span class="p">,</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Earth's seven largest landmasses are continents"</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"size"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Size (1000 square mi)"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"landmass"</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Landmass"</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"landmass_type"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Type"</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="islands-plot-sorted" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-f2c1f55f2dfa4d8a84b3a4065066092f.vega-embed</ins><del>#altair-viz-09b0feb053a64236a176ee88cc500709.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-f2c1f55f2dfa4d8a84b3a4065066092f.vega-embed</ins><del>#altair-viz-09b0feb053a64236a176ee88cc500709.vega-embed</del> details,
  <ins>#altair-viz-f2c1f55f2dfa4d8a84b3a4065066092f.vega-embed</ins><del>#altair-viz-09b0feb053a64236a176ee88cc500709.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-f2c1f55f2dfa4d8a84b3a4065066092f"><div id="altair-viz-09b0feb053a64236a176ee88cc500709"></div><img src="prerendered/islands-plot-sorted.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.20 </span><span class="caption-text">Bar plot of size for Earth’s largest 12 landmasses, colored by landmass type, with clearer axes and labels.</span><a class="headerlink" href="#islands-plot-sorted" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>The plot in <a class="reference internal" href="#islands-plot-sorted"><span class="std std-numref">Fig. 4.20</span></a> is now an effective
visualization for answering our original questions. Landmasses are organized by
their size, and continents are colored differently than other landmasses,
making it quite clear that all the seven largest landmasses are continents.</p>
</section>
<section id="histograms-the-michelson-speed-of-light-data-set">
<span id="histogramsviz"></span><h3><span class="section-number">4.5.5. </span>Histograms: the Michelson speed of light data set<a class="headerlink" href="#histograms-the-michelson-speed-of-light-data-set" title="Permalink to this heading">#</a></h3>
<p id="index-32">The <code class="docutils literal notranslate"><span class="pre">morley</span></code> data set
contains measurements of the speed of light
collected in experiments performed in 1879.
Five experiments were performed,
and in each experiment, 20 runs were performed—meaning that
20 measurements of the speed of light were collected
in each experiment <span id="id6">[<a class="reference internal" href="#id52" title="Albert Michelson. Experimental determination of the velocity of light made at the United States Naval Academy, Annapolis. Astronomic Papers, 1:135–8, 1882.">Michelson, 1882</a>]</span>.
Because the speed of light is a very large number
(the true value is 299,792.458 km/sec), the data is coded
to be the measured speed of light minus 299,000.
This coding allows us to focus on the variations in the measurements, which are generally
much smaller than 299,000.
If we used the full large speed measurements, the variations in the measurements
would not be noticeable, making it difficult to study the differences between the experiments.</p>
<p id="index-33"><strong>Question:</strong> Given what we know now about the speed of
light (299,792.458 kilometres per second), how accurate were each of the experiments?</p>
<p>First, we read in the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/morley.csv"</span><span class="p">)</span>
<span class="n">morley_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Expt</th>
<th>Run</th>
<th>Speed</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>1</td>
<td>850</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2</td>
<td>740</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>3</td>
<td>900</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>4</td>
<td>1070</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>5</td>
<td>930</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>95</th>
<td>5</td>
<td>16</td>
<td>940</td>
</tr>
<tr>
<th>96</th>
<td>5</td>
<td>17</td>
<td>950</td>
</tr>
<tr>
<th>97</th>
<td>5</td>
<td>18</td>
<td>800</td>
</tr>
<tr>
<th>98</th>
<td>5</td>
<td>19</td>
<td>810</td>
</tr>
<tr>
<th>99</th>
<td>5</td>
<td>20</td>
<td>870</td>
</tr>
</tbody>
</table>
<p>100 rows × 3 columns</p>
</div></div></div>
</div>
<span class="target" id="index-34"></span><p id="index-35">In this experimental data,
Michelson was trying to measure just a single quantitative number
(the speed of light).
The data set contains many measurements of this single quantity.
To tell how accurate the experiments were,
we need to visualize the distribution of the measurements
(i.e., all their possible values and how often each occurs).
We can do this using a <em>histogram</em>.
A histogram
helps us visualize how a particular variable is distributed in a data set
by grouping the values into bins,
and then using vertical bars to show how many data points fell in each bin.</p>
<p>To understand how to create a histogram in <code class="docutils literal notranslate"><span class="pre">altair</span></code>,
let’s start by creating a bar chart
just like we did in the previous section.
Note that this time,
we are setting the <code class="docutils literal notranslate"><span class="pre">y</span></code> encoding to <code class="docutils literal notranslate"><span class="pre">"count()"</span></code>.
There is no <code class="docutils literal notranslate"><span class="pre">"count()"</span></code> column-name in <code class="docutils literal notranslate"><span class="pre">morley_df</span></code>;
we use <code class="docutils literal notranslate"><span class="pre">"count()"</span></code> to tell <code class="docutils literal notranslate"><span class="pre">altair</span></code>
that we want to count the number of occurrences of each value in along the x-axis
(which we encoded as the <code class="docutils literal notranslate"><span class="pre">Speed</span></code> column).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Speed"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count()"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-bars" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-7b37e2addd0045f0b66cb75338a90c85.vega-embed</ins><del>#altair-viz-34c3e30a8a454bff9c7c743a35aa9f08.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-7b37e2addd0045f0b66cb75338a90c85.vega-embed</ins><del>#altair-viz-34c3e30a8a454bff9c7c743a35aa9f08.vega-embed</del> details,
  <ins>#altair-viz-7b37e2addd0045f0b66cb75338a90c85.vega-embed</ins><del>#altair-viz-34c3e30a8a454bff9c7c743a35aa9f08.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-7b37e2addd0045f0b66cb75338a90c85"><div id="altair-viz-34c3e30a8a454bff9c7c743a35aa9f08"></div><img src="prerendered/morley-bars.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.21 </span><span class="caption-text">A bar chart of Michelson’s speed of light data.</span><a class="headerlink" href="#morley-bars" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>The bar chart above gives us an indication of
which values are more common than others,
but because the bars are so thin it’s hard to get a sense for the
overall distribution of the data.
We don’t really care about how many occurrences there are of each exact <code class="docutils literal notranslate"><span class="pre">Speed</span></code> value,
but rather where most of the <code class="docutils literal notranslate"><span class="pre">Speed</span></code> values fall in general.
To more effectively communicate this information
we can group the x-axis into bins (or “buckets”) using the <code class="docutils literal notranslate"><span class="pre">bin</span></code> method
and then count how many <code class="docutils literal notranslate"><span class="pre">Speed</span></code> values fall within each bin.
A bar chart that represent the count of values
for a binned quantitative variable is called a histogram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_hist</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Speed"</span><span class="p">)</span><span class="o">.</span><span class="n">bin</span><span class="p">(),</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count()"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-hist" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-e2fd12f0c96149188057abf10e52acc8.vega-embed</ins><del>#altair-viz-084a7f7c22ab458aa3391e3bff27c15b.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-e2fd12f0c96149188057abf10e52acc8.vega-embed</ins><del>#altair-viz-084a7f7c22ab458aa3391e3bff27c15b.vega-embed</del> details,
  <ins>#altair-viz-e2fd12f0c96149188057abf10e52acc8.vega-embed</ins><del>#altair-viz-084a7f7c22ab458aa3391e3bff27c15b.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-e2fd12f0c96149188057abf10e52acc8"><div id="altair-viz-084a7f7c22ab458aa3391e3bff27c15b"></div><img src="prerendered/morley-hist.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.22 </span><span class="caption-text">Histogram of Michelson’s speed of light data.</span><a class="headerlink" href="#morley-hist" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<section id="adding-layers-to-an-altair-chart">
<h4>Adding layers to an <code class="docutils literal notranslate"><span class="pre">altair</span></code> chart<a class="headerlink" href="#adding-layers-to-an-altair-chart" title="Permalink to this heading">#</a></h4>
<p id="index-36"><a class="reference internal" href="#morley-hist"><span class="std std-numref">Fig. 4.22</span></a> is a great start.
However,
we cannot tell how accurate the measurements are using this visualization
unless we can see the true value.
In order to visualize the true speed of light,
we will add a vertical line with the <code class="docutils literal notranslate"><span class="pre">mark_rule</span></code> function.
To draw a vertical line with <code class="docutils literal notranslate"><span class="pre">mark_rule</span></code>,
we need to specify where on the x-axis the line should be drawn.
We can do this by providing <code class="docutils literal notranslate"><span class="pre">x=alt.datum(792.458)</span></code>,
where the value <code class="docutils literal notranslate"><span class="pre">792.458</span></code> is the true speed of light minus 299,000
and <code class="docutils literal notranslate"><span class="pre">alt.datum</span></code> tells altair that we have a single datum
(number) that we would like plotted (rather than a column in the data frame).
Similarly, a horizontal line can be plotted using the <code class="docutils literal notranslate"><span class="pre">y</span></code> axis encoding and
the dataframe with one value, which would act as the be the y-intercept.
Note that
<em>vertical lines</em> are used to denote quantities on the <em>horizontal axis</em>,
while <em>horizontal lines</em> are used to denote quantities on the <em>vertical axis</em>.</p>
<p>To fine tune the appearance of this vertical line,
we can change it from a solid to a dashed line with <code class="docutils literal notranslate"><span class="pre">strokeDash=[5]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">5</span></code> indicates the length of each dash. We also
change the thickness of the line by specifying <code class="docutils literal notranslate"><span class="pre">size=2</span></code>.
To add the dashed line on top of the histogram, we
<strong>add</strong> the <code class="docutils literal notranslate"><span class="pre">mark_rule</span></code> chart to the <code class="docutils literal notranslate"><span class="pre">morley_hist</span></code>
using the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.
Adding features to a plot using the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator is known as <em>layering</em> in <code class="docutils literal notranslate"><span class="pre">altair</span></code>.
This is a powerful feature of <code class="docutils literal notranslate"><span class="pre">altair</span></code>; you
can continue to iterate on a single chart, adding and refining
one layer at a time. If you stored your chart as a variable
using the assignment symbol (<code class="docutils literal notranslate"><span class="pre">=</span></code>), you can add to it using the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.
Below we add a vertical line created using <code class="docutils literal notranslate"><span class="pre">mark_rule</span></code>
to the <code class="docutils literal notranslate"><span class="pre">morley_hist</span></code> we created previously.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Technically we could have left out the data argument
when creating the rule chart
since we’re not using any values from the <code class="docutils literal notranslate"><span class="pre">morley_df</span></code> data frame,
but we will need it later when we facet this layered chart,
so we are including it here already.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_line</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">strokeDash</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mf">792.458</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">morley_hist_line</span> <span class="o">=</span> <span class="n">morley_hist</span> <span class="o">+</span> <span class="n">v_line</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-hist-line" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-53c5fab68f3542ff8d1bbc4f87955218.vega-embed</ins><del>#altair-viz-5af1f2c0d637411f92b33b7ecbccfd11.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-53c5fab68f3542ff8d1bbc4f87955218.vega-embed</ins><del>#altair-viz-5af1f2c0d637411f92b33b7ecbccfd11.vega-embed</del> details,
  <ins>#altair-viz-53c5fab68f3542ff8d1bbc4f87955218.vega-embed</ins><del>#altair-viz-5af1f2c0d637411f92b33b7ecbccfd11.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-53c5fab68f3542ff8d1bbc4f87955218"><div id="altair-viz-5af1f2c0d637411f92b33b7ecbccfd11"></div><img src="prerendered/morley-hist-line.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.23 </span><span class="caption-text">Histogram of Michelson’s speed of light data with vertical line indicating the true speed of light.</span><a class="headerlink" href="#morley-hist-line" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>In <a class="reference internal" href="#morley-hist-line"><span class="std std-numref">Fig. 4.23</span></a>,
we still cannot tell which experiments (denoted by the <code class="docutils literal notranslate"><span class="pre">Expt</span></code> column)
led to which measurements;
perhaps some experiments were more accurate than others.
To fully answer our question,
we need to separate the measurements from each other visually.
We can try to do this using a <em>colored</em> histogram,
where counts from different experiments are stacked on top of each other
in different colors.
We can create a histogram colored by the <code class="docutils literal notranslate"><span class="pre">Expt</span></code> variable
by adding it to the <code class="docutils literal notranslate"><span class="pre">color</span></code> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_hist_colored</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Speed"</span><span class="p">)</span><span class="o">.</span><span class="n">bin</span><span class="p">(),</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count()"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Expt"</span>
<span class="p">)</span>

<span class="n">morley_hist_colored</span> <span class="o">=</span> <span class="n">morley_hist_colored</span> <span class="o">+</span> <span class="n">v_line</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-hist-colored" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-020677a5ed7b47359d94833af0e1960e.vega-embed</ins><del>#altair-viz-98c0f6e146ef4899b0664cc4834db2c9.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-020677a5ed7b47359d94833af0e1960e.vega-embed</ins><del>#altair-viz-98c0f6e146ef4899b0664cc4834db2c9.vega-embed</del> details,
  <ins>#altair-viz-020677a5ed7b47359d94833af0e1960e.vega-embed</ins><del>#altair-viz-98c0f6e146ef4899b0664cc4834db2c9.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-020677a5ed7b47359d94833af0e1960e"><div id="altair-viz-98c0f6e146ef4899b0664cc4834db2c9"></div><img src="prerendered/morley-hist-colored.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.24 </span><span class="caption-text">Histogram of Michelson’s speed of light data colored by experiment.</span><a class="headerlink" href="#morley-hist-colored" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p id="index-37">Alright great, <a class="reference internal" href="#morley-hist-colored"><span class="std std-numref">Fig. 4.24</span></a> looks… wait a second! We are not able to easily distinguish
between the colors of the different Experiments in the histogram! What is going on here? Well, if you
recall from <a class="reference internal link-to-diff" href="wrangling.html#wrangling"><span class="std std-numref">Chapter 3</span></a>, the <em>data type</em> you use for each variable
can influence how Python and <code class="docutils literal notranslate"><span class="pre">altair</span></code> treats it. Here, we indeed have an issue
with the data types in the <code class="docutils literal notranslate"><span class="pre">morley</span></code> data frame. In particular, the <code class="docutils literal notranslate"><span class="pre">Expt</span></code> column
is currently an <em>integer</em>—specifically, an <code class="docutils literal notranslate"><span class="pre">int64</span></code> type. But we want to treat it as a
<em>category</em>, i.e., there should be one category per type of experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 100 entries, 0 to 99
Data columns (total 3 columns):
 #   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   Expt    100 non-null    int64
 1   Run     100 non-null    int64
 2   Speed   100 non-null    int64
dtypes: int64(3)
memory usage: 2.5 KB
</pre></div>
</div>
</div>
</div>
<p id="index-38">To fix this issue we can convert the <code class="docutils literal notranslate"><span class="pre">Expt</span></code> variable into a <code class="docutils literal notranslate"><span class="pre">nominal</span></code>
(i.e., categorical) type variable by adding a suffix <code class="docutils literal notranslate"><span class="pre">:N</span></code>
to the <code class="docutils literal notranslate"><span class="pre">Expt</span></code> variable. Adding the <code class="docutils literal notranslate"><span class="pre">:N</span></code> suffix ensures that <code class="docutils literal notranslate"><span class="pre">altair</span></code>
will treat a variable as a categorical variable, and
hence use a discrete color map in visualizations
(<a class="reference external" href="https://altair-viz.github.io/user_guide/encodings/index.html#encoding-data-types">read more about data types in the altair documentation</a>).
We also add the <code class="docutils literal notranslate"><span class="pre">stack(False)</span></code> method on the <code class="docutils literal notranslate"><span class="pre">y</span></code> encoding so
that the bars are not stacked on top of each other,
but instead share the same baseline.
We try to ensure that the different colors can be seen
despite them sitting in front of each other
by setting the <code class="docutils literal notranslate"><span class="pre">opacity</span></code> argument in <code class="docutils literal notranslate"><span class="pre">mark_bar</span></code> to <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
to make the bars slightly translucent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_hist_categorical</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Speed"</span><span class="p">)</span><span class="o">.</span><span class="n">bin</span><span class="p">(),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"count()"</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Expt:N"</span>
<span class="p">)</span>

<span class="n">morley_hist_categorical</span> <span class="o">=</span> <span class="n">morley_hist_categorical</span> <span class="o">+</span> <span class="n">v_line</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-hist-categorical" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-cc4da545e9bd4f8b9e7209cc05650ee2.vega-embed</ins><del>#altair-viz-2eacb61a852640be900bbaaccb2e1283.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-cc4da545e9bd4f8b9e7209cc05650ee2.vega-embed</ins><del>#altair-viz-2eacb61a852640be900bbaaccb2e1283.vega-embed</del> details,
  <ins>#altair-viz-cc4da545e9bd4f8b9e7209cc05650ee2.vega-embed</ins><del>#altair-viz-2eacb61a852640be900bbaaccb2e1283.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-cc4da545e9bd4f8b9e7209cc05650ee2"><div id="altair-viz-2eacb61a852640be900bbaaccb2e1283"></div><img src="prerendered/morley-hist-categorical.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.25 </span><span class="caption-text">Histogram of Michelson’s speed of light data colored by experiment as a categorical variable.</span><a class="headerlink" href="#morley-hist-categorical" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>Unfortunately, the attempt to separate out the experiment number visually has
created a bit of a mess. All of the colors in <a class="reference internal" href="#morley-hist-categorical"><span class="std std-numref">Fig. 4.25</span></a> are blending together, and although it is
possible to derive <em>some</em> insight from this (e.g., experiments 1 and 3 had some
of the most incorrect measurements), it isn’t the clearest way to convey our
message and answer the question. Let’s try a different strategy of creating
grid of separate histogram plots.</p>
<p id="index-39">We can use the <code class="docutils literal notranslate"><span class="pre">facet</span></code> function to create a chart
that has multiple subplots arranged in a grid.
The argument to <code class="docutils literal notranslate"><span class="pre">facet</span></code> specifies the variable(s) used to split the plot
into subplots (<code class="docutils literal notranslate"><span class="pre">Expt</span></code> in the code below),
and how many columns there should be in the grid.
In this example, we chose to
arrange our plots in a single column (<code class="docutils literal notranslate"><span class="pre">columns=1</span></code>) since this makes it easier for
us to compare the location of the histograms along the <code class="docutils literal notranslate"><span class="pre">x</span></code>-axis
in the different subplots.
We also reduce the height of each chart
so that they all fit in the same view.
Note that we are re-using the chart we created just above,
instead of re-creating the same chart from scratch.
We also explicitly specify that <code class="docutils literal notranslate"><span class="pre">facet</span></code> is a categorical variable
since faceting should only be done with categorical variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_hist_facet</span> <span class="o">=</span> <span class="n">morley_hist_categorical</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">100</span>
<span class="p">)</span><span class="o">.</span><span class="n">facet</span><span class="p">(</span>
    <span class="s2">"Expt:N"</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-hist-facet" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-44afbbabd4ed42fb9a310788fe451a72.vega-embed</ins><del>#altair-viz-abba959cab034a9b88b89122365d0dae.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-44afbbabd4ed42fb9a310788fe451a72.vega-embed</ins><del>#altair-viz-abba959cab034a9b88b89122365d0dae.vega-embed</del> details,
  <ins>#altair-viz-44afbbabd4ed42fb9a310788fe451a72.vega-embed</ins><del>#altair-viz-abba959cab034a9b88b89122365d0dae.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-44afbbabd4ed42fb9a310788fe451a72"><div id="altair-viz-abba959cab034a9b88b89122365d0dae"></div><img src="prerendered/morley-hist-facet.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.26 </span><span class="caption-text">Histogram of Michelson’s speed of light data split vertically by experiment.</span><a class="headerlink" href="#morley-hist-facet" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>The visualization in <a class="reference internal" href="#morley-hist-facet"><span class="std std-numref">Fig. 4.26</span></a>
makes it clear how accurate the different experiments were
with respect to one another.
The most variable measurements came from Experiment 1,
where the measurements ranged from about 650–1050 km/sec.
The least variable measurements came from Experiment 2,
where the measurements ranged from about 750–950 km/sec.
The most different experiments still obtained quite similar overall results!</p>
<p id="index-40">There are three finishing touches to make this visualization even clearer.
First and foremost, we need to add informative axis labels using the <code class="docutils literal notranslate"><span class="pre">alt.X</span></code>
and <code class="docutils literal notranslate"><span class="pre">alt.Y</span></code> function, and increase the font size to make it readable using the
<code class="docutils literal notranslate"><span class="pre">configure_axis</span></code> function. We can also add a title; for a <code class="docutils literal notranslate"><span class="pre">facet</span></code> plot, this is
done by providing the <code class="docutils literal notranslate"><span class="pre">title</span></code> to the facet function. Finally, and perhaps most
subtly, even though it is easy to compare the experiments on this plot to one
another, it is hard to get a sense of just how accurate all the experiments
were overall. For example, how accurate is the value 800 on the plot, relative
to the true speed of light?  To answer this question, we’ll
transform our data to a relative measure of error rather than an absolute measurement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speed_of_light</span> <span class="o">=</span> <span class="mf">299792.458</span>
<span class="n">morley_df</span><span class="p">[</span><span class="s2">"RelativeError"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="mi">299000</span> <span class="o">+</span> <span class="n">morley_df</span><span class="p">[</span><span class="s2">"Speed"</span><span class="p">]</span> <span class="o">-</span> <span class="n">speed_of_light</span><span class="p">)</span> <span class="o">/</span> <span class="n">speed_of_light</span>
<span class="p">)</span>
<span class="n">morley_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Expt</th>
<th>Run</th>
<th>Speed</th>
<th>RelativeError</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>1</td>
<td>850</td>
<td>0.019194</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2</td>
<td>740</td>
<td>-0.017498</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>3</td>
<td>900</td>
<td>0.035872</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>4</td>
<td>1070</td>
<td>0.092578</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>5</td>
<td>930</td>
<td>0.045879</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>95</th>
<td>5</td>
<td>16</td>
<td>940</td>
<td>0.049215</td>
</tr>
<tr>
<th>96</th>
<td>5</td>
<td>17</td>
<td>950</td>
<td>0.052550</td>
</tr>
<tr>
<th>97</th>
<td>5</td>
<td>18</td>
<td>800</td>
<td>0.002516</td>
</tr>
<tr>
<th>98</th>
<td>5</td>
<td>19</td>
<td>810</td>
<td>0.005851</td>
</tr>
<tr>
<th>99</th>
<td>5</td>
<td>20</td>
<td>870</td>
<td>0.025865</td>
</tr>
</tbody>
</table>
<p>100 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_hist_rel</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"RelativeError"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">bin</span><span class="p">()</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Relative Error (%)"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"count()"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"# Measurements"</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Expt:N"</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment ID"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Recreating v_line to indicate that the speed of light is at 0% relative error</span>
<span class="n">v_line</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">strokeDash</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">morley_hist_relative</span> <span class="o">=</span> <span class="p">(</span><span class="n">morley_hist_rel</span> <span class="o">+</span> <span class="n">v_line</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">100</span>
<span class="p">)</span><span class="o">.</span><span class="n">facet</span><span class="p">(</span>
    <span class="s2">"Expt:N"</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Histogram of relative error of Michelson’s speed of light data"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-hist-relative" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-b479f3fcff8b45aa9d1023517e0e9d28.vega-embed</ins><del>#altair-viz-fd4caa8d5e86465b9e5a146b355ae1c0.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-b479f3fcff8b45aa9d1023517e0e9d28.vega-embed</ins><del>#altair-viz-fd4caa8d5e86465b9e5a146b355ae1c0.vega-embed</del> details,
  <ins>#altair-viz-b479f3fcff8b45aa9d1023517e0e9d28.vega-embed</ins><del>#altair-viz-fd4caa8d5e86465b9e5a146b355ae1c0.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b479f3fcff8b45aa9d1023517e0e9d28"><div id="altair-viz-fd4caa8d5e86465b9e5a146b355ae1c0"></div><img src="prerendered/morley-hist-relative.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.27 </span><span class="caption-text">Histogram of relative error split vertically by experiment with clearer axes and labels</span><a class="headerlink" href="#morley-hist-relative" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>Wow, impressive! These measurements of the speed of light from 1879 had errors
around <em>0.05%</em> of the true speed. <a class="reference internal" href="#morley-hist-relative"><span class="std std-numref">Fig. 4.27</span></a> shows you that
even though experiments 2 and 5 were perhaps the most accurate, all of the
experiments did quite an admirable job given the technology available at the time.</p>
</section>
<section id="choosing-a-binwidth-for-histograms">
<h4>Choosing a binwidth for histograms<a class="headerlink" href="#choosing-a-binwidth-for-histograms" title="Permalink to this heading">#</a></h4>
<p>When you create a histogram in <code class="docutils literal notranslate"><span class="pre">altair</span></code>, it tries to choose a reasonable number of bins.
We can change the number of bins by using the <code class="docutils literal notranslate"><span class="pre">maxbins</span></code> parameter
inside the <code class="docutils literal notranslate"><span class="pre">bin</span></code> method.</p>
<div class="cell docutils container" id="index-41">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morley_hist_maxbins</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">morley_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"RelativeError"</span><span class="p">)</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count()"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="morley-hist-maxbins" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-21bd942916f94d22a7f1a847df99b65b.vega-embed</ins><del>#altair-viz-eae9cf7f69794332922385668dd004c6.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-21bd942916f94d22a7f1a847df99b65b.vega-embed</ins><del>#altair-viz-eae9cf7f69794332922385668dd004c6.vega-embed</del> details,
  <ins>#altair-viz-21bd942916f94d22a7f1a847df99b65b.vega-embed</ins><del>#altair-viz-eae9cf7f69794332922385668dd004c6.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-21bd942916f94d22a7f1a847df99b65b"><div id="altair-viz-eae9cf7f69794332922385668dd004c6"></div><img src="prerendered/morley-hist-maxbins.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.28 </span><span class="caption-text">Histogram of Michelson’s speed of light data.</span><a class="headerlink" href="#morley-hist-maxbins" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
<p>But what number of bins is the right one to use?
Unfortunately there is no hard rule for what the right bin number
or width is. It depends entirely on your problem; the <em>right</em> number of bins
or bin width is
the one that <em>helps you answer the question</em> you asked.
Choosing the correct setting for your problem
is something that commonly takes iteration.
It’s usually a good idea to try out several <code class="docutils literal notranslate"><span class="pre">maxbins</span></code> to see which one
most clearly captures your data in the context of the question
you want to answer.</p>
<p>To get a sense for how different bin affect visualizations,
let’s experiment with the histogram that we have been working on in this section.
In <a class="reference internal" href="#morley-hist-max-bins"><span class="std std-numref">Fig. 4.29</span></a>,
we compare the default setting with three other histograms where we set the
<code class="docutils literal notranslate"><span class="pre">maxbins</span></code> to 200, 70 and 5.
In this case, we can see that both the default number of bins
and the <code class="docutils literal notranslate"><span class="pre">maxbins=70</span></code> of  are effective for helping to answer our question.
On the other hand, the <code class="docutils literal notranslate"><span class="pre">maxbins=200</span></code> and <code class="docutils literal notranslate"><span class="pre">maxbins=5</span></code> are too small and too big, respectively.</p>
<figure class="align-default" id="morley-hist-max-bins" style="width: 700px">
<div class="output text_html">
<style>
  <ins>#altair-viz-1b62b9ab97b44afeab0d7b7fa1e1cc46.vega-embed</ins><del>#altair-viz-4fa540612f69484e8478edb02d06ddda.vega-embed</del> {
    width: 100%;
    display: flex;
  }

  <ins>#altair-viz-1b62b9ab97b44afeab0d7b7fa1e1cc46.vega-embed</ins><del>#altair-viz-4fa540612f69484e8478edb02d06ddda.vega-embed</del> details,
  <ins>#altair-viz-1b62b9ab97b44afeab0d7b7fa1e1cc46.vega-embed</ins><del>#altair-viz-4fa540612f69484e8478edb02d06ddda.vega-embed</del> details summary {
    position: relative;
  }
</style>
<div id="altair-viz-1b62b9ab97b44afeab0d7b7fa1e1cc46"><div id="altair-viz-4fa540612f69484e8478edb02d06ddda"></div><img src="prerendered/morley-hist-max-bins.png"/>
</div><figcaption>
<p><span class="caption-number">Fig. 4.29 </span><span class="caption-text">Effect of varying number of max bins on histograms.</span><a class="headerlink" href="#morley-hist-max-bins" title="Permalink to this image">#</a></p>
</figcaption>
</div></figure>
</section>
</section>
</section>
<section id="explaining-the-visualization">
<h2><span class="section-number">4.6. </span>Explaining the visualization<a class="headerlink" href="#explaining-the-visualization" title="Permalink to this heading">#</a></h2>
<p><font size="5"><em>Tell a story</em></font></p>
<p>Typically, your visualization will not be shown entirely on its own, but rather
it will be part of a larger presentation.  Further, visualizations can provide
supporting information for any aspect of a presentation, from opening to
conclusion.  For example, you could use an exploratory visualization in the
opening of the presentation to motivate your choice of a more detailed data
analysis / model, a visualization of the results of your analysis to show what
your analysis has uncovered, or even one at the end of a presentation to help
suggest directions for future work.</p>
<p id="index-42">Regardless of where it appears, a good way to discuss your visualization is as
a story:</p>
<ol class="arabic simple">
<li><p>Establish the setting and scope, and describe why you did what you did.</p></li>
<li><p>Pose the question that your visualization answers. Justify why the question is important to answer.</p></li>
<li><p>Answer the question using your visualization. Make sure you describe <em>all</em> aspects of the visualization (including describing the axes). But you
can emphasize different aspects based on what is important to answer your question:</p>
<ul class="simple">
<li><p><strong>trends (lines):</strong> Does a line describe the trend well? If so, the trend is <em>linear</em>, and if not, the trend is <em>nonlinear</em>. Is the trend increasing, decreasing, or neither?
Is there a periodic oscillation (wiggle) in the trend? Is the trend noisy (does the line “jump around” a lot) or smooth?</p></li>
<li><p><strong>distributions (scatters, histograms):</strong> How spread out are the data? Where are they centered, roughly? Are there any obvious “clusters” or “subgroups”, which would be visible as multiple bumps in the histogram?</p></li>
<li><p><strong>distributions of two variables (scatters):</strong> Is there a clear / strong relationship between the variables (points fall in a distinct pattern), a weak one (points fall in a pattern but there is some noise), or no discernible
relationship (the data are too noisy to make any conclusion)?</p></li>
<li><p><strong>amounts (bars):</strong> How large are the bars relative to one another? Are there patterns in different groups of bars?</p></li>
</ul>
</li>
<li><p>Summarize your findings, and use them to motivate whatever you will discuss next.</p></li>
</ol>
<p>Below are two examples of how one might take these four steps in describing the example visualizations that appeared earlier in this chapter.
Each of the steps is denoted by its numeral in parentheses, e.g. (3).</p>
<p id="index-43"><strong>Mauna Loa Atmospheric CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> Measurements:</strong> (1) Many
current forms of energy generation and conversion—from automotive
engines to natural gas power plants—rely on burning fossil fuels and produce
greenhouse gases, typically primarily carbon dioxide (CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span>), as a
byproduct. Too much of these gases in the Earth’s atmosphere will cause it to
trap more heat from the sun, leading to global warming. (2) In order to assess
how quickly the atmospheric concentration of CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> is increasing over
time, we (3) used a data set from the Mauna Loa observatory in Hawaii,
consisting of CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> measurements from 1980 to 2020. We plotted the
measured concentration of CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> (on the vertical axis) over time (on
the horizontal axis). From this plot, you can see a clear, increasing, and
generally linear trend over time. There is also a periodic oscillation that
occurs once per year and aligns with Hawaii’s seasons, with an amplitude that
is small relative to the growth in the overall trend. This shows that
atmospheric CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> is clearly increasing over time, and (4) it is
perhaps worth investigating more into the causes.</p>
<p id="index-44"><strong>Michelson Light Speed Experiments:</strong> (1) Our
modern understanding of the physics of light has advanced significantly from
the late 1800s when Michelson and Morley’s experiments first demonstrated that
it had a finite speed. We now know, based on modern experiments, that it moves at
roughly 299,792.458 kilometers per second. (2) But how accurately were we first
able to measure this fundamental physical constant, and did certain experiments
produce more accurate results than others?  (3) To better understand this, we
plotted data from 5 experiments by Michelson in 1879, each with 20 trials, as
histograms stacked on top of one another. The horizontal axis shows the
error of the measurements relative to the true speed of light as we know it
today, expressed as a percentage.  From this visualization, you can see that
most results had relative errors of at most 0.05%. You can also see that
experiments 1 and 3 had measurements that were the farthest from the true
value, and experiment 5 tended to provide the most consistently accurate
result. (4) It would be worth further investigating the differences between
these experiments to see why they produced different results.</p>
</section>
<section id="saving-the-visualization">
<h2><span class="section-number">4.7. </span>Saving the visualization<a class="headerlink" href="#saving-the-visualization" title="Permalink to this heading">#</a></h2>
<p><font size="5"><em>Choose the right output format for your needs</em></font></p>
<span class="target" id="index-45"></span><p id="index-46">Just as there are many ways to store data sets, there are many ways to store
visualizations and images.  Which one you choose can depend on several factors,
such as file size/type limitations (e.g., if you are submitting your
visualization as part of a conference paper or to a poster printing shop) and
where it will be displayed (e.g., online, in a paper, on a poster, on a
billboard, in talk slides).  Generally speaking, images come in two flavors:
<em>raster</em> formats
and <em>vector</em> formats.</p>
<p id="index-47"><strong>Raster</strong> images are represented as a 2-D grid of square pixels, each
with its own color. Raster images are often <em>compressed</em> before storing so they
take up less space. A compressed format is <em>lossy</em> if the image cannot be
perfectly re-created when loading and displaying, with the hope that the change
is not noticeable. <em>Lossless</em> formats, on the other hand, allow a perfect
display of the original image.</p>
<ul class="simple">
<li><p><em>Common file types:</em></p>
<ul>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/JPEG">JPEG</a> (<code class="docutils literal notranslate"><span class="pre">.jpg</span></code>, <code class="docutils literal notranslate"><span class="pre">.jpeg</span></code>): lossy, usually used for photographs</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Portable_Network_Graphics">PNG</a> (<code class="docutils literal notranslate"><span class="pre">.png</span></code>): lossless, usually used for plots / line drawings</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/BMP_file_format">BMP</a> (<code class="docutils literal notranslate"><span class="pre">.bmp</span></code>): lossless, raw image data, no compression (rarely used)</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/TIFF">TIFF</a> (<code class="docutils literal notranslate"><span class="pre">.tif</span></code>, <code class="docutils literal notranslate"><span class="pre">.tiff</span></code>): typically lossless, no compression, used mostly in graphic arts, publishing</p></li>
</ul>
</li>
<li><p><em>Open-source software:</em> <a class="reference external" href="https://www.gimp.org/">GIMP</a></p></li>
</ul>
<p id="index-48"><strong>Vector</strong> images are represented as a collection of mathematical
objects (lines, surfaces, shapes, curves). When the computer displays the image, it
redraws all of the elements using their mathematical formulas.</p>
<ul class="simple">
<li><p><em>Common file types:</em></p>
<ul>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG</a> (<code class="docutils literal notranslate"><span class="pre">.svg</span></code>): general-purpose use</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Encapsulated_PostScript">EPS</a> (<code class="docutils literal notranslate"><span class="pre">.eps</span></code>), general-purpose use (rarely used)</p></li>
</ul>
</li>
<li><p><em>Open-source software:</em> <a class="reference external" href="https://inkscape.org/">Inkscape</a></p></li>
</ul>
<p>Raster and vector images have opposing advantages and disadvantages. A raster
image of a fixed width / height takes the same amount of space and time to load
regardless of what the image shows (the one caveat is that the compression algorithms may
shrink the image more or run faster for certain images). A vector image takes
space and time to load corresponding to how complex the image is, since the
computer has to draw all the elements each time it is displayed. For example,
if you have a scatter plot with 1 million points stored as an SVG file, it may
take your computer some time to open the image. On the other hand, you can zoom
into / scale up vector graphics as much as you like without the image looking
bad, while raster images eventually start to look “pixelated.”</p>
<span class="target" id="index-49"></span><div class="admonition note" id="index-50">
<p class="admonition-title">Note</p>
<p>The portable document format <a class="reference external" href="https://en.wikipedia.org/wiki/PDF">PDF</a> (<code class="docutils literal notranslate"><span class="pre">.pdf</span></code>) is commonly used to
store <em>both</em> raster and vector formats. If you try to open a PDF and it’s taking a long time
to load, it may be because there is a complicated vector graphics image that your computer is rendering.</p>
</div>
<p>Let’s learn how to save plot images to <code class="docutils literal notranslate"><span class="pre">.png</span></code> and <code class="docutils literal notranslate"><span class="pre">.svg</span></code> file formats using the
<code class="docutils literal notranslate"><span class="pre">faithful_scatter_labels</span></code> scatter plot of the <a class="reference external" href="https://www.stat.cmu.edu/~larry/all-of-statistics/=data/faithful.dat">Old Faithful data set</a>
<span id="id7">[<a class="reference internal" href="#id50" title="Wolfgang Hardle. Smoothing Techniques with Implementation in S. Springer, New York, 1991.">Hardle, 1991</a>]</span> that we created earlier, shown in <a class="reference internal" href="#faithful-scatter-labels"><span class="std std-numref">Fig. 4.7</span></a>.
To save the plot to a file, we can use the <code class="docutils literal notranslate"><span class="pre">save</span></code>
method. The <code class="docutils literal notranslate"><span class="pre">save</span></code> method takes the path to the filename where you would like to
save the file (e.g., <code class="docutils literal notranslate"><span class="pre">img/viz/filename.png</span></code> to save a file named <code class="docutils literal notranslate"><span class="pre">filename.png</span></code> to the <code class="docutils literal notranslate"><span class="pre">img/viz/</span></code> directory).
The kind of image to save is specified by the file extension.  For example, to
create a PNG image file, we specify that the file extension is <code class="docutils literal notranslate"><span class="pre">.png</span></code>.  Below
we demonstrate how to save PNG and SVG file types for the
<code class="docutils literal notranslate"><span class="pre">faithful_scatter_labels</span></code> plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faithful_scatter_labels</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">"img/viz/faithful_plot.png"</span><span class="p">)</span>
<span class="n">faithful_scatter_labels</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">"img/viz/faithful_plot.svg"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<table class="table" id="png-vs-svg-table">
<caption><span class="caption-number">Table 4.1 </span><span class="caption-text">File sizes of the scatter plot of the Old Faithful data set when saved as different file formats.</span><a class="headerlink" href="#png-vs-svg-table" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Image type</p></th>
<th class="head"><p>File type</p></th>
<th class="head"><p>Image size</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Raster</p></td>
<td><p>PNG</p></td>
<td><p><span class="pasted-text">0.07</span> MB</p></td>
</tr>
<tr class="row-odd"><td><p>Vector</p></td>
<td><p>SVG</p></td>
<td><p><span class="pasted-text">0.09</span> MB</p></td>
</tr>
</tbody>
</table>
<p>Take a look at the file sizes in <a class="reference internal" href="#png-vs-svg-table"><span class="std std-numref">Table 4.1</span></a>.
Wow, that’s quite a difference! In this case, the <code class="docutils literal notranslate"><span class="pre">.png</span></code> image is almost 4 times
smaller than the <code class="docutils literal notranslate"><span class="pre">.svg</span></code> image. Since there are a decent number of points in the plot,
the vector graphics format image (<code class="docutils literal notranslate"><span class="pre">.svg</span></code>) is bigger than the raster image (<code class="docutils literal notranslate"><span class="pre">.png</span></code>), which
just stores the image data itself.
In <a class="reference internal" href="#png-vs-svg"><span class="std std-numref">Fig. 4.30</span></a>, we show what
the images look like when we zoom in to a rectangle with only 3 data points.
You can see why vector graphics formats are so useful: because they’re just
based on mathematical formulas, vector graphics can be scaled up to arbitrary
sizes.  This makes them great for presentation media of all sizes, from papers
to posters to billboards.</p>
<figure class="align-default" id="png-vs-svg">
<a class="reference internal image-reference" href="_images/png-vs-svg.png"><img alt="_images/png-vs-svg.png" src="_images/png-vs-svg.png" style="height: 400px;"/></a>
<figcaption>
<p><span class="caption-number">Fig. 4.30 </span><span class="caption-text">Zoomed in <code class="docutils literal notranslate"><span class="pre">faithful</span></code>, raster (PNG, left) and vector (SVG, right) formats.</span><a class="headerlink" href="#png-vs-svg" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="exercises">
<h2><span class="section-number">4.8. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<p>Practice exercises for the material covered in this chapter<ins class="diff"> </ins>can be found in the<ins class="diff">accompanying</ins> <del class="diff">accompanying</del><a class="reference external" href="https://worksheets.python.datasciencebook.ca">worksheets repository</a><ins class="diff"> in</ins>
<del class="diff">in </del>the “Effective data visualization” row.<ins class="diff"> </ins>You can <ins class="diff">preview</ins><del class="diff">launch</del> <ins class="diff">anon-interactive</ins><del class="diff">an</del> <del class="diff">interactive </del>version of the worksheet <ins class="diff">for</ins><del class="diff">in</del> <ins class="diff">this</ins><del class="diff">your</del> <ins class="diff">chapter</ins><del class="diff">browser</del> by clicking <ins class="diff">“view</ins><del class="diff">the “launch binder” button.</del>
<ins class="diff">worksheet.”</ins><del class="diff">You</del> <ins class="diff">To</ins><del class="diff">can</del> <ins class="diff">work</ins><del class="diff">also</del> <ins class="diff">on</ins><del class="diff">preview</del> <ins class="diff">the</ins><del class="diff">a</del> <ins class="diff">exercises</ins><del class="diff">non-interactive</del> <ins class="diff">interactively,</ins><del class="diff">version</del> <ins class="diff">follow</ins><del class="diff">of</del> the <ins class="diff">instructions</ins><del class="diff">worksheet</del> <ins class="diff">in</ins><del class="diff">by clicking “view worksheet.”</del>
<ins class="diff">the</ins><del class="diff">If</del> <ins class="diff">worksheets</ins><del class="diff">you</del> <ins class="diff">repository</ins><del class="diff">instead</del> <del class="diff">decide </del>to download <ins class="diff">all</ins><del class="diff">the</del> <ins class="diff">worksheets,</ins><del class="diff">worksheet</del> and <del class="diff">run it on your own machine,make sure to </del>follow the<del class="diff"> </del>instructions for computer setup<ins class="diff"> </ins>found in <a class="reference internal link-to-diff" href="setup.html#move-to-your-own-machine"><span class="std std-numref">Chapter 13</span></a>. This will ensure<del class="diff"> </del>that the automated feedback<ins class="diff"> </ins>and guidance that the worksheets provide will<del class="diff"> </del>function as intended.</p>
</section>
<section id="additional-resources">
<h2><span class="section-number">4.9. </span>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The <a class="reference external" href="https://altair-viz.github.io/">altair documentation</a> <span id="id8">[<a class="reference internal" href="#id74" title="Jacob VanderPlas, Brian Granger, Jeffrey Heer, Dominik Moritz, Kanit Wongsuphasawat, Arvind Satyanarayan, Eitan Lees, Ilia Timofeev, Ben Welsh, and Scott Sievert. Altair: interactive statistical visualizations for python. Journal of Open Source Software, 3(32):1057, 2018. URL: https://doi.org/10.21105/joss.01057, doi:10.21105/joss.01057.">VanderPlas <em>et al.</em>, 2018</a>]</span> is
where you should look if you want to learn more about the functions in this
chapter, the full set of arguments you can use, and other related functions.</p></li>
<li><p>The <a class="reference external" href="https://clauswilke.com/dataviz/"><em>Fundamentals of Data Visualization</em></a> <span id="id9">[<a class="reference internal" href="#id38" title="Claus Wilke. Fundamentals of Data Visualization. O'Reilly Media, 2019. URL: https://clauswilke.com/dataviz/.">Wilke, 2019</a>]</span> has
a wealth of information on designing effective visualizations. It is not
specific to any particular programming language or library. If you want to
improve your visualization skills, this is the next place to look.</p></li>
<li><p>The <a class="reference external" href="https://wesmckinney.com/book/time-series.html">dates and times</a> chapter
of <a class="reference external" href="https://wesmckinney.com/book/"><em>Python for Data Analysis</em></a> <span id="id10">[<a class="reference internal link-to-diff" href="wrangling.html#id52" title="Wes McKinney. Python for data analysis: Data wrangling with Pandas, NumPy, and IPython. &quot; O'Reilly Media, Inc.&quot;, 2012.">McKinney, 2012</a>]</span>
is where you should look if you want to learn about <code class="docutils literal notranslate"><span class="pre">date</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>, including
how to create them, and how to use them to effectively handle durations, etc</p></li>
</ul>
</section>
<section id="references">
<h2><span class="section-number">4.10. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<div class="docutils container" id="id11">
<dl class="citation">
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id2">Dee05</a></span></dt>
<dd><p>Sameer Deeb. The molecular basis of variation in human color vision. <em>Clinical Genetics</em>, 67:369–377, 2005.</p>
</dd>
<dt class="label" id="id50"><span class="brackets"><a class="fn-backref" href="#id7">Har91</a></span></dt>
<dd><p>Wolfgang Hardle. <em>Smoothing Techniques with Implementation in S</em>. Springer, New York, 1991.</p>
</dd>
<dt class="label" id="id59"><span class="brackets"><a class="fn-backref" href="#id10">McK12</a></span></dt>
<dd><p>Wes McKinney. <em>Python for data analysis: Data wrangling with Pandas, NumPy, and IPython</em>. " O'Reilly Media, Inc.", 2012.</p>
</dd>
<dt class="label" id="id51"><span class="brackets"><a class="fn-backref" href="#id5">McN77</a></span></dt>
<dd><p>Donald R. McNeil. <em>Interactive Data Analysis: A Practical Primer</em>. Wiley, 1977.</p>
</dd>
<dt class="label" id="id52"><span class="brackets"><a class="fn-backref" href="#id6">Mic82</a></span></dt>
<dd><p>Albert Michelson. Experimental determination of the velocity of light made at the United States Naval Academy, Annapolis. <em>Astronomic Papers</em>, 1:135–8, 1882.</p>
</dd>
<dt class="label" id="id49"><span class="brackets"><a class="fn-backref" href="#id3">TK20</a></span></dt>
<dd><p>Pieter Tans and Ralph Keeling. Trends in atmospheric carbon dioxide. 2020. URL: <a class="reference external" href="https://gml.noaa.gov/ccgg/trends/data.html">https://gml.noaa.gov/ccgg/trends/data.html</a> (visited on 2020-07-04).</p>
</dd>
<dt class="label" id="id31"><span class="brackets"><a class="fn-backref" href="#id4">Tim20</a></span></dt>
<dd><p>Tiffany Timbers. <em>canlang: Canadian Census language data</em>. 2020. R package version 0.0.9. URL: <a class="reference external" href="https://ttimbers.github.io/canlang/">https://ttimbers.github.io/canlang/</a>.</p>
</dd>
<dt class="label" id="id74"><span class="brackets"><a class="fn-backref" href="#id8">VGH+18</a></span></dt>
<dd><p>Jacob VanderPlas, Brian Granger, Jeffrey Heer, Dominik Moritz, Kanit Wongsuphasawat, Arvind Satyanarayan, Eitan Lees, Ilia Timofeev, Ben Welsh, and Scott Sievert. Altair: interactive statistical visualizations for python. <em>Journal of Open Source Software</em>, 3(32):1057, 2018. URL: <a class="reference external" href="https://doi.org/10.21105/joss.01057">https://doi.org/10.21105/joss.01057</a>, <a class="reference external" href="https://doi.org/10.21105/joss.01057">doi:10.21105/joss.01057</a>.</p>
</dd>
<dt class="label" id="id38"><span class="brackets">Wil19</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id9">2</a>)</span></dt>
<dd><p>Claus Wilke. <em>Fundamentals of Data Visualization</em>. O'Reilly Media, 2019. URL: <a class="reference external" href="https://clauswilke.com/dataviz/">https://clauswilke.com/dataviz/</a>.</p>
</dd>
</dl>
</div>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="prev-next-footer">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev link-to-diff" href="wrangling.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title"><span class="section-number">3. </span>Cleaning and wrangling data</p>
</div>
</a>
<a class="right-next link-to-diff" href="classification1.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title"><span class="section-number">5. </span>Classification I: training &amp; predicting</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> Contents
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">4.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-learning-objectives">4.2. Chapter learning objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-the-visualization">4.3. Choosing the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#refining-the-visualization">4.4. Refining the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-visualizations-with-altair">4.5. Creating visualizations with <code class="docutils literal notranslate"><span class="pre">altair</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plots-and-line-plots-the-mauna-loa-co-text-2-data-set">4.5.1. Scatter plots and line plots: the Mauna Loa CO<span class="math notranslate nohighlight">\(_{\text{2}}\)</span> data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plots-the-old-faithful-eruption-time-data-set">4.5.2. Scatter plots: the Old Faithful eruption time data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axis-transformation-and-colored-scatter-plots-the-canadian-languages-data-set">4.5.3. Axis transformation and colored scatter plots: the Canadian languages data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-plots-the-island-landmass-data-set">4.5.4. Bar plots: the island landmass data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograms-the-michelson-speed-of-light-data-set">4.5.5. Histograms: the Michelson speed of light data set</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-layers-to-an-altair-chart">Adding layers to an <code class="docutils literal notranslate"><span class="pre">altair</span></code> chart</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-binwidth-for-histograms">Choosing a binwidth for histograms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explaining-the-visualization">4.6. Explaining the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-visualization">4.7. Saving the visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">4.8. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">4.9. Additional resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.10. References</a></li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By Tiffany Timbers, Trevor Campbell, Melissa Lee, Joel Ostblom, and Lindsey Heagy
</p>
</div>
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2022.
      <br/>
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>
<footer class="bd-footer">
</footer>
</body>
</html>